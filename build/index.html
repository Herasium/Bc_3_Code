<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BlockCoin</title>
  <script src="https://stuk.github.io/jszip/dist/jszip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <meta property="og:title" content="Blockcoin" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://blockcoin.social" />
  <meta property="og:image" content="https://blockcoin.social/assets/logo.png" />
  <meta property="og:description" content="Blockcoin is a new social media built around a fictionnal currency that you can earn by posting!" />
  <meta name="theme-color" content="#BB01FF" />
  <meta name="description" content="Blockcoin is a new social media built around a fictionnal currency that you can earn by posting!" />
  <script src="https://www.google.com/recaptcha/api.js?render=6Lf1n4IoAAAAAEXFEel1BfkxHrcuzJUJNfPiFA3q"></script>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<noscript>Blockcoin Needs Javascript to run. Please enable Javascript then refesh your page.</noscript>
<script>
  var zipContent = "UEsDBAoAAAAAAGCnY1gSTBGgou8DAKLvAwAJAAAAYnVuZGxlLmpzKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9ImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitpKyInIik7dGhyb3cgYS5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9ImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmJlZ2luSGlkZGVuQ2FsbFN0YWNrID0gYmVnaW5IaWRkZW5DYWxsU3RhY2s7CmV4cG9ydHMuZW5kSGlkZGVuQ2FsbFN0YWNrID0gZW5kSGlkZGVuQ2FsbFN0YWNrOwpleHBvcnRzLmV4cGVjdGVkRXJyb3IgPSBleHBlY3RlZEVycm9yOwpleHBvcnRzLmluamVjdFZpcnR1YWxTdGFja0ZyYW1lID0gaW5qZWN0VmlydHVhbFN0YWNrRnJhbWU7CnZhciBfT2JqZWN0JGdldE93blByb3BlcnQ7CmNvbnN0IEVycm9yVG9TdHJpbmcgPSBGdW5jdGlvbi5jYWxsLmJpbmQoRXJyb3IucHJvdG90eXBlLnRvU3RyaW5nKTsKY29uc3QgU1VQUE9SVEVEID0gISFFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSAmJiAoKF9PYmplY3QkZ2V0T3duUHJvcGVydCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoRXJyb3IsICJzdGFja1RyYWNlTGltaXQiKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9PYmplY3QkZ2V0T3duUHJvcGVydC53cml0YWJsZSkgPT09IHRydWU7CmNvbnN0IFNUQVJUX0hJRElORyA9ICJzdGFydEhpZGluZyAtIHNlY3JldCAtIGRvbid0IHVzZSB0aGlzIC0gdjEiOwpjb25zdCBTVE9QX0hJRElORyA9ICJzdG9wSGlkaW5nIC0gc2VjcmV0IC0gZG9uJ3QgdXNlIHRoaXMgLSB2MSI7CmNvbnN0IGV4cGVjdGVkRXJyb3JzID0gbmV3IFdlYWtTZXQoKTsKY29uc3QgdmlydHVhbEZyYW1lcyA9IG5ldyBXZWFrTWFwKCk7CmZ1bmN0aW9uIENhbGxTaXRlKGZpbGVuYW1lKSB7CiAgcmV0dXJuIE9iamVjdC5jcmVhdGUoewogICAgaXNOYXRpdmU6ICgpID0+IGZhbHNlLAogICAgaXNDb25zdHJ1Y3RvcjogKCkgPT4gZmFsc2UsCiAgICBpc1RvcGxldmVsOiAoKSA9PiB0cnVlLAogICAgZ2V0RmlsZU5hbWU6ICgpID0+IGZpbGVuYW1lLAogICAgZ2V0TGluZU51bWJlcjogKCkgPT4gdW5kZWZpbmVkLAogICAgZ2V0Q29sdW1uTnVtYmVyOiAoKSA9PiB1bmRlZmluZWQsCiAgICBnZXRGdW5jdGlvbk5hbWU6ICgpID0+IHVuZGVmaW5lZCwKICAgIGdldE1ldGhvZE5hbWU6ICgpID0+IHVuZGVmaW5lZCwKICAgIGdldFR5cGVOYW1lOiAoKSA9PiB1bmRlZmluZWQsCiAgICB0b1N0cmluZzogKCkgPT4gZmlsZW5hbWUKICB9KTsKfQpmdW5jdGlvbiBpbmplY3RWaXJ0dWFsU3RhY2tGcmFtZShlcnJvciwgZmlsZW5hbWUpIHsKICBpZiAoIVNVUFBPUlRFRCkgcmV0dXJuOwogIGxldCBmcmFtZXMgPSB2aXJ0dWFsRnJhbWVzLmdldChlcnJvcik7CiAgaWYgKCFmcmFtZXMpIHZpcnR1YWxGcmFtZXMuc2V0KGVycm9yLCBmcmFtZXMgPSBbXSk7CiAgZnJhbWVzLnB1c2goQ2FsbFNpdGUoZmlsZW5hbWUpKTsKICByZXR1cm4gZXJyb3I7Cn0KZnVuY3Rpb24gZXhwZWN0ZWRFcnJvcihlcnJvcikgewogIGlmICghU1VQUE9SVEVEKSByZXR1cm47CiAgZXhwZWN0ZWRFcnJvcnMuYWRkKGVycm9yKTsKICByZXR1cm4gZXJyb3I7Cn0KZnVuY3Rpb24gYmVnaW5IaWRkZW5DYWxsU3RhY2soZm4pIHsKICBpZiAoIVNVUFBPUlRFRCkgcmV0dXJuIGZuOwogIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoZnVuY3Rpb24gKC4uLmFyZ3MpIHsKICAgIHNldHVwUHJlcGFyZVN0YWNrVHJhY2UoKTsKICAgIHJldHVybiBmbiguLi5hcmdzKTsKICB9LCAibmFtZSIsIHsKICAgIHZhbHVlOiBTVE9QX0hJRElORwogIH0pOwp9CmZ1bmN0aW9uIGVuZEhpZGRlbkNhbGxTdGFjayhmbikgewogIGlmICghU1VQUE9SVEVEKSByZXR1cm4gZm47CiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShmdW5jdGlvbiAoLi4uYXJncykgewogICAgcmV0dXJuIGZuKC4uLmFyZ3MpOwogIH0sICJuYW1lIiwgewogICAgdmFsdWU6IFNUQVJUX0hJRElORwogIH0pOwp9CmZ1bmN0aW9uIHNldHVwUHJlcGFyZVN0YWNrVHJhY2UoKSB7CiAgc2V0dXBQcmVwYXJlU3RhY2tUcmFjZSA9ICgpID0+IHt9OwogIGNvbnN0IHsKICAgIHByZXBhcmVTdGFja1RyYWNlID0gZGVmYXVsdFByZXBhcmVTdGFja1RyYWNlCiAgfSA9IEVycm9yOwogIGNvbnN0IE1JTl9TVEFDS19UUkFDRV9MSU1JVCA9IDUwOwogIEVycm9yLnN0YWNrVHJhY2VMaW1pdCAmJiAoRXJyb3Iuc3RhY2tUcmFjZUxpbWl0ID0gTWF0aC5tYXgoRXJyb3Iuc3RhY2tUcmFjZUxpbWl0LCBNSU5fU1RBQ0tfVFJBQ0VfTElNSVQpKTsKICBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZSA9IGZ1bmN0aW9uIHN0YWNrVHJhY2VSZXdyaXRlcihlcnIsIHRyYWNlKSB7CiAgICBsZXQgbmV3VHJhY2UgPSBbXTsKICAgIGNvbnN0IGlzRXhwZWN0ZWQgPSBleHBlY3RlZEVycm9ycy5oYXMoZXJyKTsKICAgIGxldCBzdGF0dXMgPSBpc0V4cGVjdGVkID8gImhpZGluZyIgOiAidW5rbm93biI7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyYWNlLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IG5hbWUgPSB0cmFjZVtpXS5nZXRGdW5jdGlvbk5hbWUoKTsKICAgICAgaWYgKG5hbWUgPT09IFNUQVJUX0hJRElORykgewogICAgICAgIHN0YXR1cyA9ICJoaWRpbmciOwogICAgICB9IGVsc2UgaWYgKG5hbWUgPT09IFNUT1BfSElESU5HKSB7CiAgICAgICAgaWYgKHN0YXR1cyA9PT0gImhpZGluZyIpIHsKICAgICAgICAgIHN0YXR1cyA9ICJzaG93aW5nIjsKICAgICAgICAgIGlmICh2aXJ0dWFsRnJhbWVzLmhhcyhlcnIpKSB7CiAgICAgICAgICAgIG5ld1RyYWNlLnVuc2hpZnQoLi4udmlydHVhbEZyYW1lcy5nZXQoZXJyKSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChzdGF0dXMgPT09ICJ1bmtub3duIikgewogICAgICAgICAgbmV3VHJhY2UgPSB0cmFjZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChzdGF0dXMgIT09ICJoaWRpbmciKSB7CiAgICAgICAgbmV3VHJhY2UucHVzaCh0cmFjZVtpXSk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBwcmVwYXJlU3RhY2tUcmFjZShlcnIsIG5ld1RyYWNlKTsKICB9Owp9CmZ1bmN0aW9uIGRlZmF1bHRQcmVwYXJlU3RhY2tUcmFjZShlcnIsIHRyYWNlKSB7CiAgaWYgKHRyYWNlLmxlbmd0aCA9PT0gMCkgcmV0dXJuIEVycm9yVG9TdHJpbmcoZXJyKTsKICByZXR1cm4gYCR7RXJyb3JUb1N0cmluZyhlcnIpfVxuICAgIGF0ICR7dHJhY2Uuam9pbigiXG4gICAgYXQgIil9YDsKfQowICYmIDA7CgoKCn0se31dLDI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuQmFja2dyb3VuZCA9IEJhY2tncm91bmQ7CmZ1bmN0aW9uIEJhY2tncm91bmQocm91dGVyKSB7CiAgdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiLi4vbGliL0ZyYW1ld29yay5tanMiKSwKICAgIFBhZ2UgPSBfcmVxdWlyZS5QYWdlLAogICAgRGlzcGxheSA9IF9yZXF1aXJlLkRpc3BsYXk7CiAgdmFyIGRpc3BsYXkgPSBuZXcgRGlzcGxheSgpOwogIHZhciBwYWdlID0gbmV3IFBhZ2UoIkJhY2tncm91bmQiKTsKICB2YXIgd2F2ZTEgPSBwYWdlLmltYWdlKCJ3YXZlMS5zdmciKTsKICB2YXIgd2F2ZTIgPSBwYWdlLmltYWdlKCJ3YXZlMi5zdmciKTsKICBwYWdlLmh0bWwoIlxuICAgICAgICA8ZGl2IGlkPVwiYmx1clwiPjwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZWxpcHNlXCIgaWQ9XCJlLTFcIj48L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImVsaXBzZVwiIGlkPVwiZS0yXCI+PC9kaXY+XG4gICAgIik7CiAgY29uc29sZS5sb2coZGlzcGxheS5nZXQoImJhY2tncm91bmQiKSk7CiAgcGFnZS5jc3MoIlxuICAgICAgICBib2R5IHtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICIuY29uY2F0KGRpc3BsYXkuZ2V0KCJiYWNrZ3JvdW5kIikuY29sb3IsICI7XG4gICAgICAgIH1cbiAgICAgICAgI2JsdXIge1xuICAgICAgICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKCIpLmNvbmNhdChkaXNwbGF5LmdldCgiYmFja2dyb3VuZCIpWyJibHVyIl0sICIpO1xuICAgICAgICAgICAgei1pbmRleDogLTU7XG4gICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgICAgICAgICB0b3A6IDA7XG4gICAgICAgICAgICBsZWZ0OiAwO1xuICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC5lbGlwc2Uge1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNDU4cHg7XG4gICAgICAgICAgICB3aWR0aDogNDU4cHg7XG4gICAgICAgICAgICBoZWlnaHQ6IDQ1OHB4O1xuICAgICAgICAgICAgei1pbmRleDogLTY7XG4gICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICNlLTEge1xuICAgICAgICAgICAgYmFja2dyb3VuZDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJiYWNrZ3JvdW5kIilbImVsaXBzZS1jb2xvciJdWzBdLCAiO1xuICAgICAgICAgICAgdG9wOjA7XG4gICAgICAgICAgICBsZWZ0OjA7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICNlLTIge1xuICAgICAgICAgICAgYmFja2dyb3VuZDoiKS5jb25jYXQoZGlzcGxheS5nZXQoImJhY2tncm91bmQiKVsiZWxpcHNlLWNvbG9yIl1bMV0sICI7XG4gICAgICAgICAgICBib3R0b206IDA7XG4gICAgICAgICAgICByaWdodDowO1xuICAgICAgICB9XG4gICAgICAgIEBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDEyNzBweCl7XG4gICAgICAgICAgICAjYmx1ciB7XG4gICAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5lbGlwc2Uge1xuICAgICAgICAgICAgICBoZWlnaHQ6IDQ4dnc7XG4gICAgICAgICAgICAgIHdpZHRoOiA0OHZ3O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAiKSk7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2xpYi9GcmFtZXdvcmsubWpzIjoxMH1dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuQ29tbWVudCA9IENvbW1lbnQ7CmZ1bmN0aW9uIENvbW1lbnQocm91dGVyLCBwb3N0LCBwYXJlbnQsIHBvc3RfaWQpIHsKICB2YXIgX3JlcXVpcmUgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIFZpZXdQb3N0ID0gX3JlcXVpcmUuVmlld1Bvc3QsCiAgICBJc0xvZ2VkSW4gPSBfcmVxdWlyZS5Jc0xvZ2VkSW4sCiAgICBDb21tZW50TGlrZWQgPSBfcmVxdWlyZS5Db21tZW50TGlrZWQsCiAgICBMaWtlQ29tbWVudCA9IF9yZXF1aXJlLkxpa2VDb21tZW50LAogICAgR2V0UHJvZmlsZSA9IF9yZXF1aXJlLkdldFByb2ZpbGU7CiAgdmFyIF9yZXF1aXJlMiA9IHJlcXVpcmUoIi4uL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgICBNb2R1bGUgPSBfcmVxdWlyZTIuTW9kdWxlLAogICAgRGlzcGxheSA9IF9yZXF1aXJlMi5EaXNwbGF5OwogIHZhciBkaXNwbGF5ID0gbmV3IERpc3BsYXkoKTsKICB2YXIgbW9kdWxlID0gbmV3IE1vZHVsZSgiQ29tbWVudCIpOwogIHZhciBibGFua19sb2dvID0gbW9kdWxlLmltYWdlKCJsb2dvX2JsYW5rLnN2ZyIpOwogIGZ1bmN0aW9uIHRpbWVDb252ZXJ0ZXIoVU5JWF90aW1lc3RhbXApIHsKICAgIHZhciBhID0gbmV3IERhdGUoVU5JWF90aW1lc3RhbXAgKiAxMDAwKTsKICAgIHZhciBtb250aHMgPSBbJ0phbicsICdGZWInLCAnTWFyJywgJ0FwcicsICdNYXknLCAnSnVuJywgJ0p1bCcsICdBdWcnLCAnU2VwJywgJ09jdCcsICdOb3YnLCAnRGVjJ107CiAgICB2YXIgeWVhciA9IGEuZ2V0RnVsbFllYXIoKTsKICAgIHZhciBtb250aCA9IG1vbnRoc1thLmdldE1vbnRoKCldOwogICAgdmFyIGRhdGUgPSBhLmdldERhdGUoKTsKICAgIHZhciBob3VyID0gKCcwJyArIGEuZ2V0SG91cnMoKSkuc2xpY2UoLTIpOyAvLyBQYWQgc2luZ2xlLWRpZ2l0IGhvdXJzIHdpdGggbGVhZGluZyB6ZXJvCiAgICB2YXIgbWluID0gKCcwJyArIGEuZ2V0TWludXRlcygpKS5zbGljZSgtMik7IC8vIFBhZCBzaW5nbGUtZGlnaXQgbWludXRlcyB3aXRoIGxlYWRpbmcgemVybwogICAgdmFyIHNlYyA9ICgnMCcgKyBhLmdldFNlY29uZHMoKSkuc2xpY2UoLTIpOyAvLyBQYWQgc2luZ2xlLWRpZ2l0IHNlY29uZHMgd2l0aCBsZWFkaW5nIHplcm8KICAgIHZhciB0aW1lID0gZGF0ZSArICcgJyArIG1vbnRoICsgJyAnICsgeWVhciArICcgJyArIGhvdXIgKyAnOicgKyBtaW4gKyAnOicgKyBzZWM7CiAgICByZXR1cm4gdGltZTsKICB9CiAgbW9kdWxlLmh0bWwoIlxuICAgIDxkaXYgaWQ9XCJjb21tZW50XCI+XG4gICAgICAgIDxkaXYgaWQ9XCJjb21tZW50LXRvcC1jb250YWluZXJcIj5cbiAgICAgICAgICAgIDxpbWcgaWQ9XCJjb21tZW50LWltZ1wiIGNsYXNzPVwicHJvZmlsZS1waWN0dXJlXCIgY2xhc3M9XCJ0ZXh0XCI+PC9pbWc+XG4gICAgICAgICAgICA8ZGl2IGlkPVwiY29tbWVudC11c2VyXCIgY2xhc3M9XCJ0ZXh0IHVzZXJuYW1lXCI+TG9hZGluZy4uLjwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbW1lbnQtYmFkZ2VzLWNvbnRhaW5lclwiPjwvZGl2PlxuICAgICAgICAgICAgPGRpdiBpZD1cImNvbW1lbnQtbWV0YVwiIGNsYXNzPVwidGV4dCB0aW1lc3RhbXBcIiA+QmxvY2tDb2luIEJyb3dzZXIgQXBwIC0gTG9hZGluZy4uLjwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBpZD1cImNvbW1lbnQtZGF0YVwiIGNsYXNzPVwidGV4dCBkYXRhXCI+TG9hZGluZy4uLjwvZGl2PlxuICAgICAgICA8ZGl2IGlkPVwiY29tbWVudC1zdGF0c1wiIGNsYXNzPVwic3RhdHMgdGV4dFwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkIGxpa2UtYnV0dG9uXCI+ZmF2b3JpdGU8L3NwYW4+IFxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJsaWtlc1wiPjA8L3NwYW4+XG4gICAgICAgICAgICA8ZGl2IGlkPVwicmVwbHktYnV0dG9uXCIgY2xhc3M9XCJyZXBseS1idXR0b25cIj48c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIj5yZXBseTwvc3Bhbj4gUmVwbHkgPC9kaXY+IFxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGlkPVwiY29tbWVudC1yZXBseVwiIGNsYXNzPVwiY29tbWVudC1yZXBseVwiPlxuICAgIDwvZGl2PlxuICAgICIpOwogIG1vZHVsZS5jc3MoIlxuICAgIC5hLWJsb2NrY29pbiB7XG4gICAgICAgIHdpZHRoOjI0cHg7XG4gICAgICAgIGhlaWdodDoyNHB4O1xuICAgIH1cbiAgICAubGlrZS1idXR0b24ge1xuICAgICAgICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAwLjVzO1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICB9XG4gICAgLmxpa2UtYnV0dG9uOmhvdmVyIHtcbiAgICAgICAgZm9udC1zaXplOiAyNnB4O1xuICAgIH1cbiAgICAuYS1ibG9ja2NvaW46aG92ZXIge1xuICAgICAgICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAwLjVzO1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgICAgd2lkdGg6MjZweDtcbiAgICAgICAgaGVpZ2h0OjI2cHg7XG4gICAgfVxuICAgIC5saWtlZCB7XG4gICAgICAgIGNvbG9yOiNGRjAwMDA7XG4gICAgICAgIGZvbnQtdmFyaWF0aW9uLXNldHRpbmdzOlxuICAgICAgICAnRklMTCcgMSxcbiAgICAgICAgJ3dnaHQnIDQwMCxcbiAgICAgICAgJ0dSQUQnIDAsXG4gICAgICAgICdvcHN6JyAyNFxuICAgIH1cbiAgICAjY29tbWVudCB7XG4gICAgICAgIGJhY2tncm91bmQ6ICIuY29uY2F0KGRpc3BsYXkuZ2V0KCJjb21tZW50IilbImJhY2tncm91bmQiXSwgIjtcbiAgICAgICAgd2lkdGg6MTAwJTtcbiAgICAgICAgbWluLXdpZHRoOjQ1MHB4O1xuICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgIHRvcDowO1xuICAgICAgICBsZWZ0OjA7XG4gICAgICAgIGJvcmRlcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJjb21tZW50IilbImJvcmRlciJdLCAiO1xuICAgICAgICBib3JkZXItcmFkaXVzOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImNvbW1lbnQiKVsiYm9yZGVyLXJhZGl1cyJdLCAiXG4gICAgfVxuICAgIC5jb21tZW50LXJlcGx5IHtcbiAgICAgICAgd2lkdGg6OTAlO1xuICAgICAgICBoZWlnaHQ6IGZpdC1jb250ZW50O1xuICAgIH1cbiAgICAuY29tbWVudC1iYWRnZSB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjVweDtcbiAgICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiYmFkZ2UiKVsiY29sb3IiXSwgIjtcbiAgXG4gICAgICB9XG4gICAgICAjY29tbWVudC1iYWRnZXMtY29udGFpbmVyIHtcbiAgICAgICAgd2lkdGg6MjAlO1xuICAgICAgICBkaXNwbGF5OmZsZXg7XG4gICAgICAgIGZsZXgtZGlyZWN0aW9uOnJvdztcbiAgICAgICAganVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnQ7XG4gICAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgICAgbWFyZ2luOjEwcHg7XG4gICAgICAgIGJvcmRlcjoiKS5jb25jYXQoZGlzcGxheS5nZXQoImJhZGdlIilbImJvcmRlciJdLCAiO1xuICAgICAgICBib3JkZXItcmFkaXVzOiIpLmNvbmNhdChkaXNwbGF5LmdldCgiYmFkZ2UiKVsiYm9yZGVyLXJhZGl1cyJdLCAiO1xuICAgICAgfVxuICAgIC50ZXh0IHtcbiAgICAgICAgZm9udC1mYW1pbHk6ICciKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiJywgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodCJdLCAiO1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bMV0sICI7XG4gICAgICAgIGNvbG9yOiIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgIH1cblxuICAgICNjb21tZW50LWltZyB7XG4gICAgICAgIGN1cnNvcjpwb2ludGVyO1xuICAgICAgICBib3JkZXItcmFkaXVzOjI1NnB4O1xuICAgICAgICB3aWR0aDogNDhweDtcbiAgICAgICAgaGVpZ2h0OiA0OHB4O1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgfVxuXG4gICAgI2NvbW1lbnQtdXNlciB7XG4gICAgICAgIGN1cnNvcjpwb2ludGVyO1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIG1hcmdpbi1sZWZ0OjA7XG4gICAgfVxuXG4gICAgI2NvbW1lbnQtdG9wLWNvbnRhaW5lciB7XG4gICAgICAgIHBvc2l0aW9uOnJlbGF0aXZlO1xuICAgICAgICB0b3A6MDtcbiAgICAgICAgbGVmdDowO1xuICAgICAgICB3aWR0aDoxMDAlO1xuICAgICAgICBoZWlnaHQ6Zml0LWNvbnRlbnQ7XG4gICAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzdGFydDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICBcbiAgICB9XG4gICAgI3JlcGx5LWJ1dHRvbiB7XG4gICAgICAgIGN1cnNvcjpwb2ludGVyO1xuICAgICAgICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAwLjVzO1xuICAgICAgICBmb250LWZhbWlseTogJyIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICInLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsxXSwgIjtcbiAgICAgICAgY29sb3I6IikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICAgIGhlaWdodDphdXRvO1xuICAgICAgICB3aWR0aDphdXRvO1xuICAgICAgICB0ZXh0LWFsaWduOmNlbnRlcjtcbiAgICAgICAgd2lkdGg6Zml0LWNvbnRlbnQ7XG4gICAgICB9XG4gICAgICAjcmVwbHktYnV0dG9uOmhvdmVyIHtcbiAgICAgICAgZm9udC1zaXplOiAyNnB4O1xuICAgICAgfVxuICAgICNjb21tZW50LW1ldGEge1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAzMDA7XG4gICAgICAgIGZvbnQtc2l6ZTogMTdweDtcbiAgICB9XG4gICAgI2NvbW1lbnQtc3RhdHMge1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIGJvdHRvbTowO1xuICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcbiAgICAgICAgcmlnaHQ6MDtcbiAgICAgICAgdGV4dC1hbGlnbjpyaWdodDtcbiAgICAgICAgZm9udC13ZWlnaHQ6IDMwMDtcbiAgICAgICAgZm9udC1zaXplOiAxN3B4O1xuICAgIH1cbiAgICAjY29tbWVudC1kYXRhIHtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgIH1cbiAgICAiKSk7CiAgbW9kdWxlLnBhcmVudChwYXJlbnQpOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIHZhciBidXllciA9IG51bGw7CiAgICBtb2R1bGUuZGl2LmlkID0gcG9zdFsiaWQiXTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb21tZW50LXJlcGx5IikuaWQgPSBwb3N0WyJpZCJdICsgIi1jb250YWluZXIiOwogICAgdmFyIHRleHQgPSBwb3N0WyJkYXRhIl07CiAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC8+L2csICcnKTsKICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoLzwvZywgJycpOwogICAgdmFyIGh0bWxDb250ZW50ID0gbWFya2VkLnBhcnNlKHRleHQpOwogICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJ1c2VybmFtZSIpWzBdLmlubmVyVGV4dCA9IHBvc3RbInVzZXIiXTsKICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiZGF0YSIpWzBdLmlubmVySFRNTCA9IGh0bWxDb250ZW50OwogICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJ0aW1lc3RhbXAiKVswXS5pbm5lclRleHQgPSAiIi5jb25jYXQodGltZUNvbnZlcnRlcihwb3N0WyJkYXRlIl0pKTsKICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgicmVwbHktYnV0dG9uIilbMF0ub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9jb21tZW50LyIgKyBwb3N0X2lkICsgIi8iICsgcG9zdFsiaWQiXSk7CiAgICB9OwogICAgaWYgKGJ1eWVyID09IG51bGwpIHsKICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJwcm9maWxlLXBpY3R1cmUiKVswXS5zcmMgPSBwb3N0WyJwcm9maWxlLXBpY3R1cmUiXTsKICAgIH0gZWxzZSB7CiAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgicHJvZmlsZS1waWN0dXJlIilbMF0uc3JjID0gYnV5ZXJbInByb2ZpbGUtcGljdHVyZSJdOwogICAgfQogICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJsaWtlcyIpWzBdLmlubmVyVGV4dCA9IHBvc3RbImxpa2VzIl07CiAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInByb2ZpbGUtcGljdHVyZSIpWzBdLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvcHJvZmlsZS8iICsgcG9zdFsidXNlci1pZCJdKTsKICAgIH07CiAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInVzZXJuYW1lIilbMF0ub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9wcm9maWxlLyIgKyBwb3N0WyJ1c2VyLWlkIl0pOwogICAgfTsKICAgIHZhciBjb250YWluZXIgPSBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImNvbW1lbnQtYmFkZ2VzLWNvbnRhaW5lciIpWzBdOwogICAgdmFyIGJhZGdlcyA9IFsiYXdhcmRfc3RhciIsICJ2ZXJpZmllZCIsICJzaGllbGRfcGVyc29uIiwgInNtYXJ0X3RveSIsICJsb2NhbF9maXJlX2RlcGFydG1lbnQiLCAic2NpZW5jZSIsICdidWdfcmVwb3J0J107CiAgICB2YXIgdGl0bGVzID0gWyJCbG9ja0NvaW4gQWRtaW4iLCAiVmVyaWZpZWQgQWNjb3VudCIsICJCbG9ja0NvaW4gU3RhZmYiLCAiQm90IEFjY291bnQiLCAiQmxvY2tDb2luIFByZW1pdW0iLCAiQmV0YSBUZXN0ZXIiLCAiQnVnIFJlcG9ydCJdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb3N0WyJiYWRnZXMiXS5sZW5ndGg7IGkrKykgewogICAgICB2YXIgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTsKICAgICAgc3Bhbi5jbGFzc05hbWUgPSAibWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZCBjb21tZW50LWJhZGdlIjsKICAgICAgc3Bhbi5pbm5lckhUTUwgPSBiYWRnZXNbcG9zdFsiYmFkZ2VzIl1baV1dOwogICAgICBzcGFuLnRpdGxlID0gdGl0bGVzW3Bvc3RbImJhZGdlcyJdW2ldXTsKICAgICAgLy8gQXBwZW5kIHRoZSBzcGFuIGVsZW1lbnQgdG8gdGhlIGNvbnRhaW5lciBkaXYKICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHNwYW4pOwogICAgfQogICAgdmFyIGxpa2VkID0gZmFsc2U7CiAgICB2YXIgc2VudF9yZXF1ZXN0cyA9IGZhbHNlOwogICAgZnVuY3Rpb24gY2hlY2tfc2Nyb2xsKCkgewogICAgICB2YXIgdGFyZ2V0RGl2ID0gbW9kdWxlLmRpdjsKICAgICAgdmFyIGJvdW5kaW5nID0gdGFyZ2V0RGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwoKICAgICAgLy8gQ2hlY2tpbmcgaWYgdGhlIGRpdiBpcyBpbiB0aGUgdmlld3BvcnQKICAgICAgaWYgKGJvdW5kaW5nLnRvcCA+PSAwICYmIGJvdW5kaW5nLmxlZnQgPj0gMCAmJiBib3VuZGluZy5ib3R0b20gPD0gKHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KSAmJiBib3VuZGluZy5yaWdodCA8PSAod2luZG93LmlubmVyV2lkdGggfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKSkgewogICAgICAgIGlmIChJc0xvZ2VkSW4oKSAmJiBzZW50X3JlcXVlc3RzID09IGZhbHNlKSB7CiAgICAgICAgICBzZW50X3JlcXVlc3RzID0gdHJ1ZTsKICAgICAgICAgIENvbW1lbnRMaWtlZChwb3N0X2lkLCBwb3N0WyJpZCJdKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOwogICAgICAgICAgICBsaWtlZCA9IGRhdGFbImxpa2VkIl07CiAgICAgICAgICAgIGlmIChkYXRhWyJsaWtlZCJdKSB7CiAgICAgICAgICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJsaWtlLWJ1dHRvbiIpWzBdLmNsYXNzTGlzdC5hZGQoJ2xpa2VkJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJsaWtlLWJ1dHRvbiIpWzBdLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDbGlja2VkIik7CiAgICAgICAgICAgIGlmIChsaWtlZCkgewogICAgICAgICAgICAgIGxpa2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJsaWtlLWJ1dHRvbiIpWzBdLmNsYXNzTGlzdC5yZW1vdmUoJ2xpa2VkJyk7CiAgICAgICAgICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJsaWtlcyIpWzBdLmlubmVyVGV4dCA9IHBhcnNlSW50KG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibGlrZXMiKVswXS5pbm5lclRleHQpIC0gMTsKICAgICAgICAgICAgICBMaWtlQ29tbWVudChwb3N0WyJpZCJdLCBwb3N0X2lkKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBsaWtlZCA9IHRydWU7CiAgICAgICAgICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJsaWtlLWJ1dHRvbiIpWzBdLmNsYXNzTGlzdC5hZGQoJ2xpa2VkJyk7CiAgICAgICAgICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJsaWtlcyIpWzBdLmlubmVyVGV4dCA9IHBhcnNlSW50KG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibGlrZXMiKVswXS5pbm5lclRleHQpICsgMTsKICAgICAgICAgICAgICBMaWtlQ29tbWVudChwb3N0WyJpZCJdLCBwb3N0X2lkKTsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGNoZWNrX3Njcm9sbCgpOwogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGZ1bmN0aW9uICgpIHsKICAgICAgY2hlY2tfc2Nyb2xsKCk7CiAgICB9KTsKICB9CiAgbW9kdWxlLm9uX3JlbmRlcihvbl9yZW5kZXIpOwogIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocG9zdFsiaWQiXSk7CiAgaWYgKGVsZW1lbnQgPT0gbnVsbCkgewogICAgbW9kdWxlLnJlbmRlcigpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gIiI7CiAgfQp9Cgp9LHsiLi4vbGliL0ZyYW1ld29yay5tanMiOjEwLCIuLi9zY3JpcHRzL2FwaS5tanMiOjI5fV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5Gb250cyA9IEZvbnRzOwpmdW5jdGlvbiBGb250cyhyb3V0ZXIpIHsKICB2YXIgX3JlcXVpcmUgPSByZXF1aXJlKCIuLi9saWIvRnJhbWV3b3JrLm1qcyIpLAogICAgUGFnZSA9IF9yZXF1aXJlLlBhZ2UsCiAgICBEaXNwbGF5ID0gX3JlcXVpcmUuRGlzcGxheTsKICB2YXIgZGlzcGxheSA9IG5ldyBEaXNwbGF5KCk7CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiRm9udHMiKTsKICBwYWdlLmh0bWwoIlxuICAgIDxsaW5rIHJlbD1cInByZWNvbm5lY3RcIiBocmVmPVwiaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbVwiPlxuICAgIDxsaW5rIHJlbD1cInByZWNvbm5lY3RcIiBocmVmPVwiaHR0cHM6Ly9mb250cy5nc3RhdGljLmNvbVwiIGNyb3Nzb3JpZ2luPlxuICAgIDxsaW5rIGhyZWY9XCJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PSIuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtY29kZSJdLCAiOml0YWwsd2dodEAwLDMwMDswLDQwMDswLDUwMDswLDYwMDswLDcwMDsxLDQwMDsxLDYwMCZkaXNwbGF5PXN3YXBcIiByZWw9XCJzdHlsZXNoZWV0XCI+XG4gICAgPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGhyZWY9XCJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PU1hdGVyaWFsK1N5bWJvbHMrT3V0bGluZWQ6b3Bzeix3Z2h0LEZJTEwsR1JBREAyMC4uNDgsMTAwLi43MDAsMC4uMSwtNTAuLjIwMFwiIC8+XG4gICAgIikpOwogIHBhZ2UuY3NzKCJcbiAgICAubWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZCB7XG4gICAgICBmb250LXZhcmlhdGlvbi1zZXR0aW5nczpcbiAgICAgICdGSUxMJyAwLFxuICAgICAgJ3dnaHQnIDQwMCxcbiAgICAgICdHUkFEJyAwLFxuICAgICAgJ29wc3onIDI0XG4gICAgfVxuXG4gICAgLm1hdGVyaWFsLXN5bWJvbHMtZmlsbGVkIHtcbiAgICAgICAgZm9udC12YXJpYXRpb24tc2V0dGluZ3M6XG4gICAgICAgICdGSUxMJyAxLFxuICAgICAgICAnd2dodCcgNDAwLFxuICAgICAgICAnR1JBRCcgMCxcbiAgICAgICAgJ29wc3onIDI0XG4gICAgICB9XG4gICAgIik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2xpYi9GcmFtZXdvcmsubWpzIjoxMH1dLDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuRm9vdGVyID0gRm9vdGVyOwpmdW5jdGlvbiBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihvLCBhbGxvd0FycmF5TGlrZSkgeyB2YXIgaXQgPSB0eXBlb2YgU3ltYm9sICE9PSAidW5kZWZpbmVkIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0gfHwgb1siQEBpdGVyYXRvciJdOyBpZiAoIWl0KSB7IGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSB7IGlmIChpdCkgbyA9IGl0OyB2YXIgaSA9IDA7IHZhciBGID0gZnVuY3Rpb24gRigpIHt9OyByZXR1cm4geyBzOiBGLCBuOiBmdW5jdGlvbiBuKCkgeyBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHsgZG9uZTogdHJ1ZSB9OyByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IG9baSsrXSB9OyB9LCBlOiBmdW5jdGlvbiBlKF9lKSB7IHRocm93IF9lOyB9LCBmOiBGIH07IH0gdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9IHZhciBub3JtYWxDb21wbGV0aW9uID0gdHJ1ZSwgZGlkRXJyID0gZmFsc2UsIGVycjsgcmV0dXJuIHsgczogZnVuY3Rpb24gcygpIHsgaXQgPSBpdC5jYWxsKG8pOyB9LCBuOiBmdW5jdGlvbiBuKCkgeyB2YXIgc3RlcCA9IGl0Lm5leHQoKTsgbm9ybWFsQ29tcGxldGlvbiA9IHN0ZXAuZG9uZTsgcmV0dXJuIHN0ZXA7IH0sIGU6IGZ1bmN0aW9uIGUoX2UyKSB7IGRpZEVyciA9IHRydWU7IGVyciA9IF9lMjsgfSwgZjogZnVuY3Rpb24gZigpIHsgdHJ5IHsgaWYgKCFub3JtYWxDb21wbGV0aW9uICYmIGl0WyJyZXR1cm4iXSAhPSBudWxsKSBpdFsicmV0dXJuIl0oKTsgfSBmaW5hbGx5IHsgaWYgKGRpZEVycikgdGhyb3cgZXJyOyB9IH0gfTsgfQpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSBhcnIyW2ldID0gYXJyW2ldOyByZXR1cm4gYXJyMjsgfQpmdW5jdGlvbiBGb290ZXIocm91dGVyKSB7CiAgdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiLi4vbGliL0ZyYW1ld29yay5tanMiKSwKICAgIFBhZ2UgPSBfcmVxdWlyZS5QYWdlLAogICAgRGlzcGxheSA9IF9yZXF1aXJlLkRpc3BsYXk7CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiRm9vdGVyIik7CiAgdmFyIGRpc3BsYXkgPSBuZXcgRGlzcGxheSgpOwogIHBhZ2UuaHRtbCgiXG4gICAgPGZvb3Rlcj5cbiAgICA8ZGl2IGlkPVwiY29weVwiPlx4QTkgQmxvY2tDb2luIDIwMjQ8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwiY29udGFpbmVyLTRcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXItdGl0bGVzXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0aXRsZVwiPkNvbW11bml0eTwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGl0bGVcIj5XZWJzaXRlPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0aXRsZVwiPlNlcnZpY2VzPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXItbGlua3NcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lci1saW5rXCI+XG4gICAgICAgICAgPGEgY2xhc3M9XCJsaW5rXCIgaWQ9XCJkaXNjb3JkXCI+RGlzY29yZDwvYT5cbiAgICAgICAgICA8YSBjbGFzcz1cImxpbmtcIiBpZD1cInNjcmF0Y2hcIj5TY3JhdGNoPC9hPlxuICAgICAgICAgIDxhIGNsYXNzPVwibGlua1wiIGlkPVwidHdpdHRlclwiPlggKFR3aXR0ZXIpPC9hPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lci1saW5rXCI+XG4gICAgICAgICAgPGEgY2xhc3M9XCJsaW5rXCIgaWQ9XCJsb2dpblwiPkxvZ2luPC9hPlxuICAgICAgICAgIDxhIGNsYXNzPVwibGlua1wiIGlkPVwicmVnaXN0ZXJcIj5SZWdpc3RlcjwvYT5cbiAgICAgICAgICA8YSBjbGFzcz1cImxpbmtcIiBpZD1cImRhc2hib2FyZFwiPkRhc2hib2FyZDwvYT5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXItbGlua1wiPlxuICAgICAgICAgIDxhIGNsYXNzPVwibGlua1wiIGlkPVwic3RhdHVzXCI+U3RhdHVzPC9hPlxuICAgICAgICAgIDxhIGNsYXNzPVwibGlua1wiIGlkPVwiYXBpXCI+QXBpPC9hPlxuICAgICAgICAgIDxhIGNsYXNzPVwibGlua1wiIGlkPVwiZG9jc1wiPkRvY3M8L2E+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPC9mb290ZXI+XG4gICAgIik7CiAgcGFnZS5jc3MoIlxuICAgIGZvb3RlciB7XG4gICAgICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigiLmNvbmNhdChkaXNwbGF5LmdldCgibmF2YmFyIilbImJsdXIiXSwgIik7XG4gICAgICAgIHotaW5kZXg6MTAwMDtcbiAgICAgICAgcG9zaXRpb246IGZpeGVkO1xuICAgICAgICBsZWZ0OiAwO1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgYm90dG9tOiAwO1xuICAgICAgICBiYWNrZ3JvdW5kOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoIm5hdmJhciIpWyJiYWNrZ3JvdW5kIl0sICI7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC5jb250YWluZXItNCB7XG4gICAgICAgIHdpZHRoOjEwMCU7XG4gICAgICAgIGhlaWdodDoxMCU7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjpjb2x1bW47XG4gICAgICB9XG4gICAgICBcbiAgICAgIC5jb250YWluZXItdGl0bGVzIHtcbiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTBweDtcbiAgICAgICAgd2lkdGg6NTAlO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWV2ZW5seTtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246cm93O1xuICAgICAgfVxuICAgICAgXG4gICAgICAudGl0bGUge1xuICAgICAgICB3aWR0aDogMTUwcHg7XG4gICAgICAgIGZvbnQtZmFtaWx5OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGNvbG9yOiIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bMV0sICI7XG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLmNvbnRhaW5lci1saW5rcyB7XG4gICAgICAgIG1hcmdpbi1ib3R0b206IDMwcHg7XG4gICAgICAgIHdpZHRoOjUwJTtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1ldmVubHk7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGZsZXgtZGlyZWN0aW9uOnJvdztcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLmNvbnRhaW5lci1saW5rIHtcbiAgICAgICAgd2lkdGg6IDE1MHB4O1xuICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjpjb2x1bW47XG4gICAgICB9XG4gICAgICBcbiAgICAgIC5saW5rIHtcbiAgICAgICAgZm9udC1mYW1pbHk6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICIsIHNhbnMtc2VyaWY7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQtbGlnaHQiXSwgIjtcbiAgICAgICAgY29sb3I6IikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVswXSwgIjtcbiAgICAgICAgY3Vyc29yOnBvaW50ZXI7XG4gICAgICB9XG4gICAgICBcbiAgICAgICNjb3B5IHtcbiAgICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG4gICAgICAgIGZvbnQtZmFtaWx5OiAgIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodCJdLCAiO1xuICAgICAgICBjb2xvcjoiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzBdLCAiO1xuICAgICAgICBib3R0b206IDA7XG4gICAgICAgIGxlZnQ6MDtcbiAgICAgICAgbWFyZ2luOjEwcHg7XG4gICAgICB9XG5cbiAgICAgIHB7Y29sb3I6IikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICJ9XG5cbiAgICAgIEBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDEyNzBweCl7XG4gICAgICAgIGZvb3RlciB7XG4gICAgICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG4gICAgICAgICAgdG9wOjEwMCU7XG4gICAgICAgIH1cbiAgICAgICAgI2NvcHkge1xuICAgICAgICAgIHRvcDoxMDAlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgXG4gICAgICBAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiA1NTBweCl7XG4gICAgICAgIGZvb3Rlcjoge1xuICAgICAgICAgIGRpc3BsYXk6bm9uZTtcbiAgICAgICAgfVxuXG4gICAgICAgICNjb3B5IHtcbiAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgdG9wOjA7XG4gICAgICAgICAgd2lkdGg6MTAwJTtcbiAgICAgICAgICBsZWZ0OjA7XG4gICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICB9XG4gICAgICAgIC5jb250YWluZXItbGlua3Mge1xuICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgIG1hcmdpbi1ib3R0b206IDBweDtcbiAgICAgICAgfVxuICAgICAgICAuY29udGFpbmVyLXRpdGxlcyB7XG4gICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgbWFyZ2luLWJvdHRvbTogMHB4O1xuICAgICAgICB9XG4gICAgICAgIGZvb3RlciB7XG4gICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgICBoZWlnaHQ6IDIwJTtcbiAgICAgICAgfVxuICAgICAgICAuY29udGFpbmVyLTR7XG4gICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgIGJvdHRvbTogMzAlO1xuICAgICAgICB9XG4gICAgICB9XG4gIH1cbiAgICAgICIpKTsKICBmdW5jdGlvbiBvbl9yZW5kZXIoKSB7CiAgICB2YXIgYnV0dG9ucyA9IHBhZ2UuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibGluayIpOwogICAgdmFyIGJ1dHRvblByZXNzZWQgPSBmdW5jdGlvbiBidXR0b25QcmVzc2VkKGUpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi8iICsgZS50YXJnZXQuaWQpOwogICAgfTsKICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihidXR0b25zKSwKICAgICAgX3N0ZXA7CiAgICB0cnkgewogICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgIHZhciBidXR0b24gPSBfc3RlcC52YWx1ZTsKICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBidXR0b25QcmVzc2VkKTsKICAgICAgfQogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICB9IGZpbmFsbHkgewogICAgICBfaXRlcmF0b3IuZigpOwogICAgfQogIH0KICBwYWdlLm9uX3JlbmRlcihvbl9yZW5kZXIpOwogIHBhZ2UucmVuZGVyKCk7Cn0KCn0seyIuLi9saWIvRnJhbWV3b3JrLm1qcyI6MTB9XSw2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk5hdmJhciA9IE5hdmJhcjsKZnVuY3Rpb24gTmF2YmFyKHJvdXRlcikgewogIHZhciBfcmVxdWlyZSA9IHJlcXVpcmUoIi4uL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgICBQYWdlID0gX3JlcXVpcmUuUGFnZSwKICAgIERpc3BsYXkgPSBfcmVxdWlyZS5EaXNwbGF5OwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlMi5Jc0xvZ2VkSW4sCiAgICBHZXRQcm9maWxlID0gX3JlcXVpcmUyLkdldFByb2ZpbGU7CiAgdmFyIF9yZXF1aXJlMyA9IHJlcXVpcmUoIi4uL3NjcmlwdHMvY29va2llcy5tanMiKSwKICAgIHNldENvb2tpZSA9IF9yZXF1aXJlMy5zZXRDb29raWUsCiAgICBnZXRDb29raWUgPSBfcmVxdWlyZTMuZ2V0Q29va2llLAogICAgY2hlY2tDb29raWUgPSBfcmVxdWlyZTMuY2hlY2tDb29raWU7CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiTmF2YmFyIik7CiAgdmFyIGRpc3BsYXkgPSBuZXcgRGlzcGxheSgpOwogIHZhciBsb2dvID0gcGFnZS5pbWFnZSgibG9nby5zdmciKTsKICBwYWdlLmh0bWwoIlxuICAgICAgPGRpdiBpZD1cIm5hdmJhclwiPlxuICAgICAgICAgIDxpbWcgc3JjPVwiIi5jb25jYXQoZGlzcGxheS5nZXQoImxvZ28iKVsidXJsIl0sICJcIiBpZD1cImxvZ29cIiBhbHQ9XCJCbG9ja2NvaW4ncyBsb2dvLCBpbiB0aGUgZm9ybSBvZiBhIGNvaW4uXCI+PC9pbWc+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lci0zIG5vdC1sb2dnZWRcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0cmFucy1idXR0b25cIiBpZD1cInJlZ2lzdGVyXCI+UmVnaXN0ZXI8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0cmFucy1idXR0b25cIiBpZD1cImxvZ2luXCI+TG9naW48L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0cmFucy1idXR0b25cIiBpZD1cImV4cGxvcmUtMVwiPlRyZW5kaW5nPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lci0zIGxvZ2dlZFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRyYW5zLWJ1dHRvblwiIGlkPVwiZmVlZFwiPkZlZWQ8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0cmFucy1idXR0b25cIiBpZD1cImV4cGxvcmUtMlwiPlRyZW5kaW5nPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidHJhbnMtYnV0dG9uXCIgaWQ9XCJyYW5kb21cIj5FeHBsb3JlPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGltZyBzcmM9XCIiKS5jb25jYXQobG9nbywgIlwiIGlkPVwicHJvZmlsZVwiIGNsYXNzPVwibG9nZ2VkXCJhbHQ9XCJVc2VyJ3MgcHJvZmlsZSBwaWN0dXJlXCI+PC9pbWc+XG4gICAgICA8L2Rpdj5cbiAgICAgICIpKTsKICBwYWdlLmNzcygiXG4gICAgICAjbmF2YmFyIHtcbiAgICAgICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoIi5jb25jYXQoZGlzcGxheS5nZXQoIm5hdmJhciIpWyJibHVyIl0sICIpO1xuICAgICAgICAgIHotaW5kZXg6MTAwO1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgcG9zaXRpb246IGZpeGVkO1xuICAgICAgICAgIHRvcDowO1xuICAgICAgICAgIGxlZnQ6MDtcbiAgICAgICAgICB3aWR0aDoxMDAlO1xuICAgICAgICAgIGhlaWdodDo3LjUlO1xuICAgICAgICAgIGJhY2tncm91bmQ6IikuY29uY2F0KGRpc3BsYXkuZ2V0KCJuYXZiYXIiKVsiYmFja2dyb3VuZCJdLCAiXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICNsb2dvIHtcbiAgICAgICAgICBtYXJnaW4tbGVmdDoyLjUlO1xuICAgICAgICAgIHdpZHRoOiBhdXRvO1xuICAgICAgICAgIGhlaWdodDogODUlO1xuICAgICAgICAgIGRpc3BsYXk6YmxvY2s7XG4gICAgICAgICAgY3Vyc29yOnBvaW50ZXI7XG4gICAgICAgICAgb2JqZWN0LWZpdDogY292ZXI7XG4gICAgICAgICAgei1pbmRleDoxMDA7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICNwcm9maWxlIHtcbiAgICAgICAgICBib3JkZXItcmFkaXVzOjI1NnB4O1xuICAgICAgICAgIG9iamVjdC1maXQ6IGNvdmVyO1xuICAgICAgICAgIG1hcmdpbi1yaWdodDoyLjUlO1xuICAgICAgICAgIHBvc2l0aW9uOnJlbGF0aXZlO1xuICAgICAgICAgIHdpZHRoOiBhdXRvO1xuICAgICAgICAgIGhlaWdodDogODUlO1xuICAgICAgICAgIGRpc3BsYXk6YmxvY2s7XG4gICAgICAgICAgY3Vyc29yOnBvaW50ZXI7XG4gICAgICAgICAgei1pbmRleDoxMDA7XG4gICAgICAgIH1cblxuICAgICAgICAudHJhbnMtYnV0dG9uIHtcbiAgICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcbiAgICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICAgICAgZm9udC1mYW1pbHk6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICI7XG4gICAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzFdLCAiO1xuICAgICAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQiXSwgIjtcbiAgICAgICAgICB6LWluZGV4OjEwMDtcbiAgICAgICAgfVxuICAgICAgICAubm90LWxvZ2dlZCB7XG4gICAgICAgICAgbWFyZ2luLWxlZnQ6Mi41JTtcbiAgICAgICAgfVxuICAgICAgICAuY29udGFpbmVyLTMge1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgZ2FwOjMwcHhcbiAgICAgICAgfVxuICAgICAgXG4gICAgICAgIEBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDU1MHB4KXtcbiAgICAgICAgICBcbiAgICAgICAgICAjbmF2YmFyIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgbWFyZ2luLXRvcDogMjBweDtcbiAgICAgICAgICB9XG4gICAgICAgICAgLmNvbnRhaW5lci0zIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDtcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLnRyYW5zLWJ1dHRvbiB7XG4gICAgICAgICAgICB3aWR0aDogMzAlO1xuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAgICIpKTsKICBmdW5jdGlvbiBvbl9yZW5kZXIoKSB7CiAgICBpZiAoSXNMb2dlZEluKCkpIHsKICAgICAgdmFyIGVsZW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbm90LWxvZ2dlZCcpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZWxlbWVudHNbaV0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgfQogICAgICBpZiAoY2hlY2tDb29raWUoInYxLXByb2ZpbGUtcGljdHVyZSIpID09IGZhbHNlKSB7CiAgICAgICAgR2V0UHJvZmlsZShnZXRDb29raWUoInYxLWlkIikpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOwogICAgICAgICAgc2V0Q29va2llKCJ2MS1wcm9maWxlLXBpY3R1cmUiLCBkYXRhWyJwcm9maWxlLXBpY3R1cmUiXSwgMzY1KTsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcm9maWxlIikuc3JjID0gZ2V0Q29va2llKCJ2MS1wcm9maWxlLXBpY3R1cmUiKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicHJvZmlsZSIpLnNyYyA9IGdldENvb2tpZSgidjEtcHJvZmlsZS1waWN0dXJlIik7CiAgICAgIH0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInByb2ZpbGUiKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvZGFzaGJvYXJkIik7CiAgICAgIH07CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmZWVkIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByb3V0ZXIubmF2aWdhdGVUbygiL2ZlZWQiKTsKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZWdpc3RlciIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9yZWdpc3RlciIpOwogICAgICB9OwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibG9naW4iKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvbG9naW4iKTsKICAgICAgfTsKICAgICAgdmFyIGVsZW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbG9nZ2VkJyk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlbGVtZW50c1tpXS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICB9CiAgICB9CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZXhwbG9yZS0xIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi90cmVuZGluZyIpOwogICAgfTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJleHBsb3JlLTIiKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICByb3V0ZXIubmF2aWdhdGVUbygiL3RyZW5kaW5nIik7CiAgICB9OwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJhbmRvbSIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvZXhwbG9yZSIpOwogICAgfTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2dvIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi8iKTsKICAgIH07CiAgfQogIHBhZ2Uub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2xpYi9GcmFtZXdvcmsubWpzIjoxMCwiLi4vc2NyaXB0cy9hcGkubWpzIjoyOSwiLi4vc2NyaXB0cy9jb29raWVzLm1qcyI6MzB9XSw3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk5ld1Bvc3RCdXR0b24gPSBOZXdQb3N0QnV0dG9uOwpmdW5jdGlvbiBOZXdQb3N0QnV0dG9uKHJvdXRlcikgewogIHZhciBfcmVxdWlyZSA9IHJlcXVpcmUoIi4uL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgICBQYWdlID0gX3JlcXVpcmUuUGFnZSwKICAgIERpc3BsYXkgPSBfcmVxdWlyZS5EaXNwbGF5OwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlMi5Jc0xvZ2VkSW47CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiTmV3UG9zdEJ1dHRvbiIpOwogIHZhciBkaXNwbGF5ID0gbmV3IERpc3BsYXkoKTsKICBwYWdlLmh0bWwoIlxuICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIiBpZD1cIm5ld19idXR0b25cIj5hZGQ8L3NwYW4+XG4gICAgIik7CiAgcGFnZS5jc3MoIlxuICAgICNuZXdfYnV0dG9uIHtcbiAgICAgIHRyYW5zaXRpb24tZHVyYXRpb246IDAuNXM7XG4gICAgICB6LWluZGV4OjEwMDAwO1xuICAgICAgd2lkdGg6IDk0cHg7XG4gICAgICBoZWlnaHQ6IDk0cHg7XG4gICAgICBib3JkZXItcmFkaXVzOjI1NnB4O1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjoiLmNvbmNhdChkaXNwbGF5LmdldCgibmV3IilbImJhY2tncm91bmQiXVs0XSwgIjtcbiAgICAgIHBvc2l0aW9uOmZpeGVkO1xuICAgICAgYm90dG9tOjI1cHg7XG4gICAgICByaWdodDoyNXB4O1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgibmV3IilbImNvbG9yIl1bNF0sICI7XG4gICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuICAgICAgbGluZS1oZWlnaHQ6IDk0cHg7XG4gICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgIGZvbnQtc2l6ZTogNzJweDtcbiAgICAgIGJvcmRlcjoiKS5jb25jYXQoZGlzcGxheS5nZXQoIm5ldyIpWyJib3JkZXIiXVs0XSwgIjtcbiAgICB9XG4gICAgI25ld19idXR0b246aG92ZXIge1xuICAgICAgICB3aWR0aDogMTAwcHg7XG4gICAgICAgIGhlaWdodDogMTAwcHg7XG4gICAgICAgIGZvbnQtc2l6ZTogNzhweDtcbiAgICAgICAgbGluZS1oZWlnaHQ6IDEwMHB4O1xuICAgIH1cbiAgICBcbiAgICAiKSk7CiAgZnVuY3Rpb24gb25fcmVuZGVyKCkgewogICAgaWYgKElzTG9nZWRJbigpID09IGZhbHNlKSB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJuZXdfYnV0dG9uIikucmVtb3ZlKCk7CiAgICB9IGVsc2UgewogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibmV3X2J1dHRvbiIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9uZXciKTsKICAgICAgfTsKICAgIH0KICB9CiAgcGFnZS5vbl9yZW5kZXIob25fcmVuZGVyKTsKICBwYWdlLnJlbmRlcigpOwp9Cgp9LHsiLi4vbGliL0ZyYW1ld29yay5tanMiOjEwLCIuLi9zY3JpcHRzL2FwaS5tanMiOjI5fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5Ob3RpZmljYXRpb24gPSBOb3RpZmljYXRpb247CmZ1bmN0aW9uIE5vdGlmaWNhdGlvbih0eXBlLCB0ZXh0KSB7CiAgdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiLi4vbGliL0ZyYW1ld29yay5tanMiKSwKICAgIFBhZ2UgPSBfcmVxdWlyZS5QYWdlLAogICAgTW9kdWxlID0gX3JlcXVpcmUuTW9kdWxlLAogICAgRGlzcGxheSA9IF9yZXF1aXJlLkRpc3BsYXk7CiAgdmFyIGRpc3BsYXkgPSBuZXcgRGlzcGxheSgpOwogIHZhciBwYWdlID0gdW5kZWZpbmVkOwogIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vdGlmLWNvbnRhaW5lcicpOwogIGlmIChlbGVtZW50ID09PSBudWxsKSB7CiAgICBwYWdlID0gbmV3IFBhZ2UoIk5vdGlmaWNhdGlvbiIpOwogICAgcGFnZS5odG1sKCJcbiAgICAgICAgICAgIDxkaXYgaWQ9XCJub3RpZi1jb250YWluZXJcIj48L2Rpdj5cbiAgICAgICAgIik7CiAgICBwYWdlLmNzcygiXG4gICAgICAgICAgICAjbm90aWYtY29udGFpbmVyIHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjpmaXhlZDtcbiAgICAgICAgICAgICAgICB3aWR0aDoxMDAlO1xuICAgICAgICAgICAgICAgIGhlaWdodDo5MCU7XG4gICAgICAgICAgICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6c3RhcnQ7XG4gICAgICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246Y29sdW1uO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOmFic29sdXRlO1xuICAgICAgICAgICAgICAgIHRvcDo3LjUlO1xuICAgICAgICAgICAgICAgIGxlZnQ6MDtcbiAgICAgICAgICAgICAgICB6LWluZGV4OjEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgIik7CiAgICBwYWdlLmRlbGV0ZV9hbmltYXRpb24oIlxuICAgICAgICBAa2V5ZnJhbWVzIGRlbGV0ZSB7XG4gICAgICAgICAgICAwJSB7XG4gICAgICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwJSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAxMDAlIHtcbiAgICAgICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwJSk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAiKTsKICAgIHBhZ2UucmVuZGVyKCk7CiAgfQogIHZhciBtb2R1bGUgPSBuZXcgTW9kdWxlKCJOb3RpZmljYXRpb24iLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm90aWYtY29udGFpbmVyJykpOwogIG1vZHVsZS5odG1sKCJcbiAgICAgICAgPGRpdiBpZD1cIm5ldy1ub3RpZlwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkIHR5cGVcIiBpZD1cInR5cGVcIj5tb3JlX2hvcml6PC9zcGFuPlxuICAgICAgICAgICAgPGRpdiBpZD1cInRleHRcIiBjbGFzcz1cIm5vdGlmLXRleHRcIj5Mb2FkaW5nLi4uPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICIpOwogIG1vZHVsZS5jc3MoIlxuICAgICAgICAjbmV3LW5vdGlmIHtcbiAgICAgICAgICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTtcbiAgICAgICAgICAgIGJvcmRlcjogc29saWQgd2hpdGUgMXB4O1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMzJweDtcbiAgICAgICAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDpzdGFydDtcbiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gICAgICAgICAgICBoZWlnaHQ6YXV0bztcbiAgICAgICAgICAgIHdpZHRoOmF1dG87XG4gICAgICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcbiAgICAgICAgICAgIG1hcmdpbjoxMHB4O1xuICAgICAgICAgICAgei1pbmRleDoxMDAwMDtcbiAgICAgICAgfVxuICAgICAgICAjdHlwZSB7XG4gICAgICAgICAgICBjb2xvcjoiLmNvbmNhdChkaXNwbGF5LmdldCgibm90aWZpY2F0aW9uIilbImljb24tY29sb3IiXSwgIjtcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzRdLCAiO1xuICAgICAgICAgICAgbWFyZ2luLWxlZnQ6MTBweDtcbiAgICAgICAgfVxuICAgICAgICAjdGV4dCB7XG4gICAgICAgICAgICBjb2xvcjoiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiO1xuICAgICAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzNdLCAiO1xuICAgICAgICAgICAgZm9udC1zdHlsZTogbm9ybWFsO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodCJdLCAiO1xuICAgICAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDtcbiAgICAgICAgICAgIHdpZHRoOmF1dG87XG4gICAgICAgICAgICB0ZXh0LWFsaWduOmNlbnRlcjtcbiAgICAgICAgICAgIG1hcmdpbi1yaWdodDoyMHB4O1xuICAgICAgICAgICAgei1pbmRleDoxMDAwMDtcbiAgICAgICAgICB9XG4gICAgIikpOwogIHZhciB0eXBlcyA9IFsiY2hlY2siLCAiY2xvc2UiLCAiaW5mbyIsICJoZWxwIl07CiAgZnVuY3Rpb24gb25fcmVuZGVyKCkgewogICAgdHJ5IHsKICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJub3RpZi10ZXh0IilbMF0uaW5uZXJUZXh0ID0gdGV4dDsKICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJ0eXBlIilbMF0uaW5uZXJUZXh0ID0gdHlwZXNbdHlwZV07CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIG1vZHVsZVsiZGVsZXRlIl0oKTsKICAgICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub3RpZi1jb250YWluZXInKTsKICAgICAgICBpZiAoZWxlbWVudCAhPT0gbnVsbCkgewogICAgICAgICAgZWxlbWVudC5yZW1vdmUoKTsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJub3RpZmljYXRpb24iKVswXS5yZW1vdmUoKTsKICAgICAgICB9CiAgICAgIH0sIDYwMDApOwogICAgfSBjYXRjaCAoX3VudXNlZCkgewogICAgICBtb2R1bGVbImRlbGV0ZSJdKCk7CiAgICAgIHZhciBfZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub3RpZi1jb250YWluZXInKTsKICAgICAgaWYgKF9lbGVtZW50ICE9PSBudWxsKSB7CiAgICAgICAgX2VsZW1lbnQucmVtb3ZlKCk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIm5vdGlmaWNhdGlvbiIpWzBdLnJlbW92ZSgpOwogICAgICB9CiAgICB9CiAgfQogIG1vZHVsZS5kZWxldGVfYW5pbWF0aW9uKCJcbiAgICBAa2V5ZnJhbWVzIGRlbGV0ZSB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwJSk7XG4gICAgICAgIH1cbiAgICAgICAgMTAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMTAlKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIG1vZHVsZS5zcGF3bl9hbmltYXRpb24oIlxuICAgIEBrZXlmcmFtZXMgc3Bhd24ge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwJSk7XG4gICAgICAgIH1cbiAgICAgICAgMTAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBtb2R1bGUub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgbW9kdWxlLnJlbmRlcigpOwp9Cgp9LHsiLi4vbGliL0ZyYW1ld29yay5tanMiOjEwfV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5MaXZlUG9zdCA9IExpdmVQb3N0OwpleHBvcnRzLlBvc3QgPSBQb3N0OwpleHBvcnRzLlByZXZpZXdQb3N0ID0gUHJldmlld1Bvc3Q7CmZ1bmN0aW9uIFBvc3Qocm91dGVyLCBwb3N0LCBwYXJlbnQpIHsKICB2YXIgX3JlcXVpcmUgPSByZXF1aXJlKCIuLi9saWIvRnJhbWV3b3JrLm1qcyIpLAogICAgTW9kdWxlID0gX3JlcXVpcmUuTW9kdWxlLAogICAgRGlzcGxheSA9IF9yZXF1aXJlLkRpc3BsYXk7CiAgdmFyIF9yZXF1aXJlMiA9IHJlcXVpcmUoIi4uL3NjcmlwdHMvYXBpLm1qcyIpLAogICAgVmlld1Bvc3QgPSBfcmVxdWlyZTIuVmlld1Bvc3QsCiAgICBJc0xvZ2VkSW4gPSBfcmVxdWlyZTIuSXNMb2dlZEluLAogICAgUG9zdExpa2VkID0gX3JlcXVpcmUyLlBvc3RMaWtlZCwKICAgIExpa2VQb3N0ID0gX3JlcXVpcmUyLkxpa2VQb3N0LAogICAgR2V0UHJvZmlsZSA9IF9yZXF1aXJlMi5HZXRQcm9maWxlOwogIHZhciBkaXNwbGF5ID0gbmV3IERpc3BsYXkoKTsKICB2YXIgbW9kdWxlID0gbmV3IE1vZHVsZSgiUG9zdCIpOwogIHZhciBibGFua19sb2dvID0gbW9kdWxlLmltYWdlKCJsb2dvX2JsYW5rLnN2ZyIpOwogIGZ1bmN0aW9uIHRpbWVDb252ZXJ0ZXIoVU5JWF90aW1lc3RhbXApIHsKICAgIHZhciBhID0gbmV3IERhdGUoVU5JWF90aW1lc3RhbXAgKiAxMDAwKTsKICAgIHZhciBtb250aHMgPSBbJ0phbicsICdGZWInLCAnTWFyJywgJ0FwcicsICdNYXknLCAnSnVuJywgJ0p1bCcsICdBdWcnLCAnU2VwJywgJ09jdCcsICdOb3YnLCAnRGVjJ107CiAgICB2YXIgeWVhciA9IGEuZ2V0RnVsbFllYXIoKTsKICAgIHZhciBtb250aCA9IG1vbnRoc1thLmdldE1vbnRoKCldOwogICAgdmFyIGRhdGUgPSBhLmdldERhdGUoKTsKICAgIHZhciBob3VyID0gKCcwJyArIGEuZ2V0SG91cnMoKSkuc2xpY2UoLTIpOyAvLyBQYWQgc2luZ2xlLWRpZ2l0IGhvdXJzIHdpdGggbGVhZGluZyB6ZXJvCiAgICB2YXIgbWluID0gKCcwJyArIGEuZ2V0TWludXRlcygpKS5zbGljZSgtMik7IC8vIFBhZCBzaW5nbGUtZGlnaXQgbWludXRlcyB3aXRoIGxlYWRpbmcgemVybwogICAgdmFyIHNlYyA9ICgnMCcgKyBhLmdldFNlY29uZHMoKSkuc2xpY2UoLTIpOyAvLyBQYWQgc2luZ2xlLWRpZ2l0IHNlY29uZHMgd2l0aCBsZWFkaW5nIHplcm8KICAgIHZhciB0aW1lID0gZGF0ZSArICcgJyArIG1vbnRoICsgJyAnICsgeWVhciArICcgJyArIGhvdXIgKyAnOicgKyBtaW4gKyAnOicgKyBzZWM7CiAgICByZXR1cm4gdGltZTsKICB9CiAgbW9kdWxlLmh0bWwoIlxuICAgIDxkaXYgaWQ9XCJwb3N0XCIgY2xhc3M9XCJwb3N0XCI+XG4gICAgICAgIDxkaXYgaWQ9XCJ0b3AtY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8aW1nIGlkPVwicG9zdC1pbWdcIiBjbGFzcz1cInByb2ZpbGUtcGljdHVyZVwiIGNsYXNzPVwidGV4dFwiPjwvaW1nPlxuICAgICAgICAgICAgPGRpdiBpZD1cInBvc3QtdXNlclwiIGNsYXNzPVwidGV4dCB1c2VybmFtZVwiPkxvYWRpbmcuLi48L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwb3N0LWJhZGdlcy1jb250YWluZXJcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgaWQ9XCJwb3N0LWRhdGFcIiBjbGFzcz1cInRleHQgZGF0YVwiPkxvYWRpbmcuLi48L2Rpdj5cbiAgICAgICAgPGRpdiBpZD1cInBvc3QtbWV0YVwiIGNsYXNzPVwidGV4dCB0aW1lc3RhbXBcIiA+QmxvY2tDb2luIEJyb3dzZXIgQXBwIC0gTG9hZGluZy4uLjwvZGl2PlxuICAgICAgICA8ZGl2IGlkPVwicG9zdC1zdGF0c1wiIGNsYXNzPVwic3RhdHMgdGV4dFwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkXCI+dmlzaWJpbGl0eTwvc3Bhbj4gXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cInZpZXdzXCI+MDwvc3Bhbj4gXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWQgbGlrZS1idXR0b25cIj5mYXZvcml0ZTwvc3Bhbj4gXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxpa2VzXCI+MDwvc3Bhbj4gXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWQgY29tbWVudC1idXR0b25cIj5jaGF0PC9zcGFuPiBcbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY29tbWVudFwiPjA8L3NwYW4+IFxuICAgICAgICAgICAgPGltZyBzcmM9XCIiLmNvbmNhdChibGFua19sb2dvLCAiXCIgY2xhc3M9XCJhLWJsb2NrY29pblwiIC8+IFxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJibG9ja2NvaW5cIj4wPC9zcGFuPiBcbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgIikpOwogIG1vZHVsZS5jc3MoIlxuICAgIC5hLWJsb2NrY29pbiB7XG4gICAgICAgIHdpZHRoOjI0cHg7XG4gICAgICAgIGhlaWdodDoyNHB4O1xuICAgIH1cbiAgICAubGlrZS1idXR0b24ge1xuICAgICAgICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAwLjVzO1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICB9XG4gICAgLmNvbW1lbnQtYnV0dG9uOmhvdmVyIHtcbiAgICAgICAgZm9udC1zaXplOiAyNnB4O1xuICAgIH1cbiAgICAuY29tbWVudC1idXR0b24ge1xuICAgICAgICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAwLjVzO1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICB9XG4gICAgLmxpa2UtYnV0dG9uOmhvdmVyIHtcbiAgICAgICAgZm9udC1zaXplOiAyNnB4O1xuICAgIH1cbiAgICAuYS1ibG9ja2NvaW46aG92ZXIge1xuICAgICAgICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAwLjVzO1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgICAgd2lkdGg6MjZweDtcbiAgICAgICAgaGVpZ2h0OjI2cHg7XG4gICAgfVxuICAgIC5saWtlZCB7XG4gICAgICAgIGNvbG9yOiNGRjAwMDA7XG4gICAgICAgIGZvbnQtdmFyaWF0aW9uLXNldHRpbmdzOlxuICAgICAgICAnRklMTCcgMSxcbiAgICAgICAgJ3dnaHQnIDQwMCxcbiAgICAgICAgJ0dSQUQnIDAsXG4gICAgICAgICdvcHN6JyAyNFxuICAgIH1cbiAgICAjcG9zdCB7XG4gICAgICAgIGJhY2tncm91bmQ6ICIuY29uY2F0KGRpc3BsYXkuZ2V0KCJwb3N0IilbImJhY2tncm91bmQiXSwgIjtcbiAgICAgICAgd2lkdGg6MTAwJTtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB0b3A6MDtcbiAgICAgICAgbGVmdDowO1xuICAgICAgICBib3JkZXI6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgicG9zdCIpWyJib3JkZXIiXSwgIjtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJwb3N0IilbImJvcmRlci1yYWRpdXMiXSwgIlxuICAgIH1cbiAgICAucG9zdC1iYWRnZSB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjVweDtcbiAgICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiYmFkZ2UiKVsiY29sb3IiXSwgIjtcbiAgXG4gICAgICB9XG4gICAgICAjcG9zdC1iYWRnZXMtY29udGFpbmVyIHtcbiAgICAgICAgd2lkdGg6MjAlO1xuICAgICAgICBkaXNwbGF5OmZsZXg7XG4gICAgICAgIGZsZXgtZGlyZWN0aW9uOnJvdztcbiAgICAgICAganVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnQ7XG4gICAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgICAgbWFyZ2luOjEwcHg7XG4gICAgICAgIGJvcmRlcjoiKS5jb25jYXQoZGlzcGxheS5nZXQoImJhZGdlIilbImJvcmRlciJdLCAiO1xuICAgICAgICBib3JkZXItcmFkaXVzOiIpLmNvbmNhdChkaXNwbGF5LmdldCgiYmFkZ2UiKVsiYm9yZGVyLXJhZGl1cyJdLCAiO1xuICAgICAgfVxuICAgICAgLnRleHQge1xuICAgICAgICBmb250LWZhbWlseTogJyIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICInLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsxXSwgIjtcbiAgICAgICAgY29sb3I6IikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgfVxuXG5cbiAgICAjcG9zdC1pbWcge1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgICAgYm9yZGVyLXJhZGl1czoyNTZweDtcbiAgICAgICAgd2lkdGg6IDQ4cHg7XG4gICAgICAgIGhlaWdodDogNDhweDtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgIH1cblxuICAgICNwb3N0LXVzZXIge1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgICAgICBtYXJnaW4tbGVmdDowO1xuICAgIH1cblxuICAgICN0b3AtY29udGFpbmVyIHtcbiAgICAgICAgcG9zaXRpb246cmVsYXRpdmU7XG4gICAgICAgIHRvcDowO1xuICAgICAgICBsZWZ0OjA7XG4gICAgICAgIHdpZHRoOjEwMCU7XG4gICAgICAgIGhlaWdodDpmaXQtY29udGVudDtcbiAgICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHN0YXJ0O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIFxuICAgIH1cblxuICAgICNwb3N0LW1ldGEge1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAzMDA7XG4gICAgICAgIGZvbnQtc2l6ZTogMTdweDtcbiAgICB9XG4gICAgI3Bvc3Qtc3RhdHMge1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIGJvdHRvbTowO1xuICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcbiAgICAgICAgcmlnaHQ6MDtcbiAgICAgICAgdGV4dC1hbGlnbjpyaWdodDtcbiAgICAgICAgZm9udC13ZWlnaHQ6IDMwMDtcbiAgICAgICAgZm9udC1zaXplOiAxN3B4O1xuICAgIH1cbiAgICAjcG9zdC1kYXRhIHtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgIH1cbiAgICAiKSk7CiAgbW9kdWxlLnBhcmVudChwYXJlbnQpOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIGNvbnNvbGUubG9nKHBvc3QpOwogICAgdmFyIGJ1eWVyID0gbnVsbDsKICAgIGlmICgiY29tbWVudHMiIGluIHBvc3QpIHsKICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJjb21tZW50IilbMF0uaW5uZXJUZXh0ID0gT2JqZWN0LmtleXMocG9zdFsiY29tbWVudHMiXSkubGVuZ3RoOwogICAgfQogICAgaWYgKHBvc3RbImJ1eWVyIl0gIT0gIk5vbmUiKSB7CiAgICAgIEdldFByb2ZpbGUocG9zdFsiYnV5ZXIiXSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICBidXllciA9IHZhbHVlOwogICAgICAgIHZhciBsaWtlZCA9IGZhbHNlOwogICAgICAgIG1vZHVsZS5kaXYuaWQgPSBwb3N0WyJpZCJdOwogICAgICAgIGlmIChidXllciA9PSBudWxsKSB7CiAgICAgICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInVzZXJuYW1lIilbMF0uaW5uZXJUZXh0ID0gcG9zdFsidXNlciJdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInVzZXJuYW1lIilbMF0uaW5uZXJUZXh0ID0gYnV5ZXJbImRpc3BsYXkiXSArICIgb3JpZ2luYWwgYnkgIiArIHBvc3RbInVzZXIiXTsKICAgICAgICB9CiAgICAgICAgdmFyIHRleHQgPSBwb3N0WyJkYXRhIl07CiAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSgvPi9nLCAnJyk7CiAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSgvPC9nLCAnJyk7CiAgICAgICAgdmFyIGh0bWxDb250ZW50ID0gbWFya2VkLnBhcnNlKHRleHQpOwogICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiZGF0YSIpWzBdLmlubmVySFRNTCA9IGh0bWxDb250ZW50OwogICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidGltZXN0YW1wIilbMF0uaW5uZXJUZXh0ID0gIkJsb2NrQ29pbiBCcm93c2VyIEFwcCAtICIuY29uY2F0KHRpbWVDb252ZXJ0ZXIocG9zdFsiZGF0ZSJdKSk7CiAgICAgICAgaWYgKGJ1eWVyID09IG51bGwpIHsKICAgICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgicHJvZmlsZS1waWN0dXJlIilbMF0uc3JjID0gcG9zdFsicHJvZmlsZS1waWN0dXJlIl07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgicHJvZmlsZS1waWN0dXJlIilbMF0uc3JjID0gYnV5ZXJbInByb2ZpbGUtcGljdHVyZSJdOwogICAgICAgIH0KICAgICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInZpZXdzIilbMF0uaW5uZXJUZXh0ID0gcG9zdFsidmlld3MiXTsKICAgICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImxpa2VzIilbMF0uaW5uZXJUZXh0ID0gcG9zdFsibGlrZXMiXTsKICAgICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImJsb2NrY29pbiIpWzBdLmlubmVyVGV4dCA9IHBvc3RbInByaWNlIl07CiAgICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJwcm9maWxlLXBpY3R1cmUiKVswXS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKGJ1eWVyID09IG51bGwpIHsKICAgICAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9wcm9maWxlLyIgKyBwb3N0WyJ1c2VyLWlkIl0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9wcm9maWxlLyIgKyBidXllclsiaWQiXSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBpZiAocG9zdFsiaXNCdXlhYmxlIl0gPT0gdHJ1ZSkgewogICAgICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJhLWJsb2NrY29pbiIpWzBdLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvYnV5LyIgKyBwb3N0WyJpZCJdKTsKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiYmxvY2tjb2luIilbMF0ucmVtb3ZlKCk7CiAgICAgICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImEtYmxvY2tjb2luIilbMF0ucmVtb3ZlKCk7CiAgICAgICAgfQogICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidXNlcm5hbWUiKVswXS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKGJ1eWVyID09IG51bGwpIHsKICAgICAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9wcm9maWxlLyIgKyBwb3N0WyJ1c2VyLWlkIl0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9wcm9maWxlLyIgKyBidXllclsiaWQiXSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICB2YXIgY29udGFpbmVyID0gbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJwb3N0LWJhZGdlcy1jb250YWluZXIiKVswXTsKICAgICAgICB2YXIgYmFkZ2VzID0gWyJhd2FyZF9zdGFyIiwgInZlcmlmaWVkIiwgInNoaWVsZF9wZXJzb24iLCAic21hcnRfdG95IiwgImxvY2FsX2ZpcmVfZGVwYXJ0bWVudCIsICJzY2llbmNlIl07CiAgICAgICAgdmFyIHRpdGxlcyA9IFsiQmxvY2tDb2luIEFkbWluIiwgIlZlcmlmaWVkIEFjY291bnQiLCAiQmxvY2tDb2luIFN0YWZmIiwgIkJvdCBBY2NvdW50IiwgIkJsb2NrQ29pbiBQcmVtaXVtIiwgIkJldGEgVGVzdGVyIl07CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidXllclsiYmFkZ2VzIl0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHZhciBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpOwogICAgICAgICAgc3Bhbi5jbGFzc05hbWUgPSAibWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZCBwb3N0LWJhZGdlIjsKICAgICAgICAgIHNwYW4uaW5uZXJIVE1MID0gYmFkZ2VzW2J1eWVyWyJiYWRnZXMiXVtpXV07CiAgICAgICAgICBzcGFuLnRpdGxlID0gdGl0bGVzW2J1eWVyWyJiYWRnZXMiXVtpXV07CiAgICAgICAgICAvLyBBcHBlbmQgdGhlIHNwYW4gZWxlbWVudCB0byB0aGUgY29udGFpbmVyIGRpdgogICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHNwYW4pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICB2YXIgX2xpa2VkID0gZmFsc2U7CiAgICAgIG1vZHVsZS5kaXYuaWQgPSBwb3N0WyJpZCJdOwogICAgICBpZiAoYnV5ZXIgPT0gbnVsbCkgewogICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidXNlcm5hbWUiKVswXS5pbm5lclRleHQgPSBwb3N0WyJ1c2VyIl07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJ1c2VybmFtZSIpWzBdLmlubmVyVGV4dCA9IGJ1eWVyWyJkaXNwbGF5Il0gKyAiIG9yaWdpbmFsIGJ5ICIgKyBwb3N0WyJ1c2VyIl07CiAgICAgIH0KICAgICAgdmFyIHRleHQgPSBwb3N0WyJkYXRhIl07CiAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoLz4vZywgJycpOwogICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC88L2csICcnKTsKICAgICAgdmFyIGh0bWxDb250ZW50ID0gbWFya2VkLnBhcnNlKHRleHQpOwogICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImRhdGEiKVswXS5pbm5lckhUTUwgPSBodG1sQ29udGVudDsKICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJ0aW1lc3RhbXAiKVswXS5pbm5lclRleHQgPSAiQmxvY2tDb2luIEJyb3dzZXIgQXBwIC0gIi5jb25jYXQodGltZUNvbnZlcnRlcihwb3N0WyJkYXRlIl0pKTsKICAgICAgaWYgKGJ1eWVyID09IG51bGwpIHsKICAgICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInByb2ZpbGUtcGljdHVyZSIpWzBdLnNyYyA9IHBvc3RbInByb2ZpbGUtcGljdHVyZSJdOwogICAgICB9IGVsc2UgewogICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgicHJvZmlsZS1waWN0dXJlIilbMF0uc3JjID0gYnV5ZXJbInByb2ZpbGUtcGljdHVyZSJdOwogICAgICB9CiAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidmlld3MiKVswXS5pbm5lclRleHQgPSBwb3N0WyJ2aWV3cyJdOwogICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImxpa2VzIilbMF0uaW5uZXJUZXh0ID0gcG9zdFsibGlrZXMiXTsKICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJibG9ja2NvaW4iKVswXS5pbm5lclRleHQgPSBwb3N0WyJwcmljZSJdOwogICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInByb2ZpbGUtcGljdHVyZSIpWzBdLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKGJ1eWVyID09IG51bGwpIHsKICAgICAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvcHJvZmlsZS8iICsgcG9zdFsidXNlci1pZCJdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9wcm9maWxlLyIgKyBidXllclsiaWQiXSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBpZiAocG9zdFsiaXNCdXlhYmxlIl0gPT0gdHJ1ZSkgewogICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiYS1ibG9ja2NvaW4iKVswXS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9idXkvIiArIHBvc3RbImlkIl0pOwogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJibG9ja2NvaW4iKVswXS5yZW1vdmUoKTsKICAgICAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImEtYmxvY2tjb2luIilbMF0ucmVtb3ZlKCk7CiAgICAgIH0KICAgICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJ1c2VybmFtZSIpWzBdLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9wcm9maWxlLyIgKyBwb3N0WyJ1c2VyLWlkIl0pOwogICAgICB9OwogICAgICB2YXIgY29udGFpbmVyID0gbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJwb3N0LWJhZGdlcy1jb250YWluZXIiKVswXTsKICAgICAgdmFyIGJhZGdlcyA9IFsiYXdhcmRfc3RhciIsICJ2ZXJpZmllZCIsICJzaGllbGRfcGVyc29uIiwgInNtYXJ0X3RveSIsICJsb2NhbF9maXJlX2RlcGFydG1lbnQiLCAic2NpZW5jZSIsICdidWdfcmVwb3J0J107CiAgICAgIHZhciB0aXRsZXMgPSBbIkJsb2NrQ29pbiBBZG1pbiIsICJWZXJpZmllZCBBY2NvdW50IiwgIkJsb2NrQ29pbiBTdGFmZiIsICJCb3QgQWNjb3VudCIsICJCbG9ja0NvaW4gUHJlbWl1bSIsICJCZXRhIFRlc3RlciIsICJCdWcgUmVwb3J0Il07CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zdFsiYmFkZ2VzIl0ubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTsKICAgICAgICBzcGFuLmNsYXNzTmFtZSA9ICJtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkIHBvc3QtYmFkZ2UiOwogICAgICAgIHNwYW4uaW5uZXJIVE1MID0gYmFkZ2VzW3Bvc3RbImJhZGdlcyJdW2ldXTsKICAgICAgICBzcGFuLnRpdGxlID0gdGl0bGVzW3Bvc3RbImJhZGdlcyJdW2ldXTsKICAgICAgICAvLyBBcHBlbmQgdGhlIHNwYW4gZWxlbWVudCB0byB0aGUgY29udGFpbmVyIGRpdgogICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzcGFuKTsKICAgICAgfQogICAgfQogICAgdmFyIGxpa2VkID0gZmFsc2U7CiAgICB2YXIgc2VudF9yZXF1ZXN0cyA9IGZhbHNlOwogICAgZnVuY3Rpb24gY2hlY2tfc2Nyb2xsKCkgewogICAgICB2YXIgdGFyZ2V0RGl2ID0gbW9kdWxlLmRpdjsKICAgICAgdmFyIGJvdW5kaW5nID0gdGFyZ2V0RGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwoKICAgICAgLy8gQ2hlY2tpbmcgaWYgdGhlIGRpdiBpcyBpbiB0aGUgdmlld3BvcnQKICAgICAgaWYgKGJvdW5kaW5nLnRvcCA+PSAwICYmIGJvdW5kaW5nLmxlZnQgPj0gMCAmJiBib3VuZGluZy5ib3R0b20gPD0gKHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KSAmJiBib3VuZGluZy5yaWdodCA8PSAod2luZG93LmlubmVyV2lkdGggfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKSkgewogICAgICAgIGlmIChJc0xvZ2VkSW4oKSAmJiBzZW50X3JlcXVlc3RzID09IGZhbHNlKSB7CiAgICAgICAgICBzZW50X3JlcXVlc3RzID0gdHJ1ZTsKICAgICAgICAgIFZpZXdQb3N0KHBvc3RbImlkIl0pOwogICAgICAgICAgUG9zdExpa2VkKHBvc3RbImlkIl0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgbGlrZWQgPSBkYXRhWyJsaWtlZCJdOwogICAgICAgICAgICBpZiAoZGF0YVsibGlrZWQiXSkgewogICAgICAgICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibGlrZS1idXR0b24iKVswXS5jbGFzc0xpc3QuYWRkKCdsaWtlZCcpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibGlrZS1idXR0b24iKVswXS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAobGlrZWQpIHsKICAgICAgICAgICAgICBsaWtlZCA9IGZhbHNlOwogICAgICAgICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibGlrZS1idXR0b24iKVswXS5jbGFzc0xpc3QucmVtb3ZlKCdsaWtlZCcpOwogICAgICAgICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibGlrZXMiKVswXS5pbm5lclRleHQgPSBwYXJzZUludChtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImxpa2VzIilbMF0uaW5uZXJUZXh0KSAtIDE7CiAgICAgICAgICAgICAgTGlrZVBvc3QocG9zdFsiaWQiXSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbGlrZWQgPSB0cnVlOwogICAgICAgICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibGlrZS1idXR0b24iKVswXS5jbGFzc0xpc3QuYWRkKCdsaWtlZCcpOwogICAgICAgICAgICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibGlrZXMiKVswXS5pbm5lclRleHQgPSBwYXJzZUludChtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImxpa2VzIilbMF0uaW5uZXJUZXh0KSArIDE7CiAgICAgICAgICAgICAgTGlrZVBvc3QocG9zdFsiaWQiXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBjaGVja19zY3JvbGwoKTsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7CiAgICAgIGNoZWNrX3Njcm9sbCgpOwogICAgfSk7CiAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImNvbW1lbnQtYnV0dG9uIilbMF0ub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9wb3N0LyIgKyBwb3N0WyJpZCJdKTsKICAgIH07CiAgfQogIG1vZHVsZS5vbl9yZW5kZXIob25fcmVuZGVyKTsKICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBvc3RbImlkIl0pOwogIGlmIChlbGVtZW50ID09IG51bGwpIHsKICAgIG1vZHVsZS5yZW5kZXIoKTsKICB9IGVsc2UgewogICAgcmV0dXJuICIiOwogIH0KfQpmdW5jdGlvbiBMaXZlUG9zdChyb3V0ZXIsIHBvc3QsIHBhcmVudCkgewogIHZhciBfcmVxdWlyZTMgPSByZXF1aXJlKCIuLi9saWIvRnJhbWV3b3JrLm1qcyIpLAogICAgTW9kdWxlID0gX3JlcXVpcmUzLk1vZHVsZTsKICB2YXIgbW9kdWxlID0gbmV3IE1vZHVsZSgiUG9zdCIpOwogIHZhciBibGFua19sb2dvID0gbW9kdWxlLmltYWdlKCJsb2dvX2JsYW5rLnN2ZyIpOwogIGZ1bmN0aW9uIHRpbWVDb252ZXJ0ZXIoVU5JWF90aW1lc3RhbXApIHsKICAgIHZhciBhID0gbmV3IERhdGUoVU5JWF90aW1lc3RhbXAgKiAxMDAwKTsKICAgIHZhciBtb250aHMgPSBbJ0phbicsICdGZWInLCAnTWFyJywgJ0FwcicsICdNYXknLCAnSnVuJywgJ0p1bCcsICdBdWcnLCAnU2VwJywgJ09jdCcsICdOb3YnLCAnRGVjJ107CiAgICB2YXIgeWVhciA9IGEuZ2V0RnVsbFllYXIoKTsKICAgIHZhciBtb250aCA9IG1vbnRoc1thLmdldE1vbnRoKCldOwogICAgdmFyIGRhdGUgPSBhLmdldERhdGUoKTsKICAgIHZhciBob3VyID0gKCcwJyArIGEuZ2V0SG91cnMoKSkuc2xpY2UoLTIpOyAvLyBQYWQgc2luZ2xlLWRpZ2l0IGhvdXJzIHdpdGggbGVhZGluZyB6ZXJvCiAgICB2YXIgbWluID0gKCcwJyArIGEuZ2V0TWludXRlcygpKS5zbGljZSgtMik7IC8vIFBhZCBzaW5nbGUtZGlnaXQgbWludXRlcyB3aXRoIGxlYWRpbmcgemVybwogICAgdmFyIHNlYyA9ICgnMCcgKyBhLmdldFNlY29uZHMoKSkuc2xpY2UoLTIpOyAvLyBQYWQgc2luZ2xlLWRpZ2l0IHNlY29uZHMgd2l0aCBsZWFkaW5nIHplcm8KICAgIHZhciB0aW1lID0gZGF0ZSArICcgJyArIG1vbnRoICsgJyAnICsgeWVhciArICcgJyArIGhvdXIgKyAnOicgKyBtaW4gKyAnOicgKyBzZWM7CiAgICByZXR1cm4gdGltZTsKICB9CiAgbW9kdWxlLmh0bWwoIlxuICAgIDxkaXYgaWQ9XCJwb3N0XCI+XG4gICAgICAgIDxkaXYgaWQ9XCJ0b3AtY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8aW1nIGlkPVwicG9zdC1pbWdcIiBjbGFzcz1cInByb2ZpbGUtcGljdHVyZVwiIGNsYXNzPVwidGV4dFwiPjwvaW1nPlxuICAgICAgICAgICAgPGRpdiBpZD1cInBvc3QtdXNlclwiIGNsYXNzPVwidGV4dCB1c2VybmFtZVwiPkxvYWRpbmcuLi48L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwb3N0LWJhZGdlcy1jb250YWluZXJcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgaWQ9XCJwb3N0LWRhdGFcIiBjbGFzcz1cInRleHQgZGF0YVwiPkxvYWRpbmcuLi48L2Rpdj5cbiAgICAgICAgPGRpdiBpZD1cInBvc3QtbWV0YVwiIGNsYXNzPVwidGV4dCB0aW1lc3RhbXBcIiA+QmxvY2tDb2luIEJyb3dzZXIgQXBwIC0gTG9hZGluZy4uLjwvZGl2PlxuXG4gICAgPC9kaXY+XG4gICAgIik7CiAgbW9kdWxlLmNzcygiXG4gICAgLmxpa2UtYnV0dG9uIHtcbiAgICAgICAgdHJhbnNpdGlvbi1kdXJhdGlvbjogMC41cztcbiAgICAgICAgY3Vyc29yOnBvaW50ZXI7XG4gICAgfVxuICAgIC5saWtlLWJ1dHRvbjpob3ZlciB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjZweDtcbiAgICB9XG4gICAgLmxpa2VkIHtcbiAgICAgICAgY29sb3I6I0ZGMDAwMDtcbiAgICAgICAgZm9udC12YXJpYXRpb24tc2V0dGluZ3M6XG4gICAgICAgICdGSUxMJyAxLFxuICAgICAgICAnd2dodCcgNDAwLFxuICAgICAgICAnR1JBRCcgMCxcbiAgICAgICAgJ29wc3onIDI0XG4gICAgfVxuICAgICNwb3N0IHtcbiAgICAgICAgd2lkdGg6MTAwJTtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB0b3A6MDtcbiAgICAgICAgbGVmdDowO1xuICAgICAgICBib3JkZXI6IHNvbGlkIHdoaXRlIDFweDtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMTZweFxuICAgIH1cbiAgICAucG9zdC1iYWRnZSB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjVweDtcbiAgICAgICAgY29sb3I6ICNGRkZGRkY7XG4gIFxuICAgICAgfVxuICAgICAgI3Bvc3QtYmFkZ2VzLWNvbnRhaW5lciB7XG4gICAgICAgIHdpZHRoOjIwJTtcbiAgICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjpyb3c7XG4gICAgICAgIGp1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O1xuICAgICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgICAgIG1hcmdpbjoxMHB4O1xuICAgICAgfVxuICAgIC50ZXh0IHtcbiAgICAgICAgZm9udC1mYW1pbHk6ICdQb3BwaW5zJywgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgICAgICAgZm9udC1zaXplOiAyNXB4O1xuICAgICAgICBjb2xvcjp3aGl0ZTtcbiAgICB9XG5cbiAgICAjcG9zdC1pbWcge1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgICAgYm9yZGVyLXJhZGl1czoyNTZweDtcbiAgICAgICAgd2lkdGg6IDQ4cHg7XG4gICAgICAgIGhlaWdodDogNDhweDtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgIH1cblxuICAgICNwb3N0LXVzZXIge1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgICAgICBtYXJnaW4tbGVmdDowO1xuICAgIH1cblxuICAgICN0b3AtY29udGFpbmVyIHtcbiAgICAgICAgcG9zaXRpb246cmVsYXRpdmU7XG4gICAgICAgIHRvcDowO1xuICAgICAgICBsZWZ0OjA7XG4gICAgICAgIHdpZHRoOjEwMCU7XG4gICAgICAgIGhlaWdodDpmaXQtY29udGVudDtcbiAgICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHN0YXJ0O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIFxuICAgIH1cblxuICAgICNwb3N0LW1ldGEge1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAzMDA7XG4gICAgICAgIGZvbnQtc2l6ZTogMTdweDtcbiAgICB9XG4gICAgI3Bvc3Qtc3RhdHMge1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIGJvdHRvbTowO1xuICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcbiAgICAgICAgcmlnaHQ6MDtcbiAgICAgICAgdGV4dC1hbGlnbjpyaWdodDtcbiAgICAgICAgZm9udC13ZWlnaHQ6IDMwMDtcbiAgICAgICAgZm9udC1zaXplOiAxN3B4O1xuICAgIH1cbiAgICAjcG9zdC1kYXRhIHtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgIH1cbiAgICAiKTsKICBtb2R1bGUucGFyZW50KHBhcmVudCk7CiAgZnVuY3Rpb24gb25fcmVuZGVyKCkgewogICAgdmFyIGxpa2VkID0gZmFsc2U7CiAgICBtb2R1bGUuZGl2LmlkID0gcG9zdFsiaWQiXTsKICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidXNlcm5hbWUiKVswXS5pbm5lclRleHQgPSBwb3N0WyJ1c2VyIl07CiAgICB2YXIgdGV4dCA9IHBvc3RbImRhdGEiXTsKICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoLz4vZywgJycpOwogICAgdGV4dCA9IHRleHQucmVwbGFjZSgvPC9nLCAnJyk7CiAgICB2YXIgaHRtbENvbnRlbnQgPSBtYXJrZWQucGFyc2UodGV4dCk7CiAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImRhdGEiKVswXS5pbm5lckhUTUwgPSBodG1sQ29udGVudDsKICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidGltZXN0YW1wIilbMF0uaW5uZXJUZXh0ID0gIkJsb2NrQ29pbiBCcm93c2VyIExpdmUgLSAiLmNvbmNhdCh0aW1lQ29udmVydGVyKHBvc3RbImRhdGUiXSkpOwogICAgbW9kdWxlLmRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJwcm9maWxlLXBpY3R1cmUiKVswXS5zcmMgPSBwb3N0WyJwcm9maWxlLXBpY3R1cmUiXTsKICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgicHJvZmlsZS1waWN0dXJlIilbMF0ub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9wcm9maWxlLyIgKyBwb3N0WyJ1c2VyLWlkIl0pOwogICAgfTsKICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidXNlcm5hbWUiKVswXS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICByb3V0ZXIubmF2aWdhdGVUbygiL3Byb2ZpbGUvIiArIHBvc3RbInVzZXItaWQiXSk7CiAgICB9OwogICAgdmFyIGNvbnRhaW5lciA9IG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgicG9zdC1iYWRnZXMtY29udGFpbmVyIilbMF07CiAgICB2YXIgYmFkZ2VzID0gWyJhd2FyZF9zdGFyIiwgInZlcmlmaWVkIiwgInNoaWVsZF9wZXJzb24iLCAic21hcnRfdG95IiwgImxvY2FsX2ZpcmVfZGVwYXJ0bWVudCIsICJzY2llbmNlIl07CiAgICB2YXIgdGl0bGVzID0gWyJCbG9ja0NvaW4gQWRtaW4iLCAiVmVyaWZpZWQgQWNjb3VudCIsICJCbG9ja0NvaW4gU3RhZmYiLCAiQm90IEFjY291bnQiLCAiQmxvY2tDb2luIFByZW1pdW0iLCAiQmV0YSBUZXN0ZXIiXTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zdFsiYmFkZ2VzIl0ubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7CiAgICAgIHNwYW4uY2xhc3NOYW1lID0gIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWQgcG9zdC1iYWRnZSI7CiAgICAgIHNwYW4uaW5uZXJIVE1MID0gYmFkZ2VzW3Bvc3RbImJhZGdlcyJdW2ldXTsKICAgICAgc3Bhbi50aXRsZSA9IHRpdGxlc1twb3N0WyJiYWRnZXMiXVtpXV07CiAgICAgIC8vIEFwcGVuZCB0aGUgc3BhbiBlbGVtZW50IHRvIHRoZSBjb250YWluZXIgZGl2CiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzcGFuKTsKICAgIH0KICB9CiAgbW9kdWxlLm9uX3JlbmRlcihvbl9yZW5kZXIpOwogIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocG9zdFsiaWQiXSk7CiAgaWYgKGVsZW1lbnQgPT0gbnVsbCkgewogICAgbW9kdWxlLnJlbmRlcih0cnVlKTsKICB9IGVsc2UgewogICAgcmV0dXJuICIiOwogIH0KfQpmdW5jdGlvbiBQcmV2aWV3UG9zdChyb3V0ZXIsIHBvc3QsIHBhcmVudCkgewogIHZhciBfcmVxdWlyZTQgPSByZXF1aXJlKCIuLi9saWIvRnJhbWV3b3JrLm1qcyIpLAogICAgTW9kdWxlID0gX3JlcXVpcmU0Lk1vZHVsZTsKICB2YXIgX3JlcXVpcmU1ID0gcmVxdWlyZSgiLi4vc2NyaXB0cy9hcGkubWpzIiksCiAgICBWaWV3UG9zdCA9IF9yZXF1aXJlNS5WaWV3UG9zdCwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlNS5Jc0xvZ2VkSW4sCiAgICBQb3N0TGlrZWQgPSBfcmVxdWlyZTUuUG9zdExpa2VkLAogICAgTGlrZVBvc3QgPSBfcmVxdWlyZTUuTGlrZVBvc3Q7CiAgdmFyIG1vZHVsZSA9IG5ldyBNb2R1bGUoIlBvc3QiKTsKICB2YXIgYmxhbmtfbG9nbyA9IG1vZHVsZS5pbWFnZSgibG9nb19ibGFuay5zdmciKTsKICBmdW5jdGlvbiB0aW1lQ29udmVydGVyKFVOSVhfdGltZXN0YW1wKSB7CiAgICB2YXIgYSA9IG5ldyBEYXRlKFVOSVhfdGltZXN0YW1wICogMTAwMCk7CiAgICB2YXIgbW9udGhzID0gWydKYW4nLCAnRmViJywgJ01hcicsICdBcHInLCAnTWF5JywgJ0p1bicsICdKdWwnLCAnQXVnJywgJ1NlcCcsICdPY3QnLCAnTm92JywgJ0RlYyddOwogICAgdmFyIHllYXIgPSBhLmdldEZ1bGxZZWFyKCk7CiAgICB2YXIgbW9udGggPSBtb250aHNbYS5nZXRNb250aCgpXTsKICAgIHZhciBkYXRlID0gYS5nZXREYXRlKCk7CiAgICB2YXIgaG91ciA9ICgnMCcgKyBhLmdldEhvdXJzKCkpLnNsaWNlKC0yKTsgLy8gUGFkIHNpbmdsZS1kaWdpdCBob3VycyB3aXRoIGxlYWRpbmcgemVybwogICAgdmFyIG1pbiA9ICgnMCcgKyBhLmdldE1pbnV0ZXMoKSkuc2xpY2UoLTIpOyAvLyBQYWQgc2luZ2xlLWRpZ2l0IG1pbnV0ZXMgd2l0aCBsZWFkaW5nIHplcm8KICAgIHZhciBzZWMgPSAoJzAnICsgYS5nZXRTZWNvbmRzKCkpLnNsaWNlKC0yKTsgLy8gUGFkIHNpbmdsZS1kaWdpdCBzZWNvbmRzIHdpdGggbGVhZGluZyB6ZXJvCiAgICB2YXIgdGltZSA9IGRhdGUgKyAnICcgKyBtb250aCArICcgJyArIHllYXIgKyAnICcgKyBob3VyICsgJzonICsgbWluICsgJzonICsgc2VjOwogICAgcmV0dXJuIHRpbWU7CiAgfQogIG1vZHVsZS5odG1sKCJcbiAgICA8ZGl2IGlkPVwicG9zdFwiPlxuICAgICAgICA8ZGl2IGlkPVwidG9wLWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGltZyBpZD1cInBvc3QtaW1nXCIgY2xhc3M9XCJwcm9maWxlLXBpY3R1cmVcIiBjbGFzcz1cInRleHRcIj48L2ltZz5cbiAgICAgICAgICAgIDxkaXYgaWQ9XCJwb3N0LXVzZXJcIiBjbGFzcz1cInRleHQgdXNlcm5hbWVcIj5Mb2FkaW5nLi4uPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGlkPVwicG9zdC1kYXRhXCIgY2xhc3M9XCJ0ZXh0IGRhdGFcIj5Mb2FkaW5nLi4uPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgIik7CiAgbW9kdWxlLmNzcygiXG4gICAgLmEtYmxvY2tjb2luIHtcbiAgICAgICAgd2lkdGg6MjRweDtcbiAgICAgICAgaGVpZ2h0OjI0cHg7XG4gICAgfVxuICAgIC5saWtlLWJ1dHRvbiB7XG4gICAgICAgIHRyYW5zaXRpb24tZHVyYXRpb246IDAuNXM7XG4gICAgICAgIGN1cnNvcjpwb2ludGVyO1xuICAgIH1cbiAgICAubGlrZS1idXR0b246aG92ZXIge1xuICAgICAgICBmb250LXNpemU6IDI2cHg7XG4gICAgfVxuICAgIC5hLWJsb2NrY29pbjpob3ZlciB7XG4gICAgICAgIHRyYW5zaXRpb24tZHVyYXRpb246IDAuNXM7XG4gICAgICAgIGN1cnNvcjpwb2ludGVyO1xuICAgICAgICB3aWR0aDoyNnB4O1xuICAgICAgICBoZWlnaHQ6MjZweDtcbiAgICB9XG4gICAgLmxpa2VkIHtcbiAgICAgICAgY29sb3I6I0ZGMDAwMDtcbiAgICAgICAgZm9udC12YXJpYXRpb24tc2V0dGluZ3M6XG4gICAgICAgICdGSUxMJyAxLFxuICAgICAgICAnd2dodCcgNDAwLFxuICAgICAgICAnR1JBRCcgMCxcbiAgICAgICAgJ29wc3onIDI0XG4gICAgfVxuICAgICNwb3N0IHtcbiAgICAgICAgd2lkdGg6MTAwJTtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB0b3A6MDtcbiAgICAgICAgbGVmdDowO1xuICAgICAgICBib3JkZXI6IHNvbGlkIHdoaXRlIDFweDtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMTZweFxuICAgIH1cbiAgICAucG9zdC1iYWRnZSB7XG4gICAgICAgIGZvbnQtc2l6ZTogMjVweDtcbiAgICAgICAgY29sb3I6ICNGRkZGRkY7XG4gIFxuICAgICAgfVxuICAgICAgI3Bvc3QtYmFkZ2VzLWNvbnRhaW5lciB7XG4gICAgICAgIHdpZHRoOjIwJTtcbiAgICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjpyb3c7XG4gICAgICAgIGp1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O1xuICAgICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgICAgIG1hcmdpbjoxMHB4O1xuICAgICAgfVxuICAgIC50ZXh0IHtcbiAgICAgICAgZm9udC1mYW1pbHk6ICdQb3BwaW5zJywgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgICAgICAgZm9udC1zaXplOiAyNXB4O1xuICAgICAgICBjb2xvcjp3aGl0ZTtcbiAgICB9XG5cbiAgICAjcG9zdC1pbWcge1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgICAgYm9yZGVyLXJhZGl1czoyNTZweDtcbiAgICAgICAgd2lkdGg6IDQ4cHg7XG4gICAgICAgIGhlaWdodDogNDhweDtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgIH1cblxuICAgICNwb3N0LXVzZXIge1xuICAgICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgICAgICBtYXJnaW4tbGVmdDowO1xuICAgIH1cblxuICAgICN0b3AtY29udGFpbmVyIHtcbiAgICAgICAgcG9zaXRpb246cmVsYXRpdmU7XG4gICAgICAgIHRvcDowO1xuICAgICAgICBsZWZ0OjA7XG4gICAgICAgIHdpZHRoOjEwMCU7XG4gICAgICAgIGhlaWdodDpmaXQtY29udGVudDtcbiAgICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHN0YXJ0O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIFxuICAgIH1cblxuICAgICNwb3N0LW1ldGEge1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAzMDA7XG4gICAgICAgIGZvbnQtc2l6ZTogMTdweDtcbiAgICB9XG4gICAgI3Bvc3Qtc3RhdHMge1xuICAgICAgICBtYXJnaW46IDEwcHg7XG4gICAgICAgIGJvdHRvbTowO1xuICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcbiAgICAgICAgcmlnaHQ6MDtcbiAgICAgICAgdGV4dC1hbGlnbjpyaWdodDtcbiAgICAgICAgZm9udC13ZWlnaHQ6IDMwMDtcbiAgICAgICAgZm9udC1zaXplOiAxN3B4O1xuICAgIH1cbiAgICAjcG9zdC1kYXRhIHtcbiAgICAgICAgbWFyZ2luOiAxMHB4O1xuICAgIH1cbiAgICAiKTsKICBtb2R1bGUucGFyZW50KHBhcmVudCk7CiAgZnVuY3Rpb24gb25fcmVuZGVyKCkgewogICAgdmFyIGxpa2VkID0gZmFsc2U7CiAgICBtb2R1bGUuZGl2LmlkID0gcG9zdFsiaWQiXTsKICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidXNlcm5hbWUiKVswXS5pbm5lclRleHQgPSBwb3N0WyJ1c2VyIl07CiAgICB2YXIgdGV4dCA9IHBvc3RbImRhdGEiXTsKICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoLz4vZywgJycpOwogICAgdGV4dCA9IHRleHQucmVwbGFjZSgvPC9nLCAnJyk7CiAgICB2YXIgaHRtbENvbnRlbnQgPSBtYXJrZWQucGFyc2UodGV4dCk7CiAgICBtb2R1bGUuZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImRhdGEiKVswXS5pbm5lckhUTUwgPSBodG1sQ29udGVudDsKICAgIG1vZHVsZS5kaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgicHJvZmlsZS1waWN0dXJlIilbMF0uc3JjID0gcG9zdFsicHJvZmlsZS1waWN0dXJlIl07CiAgfQogIG1vZHVsZS5vbl9yZW5kZXIob25fcmVuZGVyKTsKICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBvc3RbImlkIl0pOwogIGlmIChlbGVtZW50ID09IG51bGwpIHsKICAgIG1vZHVsZS5yZW5kZXIoKTsKICB9IGVsc2UgewogICAgcmV0dXJuICIiOwogIH0KfQoKfSx7Ii4uL2xpYi9GcmFtZXdvcmsubWpzIjoxMCwiLi4vc2NyaXB0cy9hcGkubWpzIjoyOX1dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlRoZW1lID0gZXhwb3J0cy5Sb3V0ZXIgPSBleHBvcnRzLlBhZ2UgPSBleHBvcnRzLk1vZHVsZSA9IGV4cG9ydHMuRGlzcGxheSA9IHZvaWQgMDsKZnVuY3Rpb24gX3R5cGVvZihvKSB7ICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7IHJldHVybiBfdHlwZW9mID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAobykgeyByZXR1cm4gdHlwZW9mIG87IH0gOiBmdW5jdGlvbiAobykgeyByZXR1cm4gbyAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgby5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG8gIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvOyB9LCBfdHlwZW9mKG8pOyB9CmZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG8sIGFsbG93QXJyYXlMaWtlKSB7IHZhciBpdCA9IHR5cGVvZiBTeW1ib2wgIT09ICJ1bmRlZmluZWQiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSB8fCBvWyJAQGl0ZXJhdG9yIl07IGlmICghaXQpIHsgaWYgKEFycmF5LmlzQXJyYXkobykgfHwgKGl0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8pKSB8fCBhbGxvd0FycmF5TGlrZSAmJiBvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHsgaWYgKGl0KSBvID0gaXQ7IHZhciBpID0gMDsgdmFyIEYgPSBmdW5jdGlvbiBGKCkge307IHJldHVybiB7IHM6IEYsIG46IGZ1bmN0aW9uIG4oKSB7IGlmIChpID49IG8ubGVuZ3RoKSByZXR1cm4geyBkb25lOiB0cnVlIH07IHJldHVybiB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogb1tpKytdIH07IH0sIGU6IGZ1bmN0aW9uIGUoX2UpIHsgdGhyb3cgX2U7IH0sIGY6IEYgfTsgfSB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0gdmFyIG5vcm1hbENvbXBsZXRpb24gPSB0cnVlLCBkaWRFcnIgPSBmYWxzZSwgZXJyOyByZXR1cm4geyBzOiBmdW5jdGlvbiBzKCkgeyBpdCA9IGl0LmNhbGwobyk7IH0sIG46IGZ1bmN0aW9uIG4oKSB7IHZhciBzdGVwID0gaXQubmV4dCgpOyBub3JtYWxDb21wbGV0aW9uID0gc3RlcC5kb25lOyByZXR1cm4gc3RlcDsgfSwgZTogZnVuY3Rpb24gZShfZTIpIHsgZGlkRXJyID0gdHJ1ZTsgZXJyID0gX2UyOyB9LCBmOiBmdW5jdGlvbiBmKCkgeyB0cnkgeyBpZiAoIW5vcm1hbENvbXBsZXRpb24gJiYgaXRbInJldHVybiJdICE9IG51bGwpIGl0WyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoZGlkRXJyKSB0aHJvdyBlcnI7IH0gfSB9OyB9CmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIGFycjJbaV0gPSBhcnJbaV07IHJldHVybiBhcnIyOyB9CmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBfdG9Qcm9wZXJ0eUtleShkZXNjcmlwdG9yLmtleSksIGRlc2NyaXB0b3IpOyB9IH0KZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29uc3RydWN0b3IsICJwcm90b3R5cGUiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KHQpIHsgdmFyIGkgPSBfdG9QcmltaXRpdmUodCwgInN0cmluZyIpOyByZXR1cm4gInN5bWJvbCIgPT0gX3R5cGVvZihpKSA/IGkgOiBTdHJpbmcoaSk7IH0KZnVuY3Rpb24gX3RvUHJpbWl0aXZlKHQsIHIpIHsgaWYgKCJvYmplY3QiICE9IF90eXBlb2YodCkgfHwgIXQpIHJldHVybiB0OyB2YXIgZSA9IHRbU3ltYm9sLnRvUHJpbWl0aXZlXTsgaWYgKHZvaWQgMCAhPT0gZSkgeyB2YXIgaSA9IGUuY2FsbCh0LCByIHx8ICJkZWZhdWx0Iik7IGlmICgib2JqZWN0IiAhPSBfdHlwZW9mKGkpKSByZXR1cm4gaTsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS4iKTsgfSByZXR1cm4gKCJzdHJpbmciID09PSByID8gU3RyaW5nIDogTnVtYmVyKSh0KTsgfQp2YXIgcGFnZXMgPSB7fTsKdmFyIHRoZW1lcyA9IHt9Owp2YXIgY3VycmVudF90aGVtZTsKdmFyIENhbk5hdmlnYXRlID0gdHJ1ZTsKZnVuY3Rpb24gU3dpdGNoQ2FuTmF2aWdhdGUobmV3ZGF0YSkgewogIENhbk5hdmlnYXRlID0gbmV3ZGF0YTsKfQp2YXIgVGhlbWUgPSBleHBvcnRzLlRoZW1lID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBUaGVtZShuYW1lKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGhlbWUpOwogICAgdGhpcy5uYW1lID0gbmFtZTsKICAgIHRoaXMudHlwZSA9ICJqc29uIjsKICAgIHRoaXMuZGF0YSA9IHt9OwogIH0KICBfY3JlYXRlQ2xhc3MoVGhlbWUsIFt7CiAgICBrZXk6ICJwcm9wZXJ0aWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByb3BlcnRpZShuYW1lLCB2YWx1ZSkgewogICAgICB0aGlzLmRhdGFbbmFtZV0gPSB2YWx1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldChuYW1lKSB7CiAgICAgIGlmICh0aGlzLnR5cGUgPT0gImpzb24iIHx8IHRoaXMudHlwZSA9PSB1bmRlZmluZWQpIHsKICAgICAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YVtuYW1lXTsKICAgICAgICByZXR1cm4gZGF0YTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInBhcnNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZShqc29uKSB7CiAgICAgIHZhciBtZXRhID0ganNvbi5tZXRhOwogICAgICB0aGlzLnR5cGUgPSBtZXRhLnR5cGU7CiAgICAgIGlmICh0aGlzLnR5cGUgPT0gImpzb24iIHx8IHRoaXMudHlwZSA9PSB1bmRlZmluZWQpIHsKICAgICAgICBmb3IgKHZhciBrZXkgaW4ganNvbi5kYXRhKSB7CiAgICAgICAgICB2YXIgY2hpbGRLZXkgPSBrZXk7CiAgICAgICAgICB2YXIgY2hpbGRWYWx1ZSA9IGpzb24uZGF0YVtrZXldOwogICAgICAgICAgdGhpcy5wcm9wZXJ0aWUoY2hpbGRLZXksIGNoaWxkVmFsdWUpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgY3NzU3RyaW5nID0gJyc7CiAgICAgICAgY29uc29sZS5sb2coImNzcyIpOwogICAgICAgIGZvciAodmFyIF9rZXkgaW4ganNvbi5kYXRhKSB7CiAgICAgICAgICBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoanNvbi5kYXRhLCBfa2V5KSkgewogICAgICAgICAgICB2YXIgZWxlbWVudCA9IGpzb24uZGF0YVtfa2V5XTsKICAgICAgICAgICAgdmFyIGVsZW1lbnRUeXBlID0gIi4iOwogICAgICAgICAgICBpZiAoZWxlbWVudFsidHlwZSJdID09ICJ0YWciKSB7CiAgICAgICAgICAgICAgZWxlbWVudFR5cGUgPSAiIjsKICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50WyJ0eXBlIl0gPT0gImNsYXNzIikgewogICAgICAgICAgICAgIGVsZW1lbnRUeXBlID0gIi4iOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGVsZW1lbnRUeXBlID0gIiMiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNzc1N0cmluZyArPSAiIi5jb25jYXQoZWxlbWVudFR5cGUpLmNvbmNhdChfa2V5LCAiIHsiKTsKICAgICAgICAgICAgZGVsZXRlIGVsZW1lbnRbJ3R5cGUnXTsKICAgICAgICAgICAgZm9yICh2YXIgc3R5bGVLZXkgaW4gZWxlbWVudCkgewogICAgICAgICAgICAgIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlbGVtZW50LCBzdHlsZUtleSkpIHsKICAgICAgICAgICAgICAgIGNzc1N0cmluZyArPSAiIi5jb25jYXQoc3R5bGVLZXksICI6ICIpLmNvbmNhdChlbGVtZW50W3N0eWxlS2V5XSwgIiAhaW1wb3J0YW50OyIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjc3NTdHJpbmcgKz0gIn1cbiI7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZhciBzdHlsZVRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7CiAgICAgICAgc3R5bGVUYWcudGV4dENvbnRlbnQgPSBjc3NTdHJpbmc7CiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZVRhZyk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWdpc3RlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXIoKSB7CiAgICAgIHRoZW1lc1t0aGlzLm5hbWVdID0gdGhpczsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFRoZW1lOwp9KCk7CnZhciBEaXNwbGF5ID0gZXhwb3J0cy5EaXNwbGF5ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBEaXNwbGF5KCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERpc3BsYXkpOwogIH0KICBfY3JlYXRlQ2xhc3MoRGlzcGxheSwgW3sKICAgIGtleTogInNldF90aGVtZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0X3RoZW1lKG5hbWUpIHsKICAgICAgY3VycmVudF90aGVtZSA9IG5hbWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXQobmFtZSkgewogICAgICB2YXIgdGhlbWVfZGF0YSA9IHRoZW1lc1tjdXJyZW50X3RoZW1lXS5nZXQobmFtZSk7CiAgICAgIGlmICh0aGVtZV9kYXRhID09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnNvbGUubG9nKCJEZWZhdWx0IiwgbmFtZSwgdGhlbWVzWyJkZWZhdWx0Il0uZ2V0KG5hbWUpKTsKICAgICAgICByZXR1cm4gdGhlbWVzWyJkZWZhdWx0Il0uZ2V0KG5hbWUpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCJUaGVtZSIsIG5hbWUsIHRoZW1lX2RhdGEpOwogICAgICAgIHJldHVybiB0aGVtZV9kYXRhOwogICAgICB9CiAgICB9CiAgfV0pOwogIHJldHVybiBEaXNwbGF5Owp9KCk7CnZhciBQYWdlID0gZXhwb3J0cy5QYWdlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBQYWdlKHJvdXRlKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGFnZSk7CiAgICB0aGlzLnJvdXRlID0gcm91dGU7CiAgICB0aGlzLmRvY3VtZW50OwogICAgdGhpcy5vbl9kZWxldGVfZnVuYzsKICAgIHBhZ2VzW3RoaXMucm91dGUudG9Mb3dlckNhc2UoKV0gPSB0aGlzOwogIH0KICBfY3JlYXRlQ2xhc3MoUGFnZSwgW3sKICAgIGtleTogImh0bWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGh0bWwoY29kZSkgewogICAgICB0aGlzLmh0bWwgPSBjb2RlOwogICAgfQogIH0sIHsKICAgIGtleTogImNzcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3NzKGNvZGUpIHsKICAgICAgdGhpcy5jc3MgPSBjb2RlOwogICAgfQogIH0sIHsKICAgIGtleTogImRlbGV0ZV9hbmltYXRpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZV9hbmltYXRpb24oY29kZSkgewogICAgICB0aGlzLmRlbGV0ZV9hbmltID0gY29kZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzcGF3bl9hbmltYXRpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNwYXduX2FuaW1hdGlvbihjb2RlKSB7CiAgICAgIHRoaXMuY3JlYXRlX2FuaW0gPSBjb2RlOwogICAgfQogIH0sIHsKICAgIGtleTogImltYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbWFnZShwYXRoKSB7CiAgICAgIHJldHVybiAiaHR0cHM6Ly9ibG9ja2NvaW4uc29jaWFsL2Fzc2V0cy8iICsgcGF0aDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzcGF3biIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Bhd24oKSB7CiAgICAgIGlmICh0aGlzLmNyZWF0ZV9hbmltICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB2YXIgbmV3U3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwogICAgICAgIG5ld1N0eWxlLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlX2FuaW07CiAgICAgICAgdGhpcy5kb2N1bWVudC5hcHBlbmRDaGlsZChuZXdTdHlsZSk7CiAgICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuZG9jdW1lbnQuY2hpbGRyZW4pLAogICAgICAgICAgX3N0ZXA7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgIHZhciBjaGlsZCA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgICBpZiAoY2hpbGQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09ICdkaXYnKSB7CiAgICAgICAgICAgICAgY2hpbGQuc3R5bGUuYW5pbWF0aW9uID0gJ3NwYXduIDFzJzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbl9kZWxldGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uX2RlbGV0ZShmdW5jKSB7CiAgICAgIHRoaXMub25fZGVsZXRlX2Z1bmMgPSBmdW5jOwogICAgfQogIH0sIHsKICAgIGtleTogImRlbGV0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdHJ5IHsKICAgICAgICBpZiAodHlwZW9mIHRoaXMub25fZGVsZXRlX2Z1bmMgPT0gImZ1bmN0aW9uIikgewogICAgICAgICAgdGhpcy5vbl9kZWxldGVfZnVuYygpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciIsIGUuc3RhY2spOwogICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciIsIGUubmFtZSk7CiAgICAgICAgY29uc29sZS5sb2coIkVycm9yIiwgZS5tZXNzYWdlKTsKICAgICAgfQogICAgICBwYWdlc1t0aGlzLnJvdXRlLnRvTG93ZXJDYXNlKCldID0gdW5kZWZpbmVkOwogICAgfQogIH0sIHsKICAgIGtleTogImNsZWFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhcihleGNlcHQpIHsKICAgICAgdmFyIGVsZW1zID0gZG9jdW1lbnQuYm9keS5jaGlsZHJlbjsKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGV4Y2VwdCkpIHsKICAgICAgICBleGNlcHQgPSBbXTsKICAgICAgfQogICAgICBleGNlcHQucHVzaCgibm9zY3JpcHQiKTsKICAgICAgZXhjZXB0LnB1c2goInNjcmlwdCIpOwogICAgICBleGNlcHQucHVzaCgiZGl2Iik7CiAgICAgIGV4Y2VwdC5wdXNoKCJzdHlsZSIpOwogICAgICBleGNlcHQucHVzaCgibm90aWZpY2F0aW9uIik7CiAgICAgIHZhciBpbmRleCA9IGV4Y2VwdC5pbmRleE9mKCJuYXZiYXIiKTsKICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICBleGNlcHQuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfQogICAgICB2YXIgYm9keUNoaWxkcmVuID0gZG9jdW1lbnQuYm9keS5jaGlsZHJlbjsKICAgICAgZm9yICh2YXIgaSA9IGJvZHlDaGlsZHJlbi5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIHZhciBjaGlsZCA9IGJvZHlDaGlsZHJlbltpXTsKICAgICAgICBpZiAoZXhjZXB0LmluZGV4T2YoY2hpbGQudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSA9PT0gLTEpIHsKICAgICAgICAgIGlmIChwYWdlc1tjaGlsZC50YWdOYW1lLnRvTG93ZXJDYXNlKCldICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHBhZ2VzW2NoaWxkLnRhZ05hbWUudG9Mb3dlckNhc2UoKV1bImRlbGV0ZSJdKCk7CiAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChjaGlsZCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKF91bnVzZWQpIHsKICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGNoaWxkKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChjaGlsZCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAib25fcmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbl9yZW5kZXIoZnVuYykgewogICAgICB0aGlzLm9uID0gZnVuYzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKHRoaXMucm91dGUudG9Mb3dlckNhc2UoKSkubGVuZ3RoID09IDApIHsKICAgICAgICB2YXIgbmV3RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0aGlzLnJvdXRlLnRvTG93ZXJDYXNlKCkpOwogICAgICAgIG5ld0Rpdi5pbm5lckhUTUwgPSB0aGlzLmh0bWw7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChuZXdEaXYpOwogICAgICAgIHZhciBuZXdTdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7CiAgICAgICAgbmV3U3R5bGUuaW5uZXJIVE1MID0gdGhpcy5jc3M7CiAgICAgICAgbmV3RGl2LmFwcGVuZENoaWxkKG5ld1N0eWxlKTsKICAgICAgICB0aGlzLmRvY3VtZW50ID0gbmV3RGl2OwogICAgICAgIHRoaXMuc3Bhd24oKTsKICAgICAgICBwYWdlc1t0aGlzLnJvdXRlLnRvTG93ZXJDYXNlKCldID0gdGhpczsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9uID09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgdGhpcy5vbigpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciIsIGUuc3RhY2spOwogICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIiwgZS5uYW1lKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciIsIGUubWVzc2FnZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfV0pOwogIHJldHVybiBQYWdlOwp9KCk7CnZhciBSb3V0ZXIgPSBleHBvcnRzLlJvdXRlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUm91dGVyKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJvdXRlcik7CiAgICB0aGlzLnJvdXRlcyA9IHt9OwogICAgdGhpcy5lcnJvcnMgPSB7fTsKICB9CiAgX2NyZWF0ZUNsYXNzKFJvdXRlciwgW3sKICAgIGtleTogInJlZ2lzdGVyUm91dGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyUm91dGUoZW5kcG9pbnQsIGZpbGVQYXRoKSB7CiAgICAgIHRoaXMucm91dGVzW2VuZHBvaW50XSA9IGZpbGVQYXRoOwogICAgfQogIH0sIHsKICAgIGtleTogInJlZ2lzdGVyRXJyb3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyRXJyb3IoZXJyb3IsIGZpbGVQYXRoKSB7CiAgICAgIHRoaXMuZXJyb3JzW2Vycm9yXSA9IGZpbGVQYXRoOwogICAgfQogIH0sIHsKICAgIGtleTogIm5hdmlnYXRlRXJyb3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5hdmlnYXRlRXJyb3IoY29kZSkgewogICAgICBpZiAoQ2FuTmF2aWdhdGUgPT0gZmFsc2UpIHsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgICAgdmFyIGZ1bmN0aW9ucGFnZSA9IHRoaXMuZXJyb3JzW2NvZGVdOwogICAgICBoaXN0b3J5LnB1c2hTdGF0ZSh7fSwgbnVsbCwgIi8iICsgY29kZSk7CiAgICAgIGlmIChmdW5jdGlvbnBhZ2UpIHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKHR5cGVvZiBmdW5jdGlvbnBhZ2UgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgZnVuY3Rpb25wYWdlKHRoaXMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBmdW5jdGlvbnBhZ2UpIHsKICAgICAgICAgICAgICBmdW5jdGlvbnBhZ2VbaV0odGhpcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgbG9hZGluZyBtb2R1bGUgZm9yIGNvZGUgIi5jb25jYXQoY29kZSwgIjoiKSwgZXJyb3IpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKCJObyBoYW5kbGVyIHJlZ2lzdGVyZWQgZm9yIGVycm9yOiAiLmNvbmNhdChjb2RlKSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJuYXZpZ2F0ZVRvIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBuYXZpZ2F0ZVRvKGVuZHBvaW50LCBmaXJzdCkgewogICAgICBpZiAoQ2FuTmF2aWdhdGUgPT0gZmFsc2UpIHsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSA9PSBlbmRwb2ludCAmJiBmaXJzdCAhPSAxKSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICAgIHZhciByb3V0ZSA9IGVuZHBvaW50LnNwbGl0KCIvIilbMV07CiAgICAgIGhpc3RvcnkucHVzaFN0YXRlKHt9LCBudWxsLCBlbmRwb2ludCk7CiAgICAgIHZhciBmdW5jdGlvbnBhZ2UgPSB0aGlzLnJvdXRlc1tyb3V0ZV07CiAgICAgIGlmIChmdW5jdGlvbnBhZ2UpIHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKHR5cGVvZiBmdW5jdGlvbnBhZ2UgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgZnVuY3Rpb25wYWdlKHRoaXMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBmdW5jdGlvbnBhZ2UpIHsKICAgICAgICAgICAgICBmdW5jdGlvbnBhZ2VbaV0odGhpcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgbG9hZGluZyBtb2R1bGUgZm9yIGVuZHBvaW50ICIuY29uY2F0KGVuZHBvaW50LCAiOiIpLCBlcnJvcik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubmF2aWdhdGVFcnJvcig0MDQpOwogICAgICAgIGNvbnNvbGUuZXJyb3IoIk5vIGhhbmRsZXIgcmVnaXN0ZXJlZCBmb3IgZW5kcG9pbnQ6ICIuY29uY2F0KGVuZHBvaW50KSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdGFydCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnQoKSB7CiAgICAgIHZhciBjdXJyZW50RW5kcG9pbnQgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7CiAgICAgIHRoaXMubmF2aWdhdGVUbyhjdXJyZW50RW5kcG9pbnQsIDEpOwogICAgfQogIH1dKTsKICByZXR1cm4gUm91dGVyOwp9KCk7CnZhciBNb2R1bGUgPSBleHBvcnRzLk1vZHVsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTW9kdWxlKG5hbWUsIHBhcmVudCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1vZHVsZSk7CiAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgdGhpcy5wYXJlbnRfZGl2ID0gcGFyZW50OwogICAgdGhpcy5kaXY7CiAgfQogIF9jcmVhdGVDbGFzcyhNb2R1bGUsIFt7CiAgICBrZXk6ICJodG1sIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBodG1sKGNvZGUpIHsKICAgICAgdGhpcy5odG1sID0gY29kZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjc3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNzcyhjb2RlKSB7CiAgICAgIHRoaXMuY3NzID0gY29kZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwYXJlbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBhcmVudChodG1sKSB7CiAgICAgIHRoaXMucGFyZW50X2RpdiA9IGh0bWw7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVsZXRlX2FuaW1hdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVsZXRlX2FuaW1hdGlvbihjb2RlKSB7CiAgICAgIHRoaXMuZGVsZXRlX2FuaW0gPSBjb2RlOwogICAgfQogIH0sIHsKICAgIGtleTogInNwYXduX2FuaW1hdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Bhd25fYW5pbWF0aW9uKGNvZGUpIHsKICAgICAgdGhpcy5jcmVhdGVfYW5pbSA9IGNvZGU7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW1hZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGltYWdlKHBhdGgpIHsKICAgICAgcmV0dXJuICJodHRwczovL2Jsb2NrY29pbi5zb2NpYWwvYXNzZXRzLyIgKyBwYXRoOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uX3JlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25fcmVuZGVyKGZ1bmMpIHsKICAgICAgdGhpcy5vbiA9IGZ1bmM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVsZXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgbmV3U3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwogICAgICBuZXdTdHlsZS5pbm5lckhUTUwgPSB0aGlzLmRlbGV0ZV9hbmltOwogICAgICB0aGlzLmRpdi5hcHBlbmRDaGlsZChuZXdTdHlsZSk7CiAgICAgIHRoaXMuZGl2LnN0eWxlLmFuaW1hdGlvbiA9ICdkZWxldGUgMXMnOwogICAgICBpZiAodGhpcy5kZWxldGVfYW5pbSA9PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLmRpdi5yZW1vdmUoKTsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoKSB7CiAgICAgICAgc2VsZi5kaXYucmVtb3ZlRXZlbnRMaXN0ZW5lcigiYW5pbWF0aW9uZW5kIiwgaGFuZGxlciwgZmFsc2UpOwogICAgICAgIHNlbGYuZGl2LnJlbW92ZSgpOwogICAgICB9OwogICAgICBzZWxmLmRpdi5hZGRFdmVudExpc3RlbmVyKCJhbmltYXRpb25lbmQiLCBoYW5kbGVyLCBmYWxzZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic3Bhd24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNwYXduKCkgewogICAgICB2YXIgbmV3U3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwogICAgICBuZXdTdHlsZS5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZV9hbmltOwogICAgICB0aGlzLmRpdi5hcHBlbmRDaGlsZChuZXdTdHlsZSk7CiAgICAgIHRoaXMuZGl2LnN0eWxlLmFuaW1hdGlvbiA9ICdzcGF3biAxcyc7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoZmlyc3QpIHsKICAgICAgdmFyIG5ld0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGhpcy5uYW1lLnRvTG93ZXJDYXNlKCkpOwogICAgICBuZXdEaXYuaW5uZXJIVE1MID0gdGhpcy5odG1sOwogICAgICBjb25zb2xlLmxvZyhmaXJzdCk7CiAgICAgIGlmIChmaXJzdCA9PSB0cnVlICYmIHRoaXMucGFyZW50X2Rpdi5maXJzdENoaWxkICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy5wYXJlbnRfZGl2Lmluc2VydEJlZm9yZShuZXdEaXYsIHRoaXMucGFyZW50X2Rpdi5maXJzdENoaWxkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhcmVudF9kaXYuYXBwZW5kQ2hpbGQobmV3RGl2KTsKICAgICAgfQogICAgICB2YXIgbmV3U3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwogICAgICBuZXdTdHlsZS5pbm5lckhUTUwgPSB0aGlzLmNzczsKICAgICAgbmV3RGl2LmFwcGVuZENoaWxkKG5ld1N0eWxlKTsKICAgICAgdGhpcy5kaXYgPSBuZXdEaXY7CiAgICAgIHRoaXMuc3Bhd24oKTsKICAgICAgaWYgKHR5cGVvZiB0aGlzLm9uID09ICJmdW5jdGlvbiIpIHsKICAgICAgICB0aGlzLm9uKCk7CiAgICAgIH0KICAgIH0KICB9XSk7CiAgcmV0dXJuIE1vZHVsZTsKfSgpOwoKfSx7fV0sMTE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Cgp2YXIgX3JlcXVpcmUgPSByZXF1aXJlKCIuL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgUm91dGVyID0gX3JlcXVpcmUuUm91dGVyLAogIFRoZW1lID0gX3JlcXVpcmUuVGhlbWUsCiAgRGlzcGxheSA9IF9yZXF1aXJlLkRpc3BsYXk7CnZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuL3BhZ2VzL2xhbmRpbmcubWpzIiksCiAgTGFuZGluZyA9IF9yZXF1aXJlMi5MYW5kaW5nOwp2YXIgX3JlcXVpcmUzID0gcmVxdWlyZSgiLi9wYWdlcy9sb2dpbi5tanMiKSwKICBMb2dpbiA9IF9yZXF1aXJlMy5Mb2dpbjsKdmFyIF9yZXF1aXJlNCA9IHJlcXVpcmUoIi4vcGFnZXMvcmVnaXN0ZXIubWpzIiksCiAgUmVnaXN0ZXIgPSBfcmVxdWlyZTQuUmVnaXN0ZXI7CnZhciBfcmVxdWlyZTUgPSByZXF1aXJlKCIuL3BhZ2VzL2Vycm9ycy5tanMiKSwKICBOb3RGb3VuZCA9IF9yZXF1aXJlNS5Ob3RGb3VuZDsKdmFyIF9yZXF1aXJlNiA9IHJlcXVpcmUoIi4vcGFnZXMvcmVkaXJlY3QubWpzIiksCiAgUmVkaXJlY3QgPSBfcmVxdWlyZTYuUmVkaXJlY3Q7CnZhciBfcmVxdWlyZTcgPSByZXF1aXJlKCIuL3BhZ2VzL3RyZW5kaW5nLm1qcyIpLAogIFRyZW5kaW5nID0gX3JlcXVpcmU3LlRyZW5kaW5nOwp2YXIgX3JlcXVpcmU4ID0gcmVxdWlyZSgiLi9wYWdlcy9mZWVkLm1qcyIpLAogIEZlZWQgPSBfcmVxdWlyZTguRmVlZDsKdmFyIF9yZXF1aXJlOSA9IHJlcXVpcmUoIi4vcGFnZXMvbmV3X3Bvc3QubWpzIiksCiAgTmV3UG9zdCA9IF9yZXF1aXJlOS5OZXdQb3N0Owp2YXIgX3JlcXVpcmUxMCA9IHJlcXVpcmUoIi4vcGFnZXMvbmV3X2NvbW1lbnQubWpzIiksCiAgTmV3Q29tbWVudCA9IF9yZXF1aXJlMTAuTmV3Q29tbWVudDsKdmFyIF9yZXF1aXJlMTEgPSByZXF1aXJlKCIuL3BhZ2VzL3Byb2ZpbGUubWpzIiksCiAgUHJvZmlsZSA9IF9yZXF1aXJlMTEuUHJvZmlsZTsKdmFyIF9yZXF1aXJlMTIgPSByZXF1aXJlKCIuL3BhZ2VzL2Rhc2hib2FyZC5tanMiKSwKICBEYXNoYm9hcmQgPSBfcmVxdWlyZTEyLkRhc2hib2FyZDsKdmFyIF9yZXF1aXJlMTMgPSByZXF1aXJlKCIuL3BhZ2VzL3NldHRpbmdzLm1qcyIpLAogIFNldHRpbmdzID0gX3JlcXVpcmUxMy5TZXR0aW5nczsKdmFyIF9yZXF1aXJlMTQgPSByZXF1aXJlKCIuL3BhZ2VzL2V4cGxvcmUubWpzIiksCiAgRXhwbG9yZSA9IF9yZXF1aXJlMTQuRXhwbG9yZTsKdmFyIF9yZXF1aXJlMTUgPSByZXF1aXJlKCIuL3BhZ2VzL2xpdmUubWpzIiksCiAgTGl2ZSA9IF9yZXF1aXJlMTUuTGl2ZTsKdmFyIF9yZXF1aXJlMTYgPSByZXF1aXJlKCIuL3BhZ2VzL21haW50ZW5hbmNlLm1qcyIpLAogIE1haW50ZW5hbmNlID0gX3JlcXVpcmUxNi5NYWludGVuYW5jZTsKdmFyIF9yZXF1aXJlMTcgPSByZXF1aXJlKCIuL3BhZ2VzL2J1eS5tanMiKSwKICBCdXkgPSBfcmVxdWlyZTE3LkJ1eTsKdmFyIF9yZXF1aXJlMTggPSByZXF1aXJlKCIuL3NjcmlwdHMvYXBpLm1qcyIpLAogIFZlcmlmeVRva2VuID0gX3JlcXVpcmUxOC5WZXJpZnlUb2tlbiwKICBJc0xvZ2VkSW4gPSBfcmVxdWlyZTE4LklzTG9nZWRJbjsKdmFyIF9yZXF1aXJlMTkgPSByZXF1aXJlKCIuL3NjcmlwdHMvY29va2llcy5tanMiKSwKICBzZXRDb29raWUgPSBfcmVxdWlyZTE5LnNldENvb2tpZSwKICBnZXRDb29raWUgPSBfcmVxdWlyZTE5LmdldENvb2tpZSwKICBjaGVja0Nvb2tpZSA9IF9yZXF1aXJlMTkuY2hlY2tDb29raWU7CnZhciBfcmVxdWlyZTIwID0gcmVxdWlyZSgiLi9wYWdlcy9wb3N0Lm1qcyIpLAogIFBvc3QgPSBfcmVxdWlyZTIwLlBvc3Q7CnZhciByb3V0ZXIgPSBuZXcgUm91dGVyKCk7CnZhciBtYWludGVuYW5jZSA9IGZhbHNlOwppZiAobWFpbnRlbmFuY2UgPT0gZmFsc2UpIHsKICAvL1BhZ2VzCiAgcm91dGVyLnJlZ2lzdGVyUm91dGUoIiIsIFtMYW5kaW5nXSk7CiAgcm91dGVyLnJlZ2lzdGVyUm91dGUoImxvZ2luIiwgW0xvZ2luXSk7CiAgcm91dGVyLnJlZ2lzdGVyUm91dGUoInJlZ2lzdGVyIiwgW1JlZ2lzdGVyXSk7CiAgcm91dGVyLnJlZ2lzdGVyUm91dGUoInRyZW5kaW5nIiwgW1RyZW5kaW5nXSk7CiAgcm91dGVyLnJlZ2lzdGVyUm91dGUoImZlZWQiLCBbRmVlZF0pOwogIHJvdXRlci5yZWdpc3RlclJvdXRlKCJuZXciLCBbTmV3UG9zdF0pOwogIHJvdXRlci5yZWdpc3RlclJvdXRlKCJwcm9maWxlIiwgW1Byb2ZpbGVdKTsKICByb3V0ZXIucmVnaXN0ZXJSb3V0ZSgiZGFzaGJvYXJkIiwgW0Rhc2hib2FyZF0pOwogIHJvdXRlci5yZWdpc3RlclJvdXRlKCJzZXR0aW5ncyIsIFtTZXR0aW5nc10pOwogIHJvdXRlci5yZWdpc3RlclJvdXRlKCJleHBsb3JlIiwgW0V4cGxvcmVdKTsKICByb3V0ZXIucmVnaXN0ZXJSb3V0ZSgibGl2ZSIsIFtMaXZlXSk7CiAgcm91dGVyLnJlZ2lzdGVyUm91dGUoImJ1eSIsIFtCdXldKTsKICByb3V0ZXIucmVnaXN0ZXJSb3V0ZSgicG9zdCIsIFtQb3N0XSk7CiAgcm91dGVyLnJlZ2lzdGVyUm91dGUoImNvbW1lbnQiLCBbTmV3Q29tbWVudF0pOwoKICAvL0Vycm9ycwogIHJvdXRlci5yZWdpc3RlckVycm9yKDQwNCwgW05vdEZvdW5kXSk7CgogIC8vUmVkaXJlY3Rpb25zCiAgcm91dGVyLnJlZ2lzdGVyUm91dGUoInN0YXR1cyIsIFtSZWRpcmVjdF0pOwogIHJvdXRlci5yZWdpc3RlclJvdXRlKCJ0d2l0dGVyIiwgW1JlZGlyZWN0XSk7CiAgcm91dGVyLnJlZ2lzdGVyUm91dGUoImRpc2NvcmQiLCBbUmVkaXJlY3RdKTsKICByb3V0ZXIucmVnaXN0ZXJSb3V0ZSgic2NyYXRjaCIsIFtSZWRpcmVjdF0pOwogIHJvdXRlci5yZWdpc3RlclJvdXRlKCJhcGkiLCBbUmVkaXJlY3RdKTsKICByb3V0ZXIucmVnaXN0ZXJSb3V0ZSgiZG9jcyIsIFtSZWRpcmVjdF0pOwp9IGVsc2UgewogIHJvdXRlci5yZWdpc3RlclJvdXRlKCIiLCBbTWFpbnRlbmFuY2VdKTsKICByb3V0ZXIucmVnaXN0ZXJFcnJvcig0MDQsIFtNYWludGVuYW5jZV0pOwogIHJvdXRlci5yZWdpc3RlclJvdXRlKCJkaXNjb3JkIiwgW1JlZGlyZWN0XSk7Cn0KdmFyIGRlZmF1bHRUaGVtZSA9IG5ldyBUaGVtZSgiZGVmYXVsdCIpOwp2YXIgZGVmYXVsdEpzb24gPSByZXF1aXJlKCcuL3RoZW1lcy9kZWZhdWx0Lmpzb24nKTsKZGVmYXVsdFRoZW1lLnBhcnNlKGRlZmF1bHRKc29uKTsKZGVmYXVsdFRoZW1lLnJlZ2lzdGVyKCk7CnZhciBkaXNwbGF5ID0gbmV3IERpc3BsYXkoKTsKaWYgKGdldENvb2tpZSgidjEtdGhlbWUiKSkgewogIHZhciBwYXJzZWREYXRhID0gSlNPTi5wYXJzZShnZXRDb29raWUoInYxLXRoZW1lIikpOwogIHZhciBjdXN0b21UaGVtZSA9IG5ldyBUaGVtZSgiY3VzdG9tIik7CiAgY3VzdG9tVGhlbWUucGFyc2UocGFyc2VkRGF0YSk7CiAgY3VzdG9tVGhlbWUucmVnaXN0ZXIoKTsKICBkaXNwbGF5LnNldF90aGVtZSgiY3VzdG9tIik7Cn0gZWxzZSB7CiAgZGlzcGxheS5zZXRfdGhlbWUoImRlZmF1bHQiKTsKfQpyb3V0ZXIuc3RhcnQoKTsKaWYgKElzTG9nZWRJbigpKSB7CiAgVmVyaWZ5VG9rZW4oKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgaWYgKHZhbHVlICE9IHRydWUpIHsKICAgICAgc2V0Q29va2llKCJ2MS11c2VyIiwgIiIpOwogICAgICBzZXRDb29raWUoInYxLWlkIiwgIiIpOwogICAgICBzZXRDb29raWUoInYxLXRva2VuIiwgIiIpOwogICAgICBzZXRDb29raWUoInYxLXByb2ZpbGUtcGljdHVyZSIsICIiKTsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi8iKTsKICAgIH0KICB9KTsKfQoKfSx7Ii4vbGliL0ZyYW1ld29yay5tanMiOjEwLCIuL3BhZ2VzL2J1eS5tanMiOjEyLCIuL3BhZ2VzL2Rhc2hib2FyZC5tanMiOjEzLCIuL3BhZ2VzL2Vycm9ycy5tanMiOjE0LCIuL3BhZ2VzL2V4cGxvcmUubWpzIjoxNSwiLi9wYWdlcy9mZWVkLm1qcyI6MTYsIi4vcGFnZXMvbGFuZGluZy5tanMiOjE3LCIuL3BhZ2VzL2xpdmUubWpzIjoxOCwiLi9wYWdlcy9sb2dpbi5tanMiOjE5LCIuL3BhZ2VzL21haW50ZW5hbmNlLm1qcyI6MjAsIi4vcGFnZXMvbmV3X2NvbW1lbnQubWpzIjoyMSwiLi9wYWdlcy9uZXdfcG9zdC5tanMiOjIyLCIuL3BhZ2VzL3Bvc3QubWpzIjoyMywiLi9wYWdlcy9wcm9maWxlLm1qcyI6MjQsIi4vcGFnZXMvcmVkaXJlY3QubWpzIjoyNSwiLi9wYWdlcy9yZWdpc3Rlci5tanMiOjI2LCIuL3BhZ2VzL3NldHRpbmdzLm1qcyI6MjcsIi4vcGFnZXMvdHJlbmRpbmcubWpzIjoyOCwiLi9zY3JpcHRzL2FwaS5tanMiOjI5LCIuL3NjcmlwdHMvY29va2llcy5tanMiOjMwLCIuL3RoZW1lcy9kZWZhdWx0Lmpzb24iOjMxfV0sMTI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuQnV5ID0gQnV5OwpmdW5jdGlvbiBCdXkocm91dGVyKSB7CiAgdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiLi4vbGliL0ZyYW1ld29yay5tanMiKSwKICAgIFBhZ2UgPSBfcmVxdWlyZS5QYWdlLAogICAgRGlzcGxheSA9IF9yZXF1aXJlLkRpc3BsYXk7CiAgdmFyIF9yZXF1aXJlMiA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL2ZvbnRzLm1qcyIpLAogICAgRm9udHMgPSBfcmVxdWlyZTIuRm9udHM7CiAgdmFyIF9yZXF1aXJlMyA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIiksCiAgICBCYWNrZ3JvdW5kID0gX3JlcXVpcmUzLkJhY2tncm91bmQ7CiAgdmFyIF9yZXF1aXJlNCA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25hdmJhci5tanMiKSwKICAgIE5hdmJhciA9IF9yZXF1aXJlNC5OYXZiYXI7CiAgdmFyIF9yZXF1aXJlNSA9IHJlcXVpcmUoIi4uL3NjcmlwdHMvYXBpLm1qcyIpLAogICAgSXNMb2dlZEluID0gX3JlcXVpcmU1LklzTG9nZWRJbiwKICAgIEJhbGFuY2UgPSBfcmVxdWlyZTUuQmFsYW5jZSwKICAgIFN0YXRzID0gX3JlcXVpcmU1LlN0YXRzLAogICAgQnV5UG9zdCA9IF9yZXF1aXJlNS5CdXlQb3N0OwogIHZhciBfcmVxdWlyZTYgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9ub3RpZmljYXRpb25zLm1qcyIpLAogICAgTm90aWZpY2F0aW9uID0gX3JlcXVpcmU2Lk5vdGlmaWNhdGlvbjsKICB2YXIgX3JlcXVpcmU3ID0gcmVxdWlyZSgiLi4vc2NyaXB0cy9jb29raWVzLm1qcyIpLAogICAgc2V0Q29va2llID0gX3JlcXVpcmU3LnNldENvb2tpZSwKICAgIGdldENvb2tpZSA9IF9yZXF1aXJlNy5nZXRDb29raWUsCiAgICBjaGVja0Nvb2tpZSA9IF9yZXF1aXJlNy5jaGVja0Nvb2tpZTsKICB2YXIgX3JlcXVpcmU4ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvcG9zdC5tanMiKSwKICAgIFByZXZpZXdQb3N0ID0gX3JlcXVpcmU4LlByZXZpZXdQb3N0OwogIGlmIChJc0xvZ2VkSW4oKSA9PSBmYWxzZSkgewogICAgTm90aWZpY2F0aW9uKDEsICJZb3UgbmVlZCB0byBiZSBsb2dnZWQgaW4gdG8gYWNjZXNzIHRoaXMgcGFnZS4iKTsKICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvZXhwbG9yZSIpOwogICAgcmV0dXJuICIiOwogIH0KICB2YXIgcGFnZSA9IG5ldyBQYWdlKCJCdXkiKTsKICB2YXIgZGlzcGxheSA9IG5ldyBEaXNwbGF5KCk7CiAgcGFnZS5jbGVhcihbImJhY2tncm91bmQiLCAibmF2YmFyIiwgImZvbnRzIiwgIm5ld19wb3N0X2J1dHRvbiJdKTsKICBGb250cyhyb3V0ZXIpOwogIEJhY2tncm91bmQocm91dGVyKTsKICBOYXZiYXIocm91dGVyKTsKICB2YXIgYmxhbmtfbG9nbyA9IHBhZ2UuaW1hZ2UoImxvZ29fYmxhbmsuc3ZnIik7CiAgcGFnZS5odG1sKCJcbiAgICAgIDxkaXYgaWQ9XCJiaWctY29udGFpbmVyXCI+XG4gICAgICAgIDxkaXYgaWQ9XCJjb250YWluZXJcIj5cbiAgICAgICAgICA8ZGl2IGlkPVwiY29udC0xXCIgY2xhc3M9XCJjb250YWluZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0aXRsZVwiIGlkPVwidGl0bGVcIj5cbiAgICAgICAgICAgICAgT3ZlcndpZXcgUG9zdCAjTG9hZGluZy4uLiBieSBATG9hZGluZy4uLlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBpZD1cImNvbnQtMlwiIGNsYXNzPVwiY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGl0bGVcIj5cbiAgICAgICAgICAgICAgUHJldmlld1xuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGlkPVwicG9zdC1jb250YWluZXItYnV5XCI+PC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBpZD1cImNvbnQtM1wiIGNsYXNzPVwiY29udGFpbmVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInRpdGxlXCI+XG4gICAgICAgICAgICBTdGF0c1xuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgaWQ9XCJzdGF0cy1jb250YWluZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdGF0XCI+PHNwYW4gY2xhc3M9XCJtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkXCIgaWQ9XCJpY29uLTFcIj5mYXZvcml0ZTwvc3Bhbj4gPHNwYW4gaWQ9XCJsaWtlc1wiPjA8L3NwYW4+IDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN0YXRcIj48c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIiBpZD1cImljb24tMlwiPnZpc2liaWxpdHk8L3NwYW4+IDxzcGFuIGlkPVwidmlld3NcIj4wPC9zcGFuPiA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdGF0XCI+PGltZyBzcmM9XCIiLmNvbmNhdChibGFua19sb2dvLCAiXCIgY2xhc3M9XCJhLXN0YXQtYmxvY2tjb2luXCIgLz4gPHNwYW4gaWQ9XCJibG9ja2NvaW5cIj4wPC9zcGFuPiAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBpZD1cImNvbnQtNFwiIGNsYXNzPVwiY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGlkPVwiYnV5XCI+QnV5IFBvc3QgI0xvYWRpbmcuLiA/PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGlkPVwiYnV5LWJ1dHRvblwiPjxzcGFuIGlkPVwiYnV5LXRleHRcIj5CdXkgLSAxNSA8L3NwYW4+PGltZyBzcmM9XCIiKS5jb25jYXQoYmxhbmtfbG9nbywgIlwiIGNsYXNzPVwiYS1zdGF0LWJ1dHRvblwiIC8+PC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBpZD1cImNvbnQtNVwiIGNsYXNzPVwiY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8Y2FudmFzIGlkPVwiY2FudmEtZGF0YVwiPjwvY2FudmFzPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgXG4gICAgIikpOwogIHBhZ2UuY3NzKCJcbiAgICAuYS1zdGF0LWJsb2NrY29pbiB7XG4gICAgICB3aWR0aDo1MHB4O1xuICAgICAgaGVpZ2h0OjUwcHg7XG4gICAgICBcbiAgICB9XG4gICAgLmEtc3RhdC1idXR0b24ge1xuICAgICAgd2lkdGg6MzdweDtcbiAgICAgIGhlaWdodDozN3B4O1xuICAgICAgbWFyZ2luLWxlZnQ6MTdweDtcbiAgICB9XG4gICAgI2J1eSB7XG4gICAgICBmb250LWZhbWlseTogJyIuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogNTAwO1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzFdLCAiO1xuICAgICAgdGV4dC1hbGlnbjpjZW50ZXI7XG4gICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgfVxuICAgICNidXktYnV0dG9uIHtcbiAgICAgIGN1cnNvcjpwb2ludGVyO1xuICAgICAgdHJhbnNpdGlvbi1kdXJhdGlvbjogMC41cztcbiAgICAgIGZvbnQtZmFtaWx5OiAnIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogNDAwO1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzJdLCAiO1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgYm9yZGVyLXJhZGl1czogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyLXJhZGl1cyJdWzBdLCAiO1xuICAgICAgYm9yZGVyOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXIiXSwgIjtcbiAgICAgIGhlaWdodDphdXRvO1xuICAgICAgd2lkdGg6YXV0bztcbiAgICAgIHRleHQtYWxpZ246Y2VudGVyO1xuICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjtcbiAgICB9XG4gICAgI3Bvc3QtY29udGFpbmVyLWJ1eSBwb3N0IHtcbiAgICAgIHdpZHRoOjgwJTtcbiAgICAgIGhlaWdodDpmaXQtY29udGVudDtcbiAgICAgIG1pbi1oZWlnaHQ6IDUlO1xuICAgIH1cbiAgICAjcG9zdC1jb250YWluZXItYnV5IHtcbiAgICAgIG92ZXJmbG93OmF1dG87XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjtcbiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgIHRvcDoyMCU7XG4gICAgICBoZWlnaHQ6ODAlO1xuICAgICAgd2lkdGg6MTAwJTtcbiAgICAgIGxlZnQ6MDtcbiAgICAgIHBvc2l0aW9uOmFic29sdXRlO1xuICAgIH1cbiAgICAjY2FudmEtZGF0YXtcbiAgICAgIHdpZHRoOjEwMCU7XG4gICAgICBoZWlnaHQ6MTAwJTtcbiAgICB9IFxuICAgIC5saW5rIHtcbiAgICAgIGN1cnNvcjpwb2ludGVyO1xuICAgICAgYm9yZGVyOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXIiXSwgIjtcbiAgICAgIHdpZHRoOiAyMCU7XG4gICAgICBoZWlnaHQ6IDQwJTtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsyXSwgIjtcbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIGZvbnQtZmFtaWx5OiAnIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogNDAwO1xuICAgICAgdGV4dC1hbGlnbjpjZW50ZXI7XG4gICAgICBib3JkZXItcmFkaXVzOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXItcmFkaXVzIl1bMF0sICI7XG4gICAgICBtYXJnaW46NSU7XG4gICAgICBtYXJnaW4tdG9wOjA7XG4gICAgICBtYXJnaW4tYm90dG9tOjA7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjtcbiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICB9XG4gICAgI2xpbmtzLWNvbnRhaW5lciB7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgZmxleC13cmFwOiB3cmFwO1xuICAgICAgd2lkdGg6MTAwJTtcbiAgICAgIGhlaWdodDo3MCU7XG4gICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICAgIHRvcDoyNSU7XG4gICAgICBsZWZ0OjA7XG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO1xuICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgIH1cbiAgICAjbGItY29udGFpbmVyIHtcbiAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgIGp1c3RpZnktY29udGVudDpzcGFjZS1ldmVubHk7XG4gICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICAgIGxlZnQ6MDtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOnJvdztcbiAgICAgIHdpZHRoOjEwMCU7XG4gICAgICBoZWlnaHQ6NzAlO1xuICAgICAgdG9wOjIwJTtcbiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICB9XG4gICAgLmxiIHtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsyXSwgIjtcbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIGZvbnQtZmFtaWx5OiAnIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogNDAwO1xuICAgICAgdGV4dC1hbGlnbjpjZW50ZXI7XG4gICAgfVxuICAgIC5sYi1iaWcge1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzRdLCAiO1xuICAgIH1cbiAgICAjc3RhdHMge1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzRdLCAiO1xuICAgIH1cbiAgICAjaWNvbi0xIHtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVs0XSwgIjtcbiAgICB9XG4gICAgI2ljb24tMiB7XG4gICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bNF0sICI7XG4gICAgfVxuICAgICNpY29uLTMge1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzRdLCAiO1xuICAgIH1cbiAgICAjaWNvbi00IHtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVs0XSwgIjtcbiAgICB9XG4gICAgLnN0YXQge1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzRdLCAiO1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgZm9udC1mYW1pbHk6ICciKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiJywgc2Fucy1zZXJpZjtcbiAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7XG4gICAgfVxuICAgICNzdGF0cy1jb250YWluZXIge1xuICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjtcbiAgICAgIHBvc2l0aW9uOmFic29sdXRlO1xuICAgICAgdG9wOjA7XG4gICAgICBsZWZ0OjA7XG4gICAgICBmbGV4LWRpcmVjdGlvbjpjb2x1bW47XG4gICAgICB3aWR0aDoxMDAlO1xuICAgICAgaGVpZ2h0OjcwJTtcbiAgICAgIHRvcDoyMCU7XG4gICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgfVxuICAgICN3ZWxjb21lIHtcbiAgICAgIGZvbnQtZmFtaWx5OiAnIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogNDAwO1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzJdLCAiO1xuICAgICAgbWFyZ2luLWxlZnQ6NXB4O1xuICAgIH1cbiAgICAjYmFsYW5jZSB7XG4gICAgICBmb250LWZhbWlseTogJyIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICInLCBzYW5zLXNlcmlmO1xuICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVs0XSwgIjtcbiAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgIGp1c3RpZnktY29udGVudDpmbGV4LWVuZDtcbiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgIG1hcmdpbi1sZWZ0OjIuNSU7XG4gICAgICBtYXJnaW4tcmlnaHQ6MjJweDtcbiAgICB9XG4gICAgI2NvbnQtMS01IHtcbiAgICAgIHBvc2l0aW9uOmFic29sdXRlO1xuICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAganVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnQ7XG4gICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgICB0b3A6NSU7XG4gICAgICBsZWZ0OjIuNSU7XG4gICAgICB3aWR0aDo1MCU7XG4gICAgfVxuICAgICNjb250LTEtOCB7XG4gICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgIGp1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O1xuICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgICAgdG9wOjA7XG4gICAgICBsZWZ0OjA7XG4gICAgICB3aWR0aDoxMDAlO1xuICAgICAgaGVpZ2h0OjEwMCU7XG4gICAgfVxuICAgICNiYWxhbmNlIGltZyB7XG4gICAgICB3aWR0aDo3NXB4O1xuICAgICAgaGVpZ2h0Ojc1cHg7XG4gICAgfVxuICAgIC50aXRsZSB7XG4gICAgICBmb250LWZhbWlseTogJyIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICInLCBzYW5zLXNlcmlmO1xuICAgICAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVszXSwgIjtcbiAgICAgIHRleHQtYWxpZ246Y2VudGVyO1xuICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG4gICAgICB0b3A6NSU7XG4gICAgICBsZWZ0OjIuNSU7XG4gICAgfVxuICAgICNiaWctY29udGFpbmVyIHtcbiAgICAgIHdpZHRoOjEwMCU7XG4gICAgICBoZWlnaHQ6MTAwJTtcbiAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgIGp1c3RpZnktY29udGVudDpjZW50ZXI7XG4gICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICAgIHRvcDowO1xuICAgICAgbGVmdDowO1xuICAgIH1cbiAgICAjY29udGFpbmVyIHtcbiAgICAgIHdpZHRoOjgwJTtcbiAgICAgIGhlaWdodDo4MCU7XG4gICAgfVxuICAgIC5jb250YWluZXIge1xuICAgICAgYm9yZGVyOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXIiXSwgIjtcbiAgICAgIGJvcmRlci1yYWRpdXM6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJvcmRlci1yYWRpdXMiXVswXSwgIjtcbiAgICAgIHBvc2l0aW9uOmFic29sdXRlO1xuICAgIH1cbiAgICAjY29udC0xe1xuICAgICAgd2lkdGg6ODAlO1xuICAgICAgaGVpZ2h0OjE1JTtcbiAgICAgIHRvcDoxNSU7XG4gICAgICBsZWZ0OjEwJTtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO1xuICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgIH1cblxuICAgICNjb250LTEgZGl2e1xuICAgICAgd2lkdGg6MTAwJTtcbiAgICAgIHBvc2l0aW9uOnN0YXRpYztcbiAgICAgIG1hcmdpbjpub25lO1xuICAgIH1cblxuICAgICNjb250LTEgaW1ne1xuICAgICAgd2lkdGg6NjVweDtcbiAgICAgIGJvcmRlci1yYWRpdXM6MjU2cHg7XG4gICAgICBoZWlnaHQ6NjVweDtcbiAgICB9XG5cbiAgICAjY29udC0ye1xuICAgICAgd2lkdGg6MzkuNzUlO1xuICAgICAgaGVpZ2h0OjI5JTtcbiAgICAgIHRvcDozMSU7XG4gICAgICBsZWZ0OjEwJTtcbiAgICB9XG4gICAgI2NvbnQtM3tcbiAgICAgIHdpZHRoOjM5Ljc1JTtcbiAgICAgIGhlaWdodDoyOSU7XG4gICAgICB0b3A6MzElO1xuICAgICAgcmlnaHQ6MTAlO1xuICAgIH1cbiAgICAjY29udC00e1xuICAgICAgd2lkdGg6MTkuNzUlO1xuICAgICAgaGVpZ2h0OjM1JTtcbiAgICAgIHJpZ2h0OjEwJTtcbiAgICAgIHRvcDo2MSU7XG4gICAgICBkaXNwbGF5OmZsZXg7XG4gICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOmNvbHVtbjtcbiAgICB9XG4gICAgI2NvbnQtNXtcbiAgICAgIHdpZHRoOjU5Ljc1JTtcbiAgICAgIGhlaWdodDozNSU7XG4gICAgICBsZWZ0OjEwJTtcbiAgICAgIHRvcDo2MSU7XG4gICAgfVxuICAiKSk7CiAgZnVuY3Rpb24gb25fcmVuZGVyKCkgewogICAgdmFyIGFwaV91cmwgPSAid3NzOi8vYXBpLmJsb2NrY29pbi5zb2NpYWwiOwogICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PSAiMTI3LjAuMC4xIiB8fCB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT0gImxvY2FsaG9zdCIpIHsKICAgICAgYXBpX3VybCA9ICJ3czovLzEyNy4wLjAuMTo4MDgwIjsKICAgIH0KICAgIHZhciBzb2NrZXQgPSBudWxsOwogICAgdmFyIGNhY2hlID0gbnVsbDsKICAgIHZhciBwb3N0X2lkID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCIvIilbMl07CiAgICBzb2NrZXQgPSBuZXcgV2ViU29ja2V0KGFwaV91cmwgKyAnL3Bvc3QnKTsKICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTsKICAgICAgY2FjaGUgPSBkYXRhOwogICAgfSk7CiAgICBmdW5jdGlvbiB3YWl0Rm9yTm9uTnVsbENhY2hlKCkgewogICAgICB2YXIgaW50ZXJ2YWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDEwMDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgZnVuY3Rpb24gY2hlY2tWYXJpYWJsZSgpIHsKICAgICAgICAgIGNhY2hlOwogICAgICAgICAgaWYgKGNhY2hlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHJlc29sdmUoY2FjaGUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2V0VGltZW91dChjaGVja1ZhcmlhYmxlLCBpbnRlcnZhbCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNoZWNrVmFyaWFibGUoKTsKICAgICAgfSk7CiAgICB9CiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignb3BlbicsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgJ29wY29kZSc6IDEsCiAgICAgICAgImlkIjogcG9zdF9pZAogICAgICB9KSk7CiAgICB9KTsKICAgIHdhaXRGb3JOb25OdWxsQ2FjaGUoKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICB2YXIgcG9zdCA9IHZhbHVlOwogICAgICBpZiAodmFsdWVbInN1Y2Nlc3MiXSAhPSB0cnVlKSB7CiAgICAgICAgTm90aWZpY2F0aW9uKDEsICJVbmtub3duIFBvc3QiKTsKICAgICAgICByb3V0ZXIubmF2aWdhdGVUbygiL2V4cGxvcmUiKTsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRpdGxlIikuaW5uZXJUZXh0ID0gIk92ZXJ3aWV3IFBvc3QgIyIgKyBwb3N0WyJkYXRhIl1bImlkIl0gKyAiIGJ5IEAiICsgcG9zdFsicHJvZmlsZSJdWyJkaXNwbGF5Il07CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXkiKS5pbm5lclRleHQgPSAiQnV5IHBvc3QgIyIgKyBwb3N0WyJkYXRhIl1bImlkIl0gKyAiID8iOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5LXRleHQiKS5pbm5lclRleHQgPSAiQnV5IC0gIiArIHBvc3RbImRhdGEiXVsicHJpY2UiXTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpa2VzIikuaW5uZXJUZXh0ID0gcG9zdFsiZGF0YSJdWyJsaWtlcyJdOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidmlld3MiKS5pbm5lclRleHQgPSBwb3N0WyJkYXRhIl1bInZpZXdzIl07CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJibG9ja2NvaW4iKS5pbm5lclRleHQgPSBwb3N0WyJkYXRhIl1bInByaWNlIl07CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXktYnV0dG9uIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBncmVjYXB0Y2hhLnJlYWR5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGdyZWNhcHRjaGEuZXhlY3V0ZSgnNkxmMW40SW9BQUFBQUVYRkVlbDFCZmt4SHJjdXpKVUpOZlBpRkEzcScsIHsKICAgICAgICAgICAgYWN0aW9uOiAnc3VibWl0JwogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAodG9rZW4pIHsKICAgICAgICAgICAgQnV5UG9zdChwb3N0X2lkLCB0b2tlbikudGhlbihmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uKDAsICJQb3N0IEJ1eWVkIDspIik7CiAgICAgICAgICAgICAgICByb3V0ZXIubmF2aWdhdGVUbygiL2V4cGxvcmUiKTsKICAgICAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uKDEsIHZhbHVlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICAgIGlmIChwb3N0WyJkYXRhIl1bImlzQnV5YWJsZSJdID09IGZhbHNlKSB7CiAgICAgICAgTm90aWZpY2F0aW9uKDEsICJUaGlzIHBvc3QgaXMgbm90IHRvIHNlbGwuIik7CiAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9leHBsb3JlIik7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICAgIHZhciBwb3N0X2RhdGEgPSBwb3N0WyJkYXRhIl07CiAgICAgIHBvc3RfZGF0YVsidXNlci1pZCJdID0gcG9zdFsicHJvZmlsZSJdWyJpZCJdOwogICAgICBwb3N0X2RhdGFbInVzZXIiXSA9IHBvc3RbInByb2ZpbGUiXVsiZGlzcGxheSJdOwogICAgICBwb3N0X2RhdGFbInByb2ZpbGUtcGljdHVyZSJdID0gcG9zdFsicHJvZmlsZSJdWyJwcm9maWxlLXBpY3R1cmUiXTsKICAgICAgcG9zdF9kYXRhWyJiYWRnZXMiXSA9IHBvc3RbInByb2ZpbGUiXVsiYmFkZ2VzIl07CiAgICAgIHZhciBuZXdfcG9zdCA9IG5ldyBQcmV2aWV3UG9zdChyb3V0ZXIsIHBvc3RfZGF0YSwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvc3QtY29udGFpbmVyLWJ1eSIpKTsKICAgICAgdmFyIHBvc3RzID0gdmFsdWVbImRhdGEiXVsiY2hhcnQiXTsKICAgICAgY29uc29sZS5sb2cocG9zdHMpOwogICAgICBjb25zb2xlLmxvZyh2YWx1ZSk7CiAgICAgIC8vIFNvcnQgdGhlIHBvc3RzIGJhc2VkIG9uIHRoZSB0aW1lCiAgICAgIHBvc3RzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICByZXR1cm4gYVsidGltZSJdIC0gYlsidGltZSJdOwogICAgICB9KTsKCiAgICAgIC8vIEluaXRpYWxpemUgYXJyYXlzIGZvciBkYXRhc2V0cwogICAgICB2YXIgdGltZUxhYmVscyA9IFtdOwogICAgICB2YXIgdmlld1BlckRheSA9IFtdOwogICAgICB2YXIgdG90YWxWaWV3cyA9IFtdOwogICAgICB2YXIgbGlrZVBlckRheSA9IFtdOwogICAgICB2YXIgdG90YWxMaWtlcyA9IFtdOwogICAgICB2YXIgcHJpY2VDaGFuZ2VQZXJEYXkgPSBbXTsKICAgICAgdmFyIHRvdGFsUHJpY2UgPSBbXTsKCiAgICAgIC8vIENhbGN1bGF0ZSBkYWlseSBjaGFuZ2VzIGFuZCB0b3RhbCB2YWx1ZXMKICAgICAgaWYgKHBvc3RzLmxlbmd0aCA+IDEpIHsKICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBvc3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YXIgdGltZURpZmYgPSBwb3N0c1tpXVsidGltZSJdIC0gcG9zdHNbaSAtIDFdWyJ0aW1lIl07CiAgICAgICAgICB0aW1lTGFiZWxzLnB1c2gobmV3IERhdGUocG9zdHNbaV1bInRpbWUiXSAqIDEwMDApLnRvTG9jYWxlRGF0ZVN0cmluZygpKTsgLy8gQ29udmVydCB0aW1lIHRvIGRhdGUgZm9ybWF0CiAgICAgICAgICB2aWV3UGVyRGF5LnB1c2goKHBvc3RzW2ldWyJ2aWV3Il0gLSBwb3N0c1tpIC0gMV1bInZpZXciXSkgLyAodGltZURpZmYgLyA4NjQwMCkpOyAvLyBDYWxjdWxhdGUgdmlld3MgcGVyIGRheQogICAgICAgICAgdG90YWxWaWV3cy5wdXNoKHBvc3RzW2ldWyJ2aWV3Il0pOyAvLyBBZGQgdG90YWwgdmlld3MKICAgICAgICAgIGxpa2VQZXJEYXkucHVzaCgocG9zdHNbaV1bImxpa2UiXSAtIHBvc3RzW2kgLSAxXVsibGlrZSJdKSAvICh0aW1lRGlmZiAvIDg2NDAwKSk7IC8vIENhbGN1bGF0ZSBsaWtlcyBwZXIgZGF5CiAgICAgICAgICB0b3RhbExpa2VzLnB1c2gocG9zdHNbaV1bImxpa2UiXSk7IC8vIEFkZCB0b3RhbCBsaWtlcwogICAgICAgICAgcHJpY2VDaGFuZ2VQZXJEYXkucHVzaCgocG9zdHNbaV1bInByaWNlIl0gLSBwb3N0c1tpIC0gMV1bInByaWNlIl0pIC8gKHRpbWVEaWZmIC8gODY0MDApKTsgLy8gQ2FsY3VsYXRlIHByaWNlIGNoYW5nZSBwZXIgZGF5CiAgICAgICAgICB0b3RhbFByaWNlLnB1c2gocG9zdHNbaV1bInByaWNlIl0pOyAvLyBBZGQgdG90YWwgcHJpY2UKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gSWYgdGhlcmUncyBvbmx5IG9uZSB0aW1lc3RhbXAsIGRpc3BsYXkgdG90YWwgdmFsdWVzIHdpdGhvdXQgZXZvbHV0aW9uCiAgICAgICAgdGltZUxhYmVscy5wdXNoKG5ldyBEYXRlKHBvc3RzWzBdWyJ0aW1lIl0gKiAxMDAwKS50b0xvY2FsZURhdGVTdHJpbmcoKSk7CiAgICAgICAgdG90YWxWaWV3cy5wdXNoKHBvc3RzWzBdWyJ2aWV3Il0pOwogICAgICAgIHRvdGFsTGlrZXMucHVzaChwb3N0c1swXVsibGlrZSJdKTsKICAgICAgICB0b3RhbFByaWNlLnB1c2gocG9zdHNbMF1bInByaWNlIl0pOwogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKHRpbWVMYWJlbHMpOwogICAgICBjb25zb2xlLmxvZyh2aWV3UGVyRGF5KTsKICAgICAgY29uc29sZS5sb2codG90YWxWaWV3cyk7CiAgICAgIGNvbnNvbGUubG9nKGxpa2VQZXJEYXkpOwogICAgICBjb25zb2xlLmxvZyh0b3RhbExpa2VzKTsKICAgICAgY29uc29sZS5sb2cocHJpY2VDaGFuZ2VQZXJEYXkpOwogICAgICBjb25zb2xlLmxvZyh0b3RhbFByaWNlKTsKICAgICAgLy8gQ3JlYXRlIHRoZSBjaGFydAogICAgICB2YXIgY3R4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhLWRhdGEnKS5nZXRDb250ZXh0KCcyZCcpOwogICAgICB2YXIgbXlDaGFydCA9IG5ldyBDaGFydChjdHgsIHsKICAgICAgICB0eXBlOiAnbGluZScsCiAgICAgICAgZGF0YTogewogICAgICAgICAgbGFiZWxzOiB0aW1lTGFiZWxzLAogICAgICAgICAgZGF0YXNldHM6IFt7CiAgICAgICAgICAgIGxhYmVsOiAnVmlld3MgcGVyIGRheScsCiAgICAgICAgICAgIGRhdGE6IHZpZXdQZXJEYXksCiAgICAgICAgICAgIGJvcmRlckNvbG9yOiAnYmx1ZScsCiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ2xpZ2h0Ymx1ZScKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBWaWV3cycsCiAgICAgICAgICAgIGRhdGE6IHRvdGFsVmlld3MsCiAgICAgICAgICAgIGJvcmRlckNvbG9yOiAnZ3JlZW4nLAogICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdsaWdodGdyZWVuJwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ0xpa2VzIHBlciBkYXknLAogICAgICAgICAgICBkYXRhOiBsaWtlUGVyRGF5LAogICAgICAgICAgICBib3JkZXJDb2xvcjogJ3JlZCcsCiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3BpbmsnCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgTGlrZXMnLAogICAgICAgICAgICBkYXRhOiB0b3RhbExpa2VzLAogICAgICAgICAgICBib3JkZXJDb2xvcjogJ29yYW5nZScsCiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3llbGxvdycKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICdQcmljZSBjaGFuZ2UgcGVyIGRheScsCiAgICAgICAgICAgIGRhdGE6IHByaWNlQ2hhbmdlUGVyRGF5LAogICAgICAgICAgICBib3JkZXJDb2xvcjogJ3B1cnBsZScsCiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ2xhdmVuZGVyJwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ1RvdGFsIFByaWNlJywKICAgICAgICAgICAgZGF0YTogdG90YWxQcmljZSwKICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICdicm93bicsCiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3RhbicKICAgICAgICAgIH1dCiAgICAgICAgfSwKICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICByZXNwb25zaXZlOiB0cnVlLAogICAgICAgICAgbWFpbnRhaW5Bc3BlY3RSYXRpbzogZmFsc2UKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgfQogIHBhZ2Uuc3Bhd25fYW5pbWF0aW9uKCJcbiAgICBAa2V5ZnJhbWVzIHNwYXduIHtcbiAgICAgICAgMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xMCUpO1xuICAgICAgICB9XG4gICAgICAgIDEwMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOyAvKiBBZGp1c3QgdGhlIGRpc3RhbmNlIHlvdSB3YW50IHRvIG1vdmUgb24gdGhlIHktYXhpcyAqL1xuICAgICAgICB9XG4gICAgICB9XG4gICAgIik7CiAgcGFnZS5vbl9yZW5kZXIob25fcmVuZGVyKTsKICBwYWdlLnJlbmRlcigpOwp9Cgp9LHsiLi4vZWxlbWVudHMvYmFja2dyb3VuZC5tanMiOjIsIi4uL2VsZW1lbnRzL2ZvbnRzLm1qcyI6NCwiLi4vZWxlbWVudHMvbmF2YmFyLm1qcyI6NiwiLi4vZWxlbWVudHMvbm90aWZpY2F0aW9ucy5tanMiOjgsIi4uL2VsZW1lbnRzL3Bvc3QubWpzIjo5LCIuLi9saWIvRnJhbWV3b3JrLm1qcyI6MTAsIi4uL3NjcmlwdHMvYXBpLm1qcyI6MjksIi4uL3NjcmlwdHMvY29va2llcy5tanMiOjMwfV0sMTM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuRGFzaGJvYXJkID0gRGFzaGJvYXJkOwpmdW5jdGlvbiBEYXNoYm9hcmQocm91dGVyKSB7CiAgdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiLi4vbGliL0ZyYW1ld29yay5tanMiKSwKICAgIFBhZ2UgPSBfcmVxdWlyZS5QYWdlLAogICAgRGlzcGxheSA9IF9yZXF1aXJlLkRpc3BsYXk7CiAgdmFyIF9yZXF1aXJlMiA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL2ZvbnRzLm1qcyIpLAogICAgRm9udHMgPSBfcmVxdWlyZTIuRm9udHM7CiAgdmFyIF9yZXF1aXJlMyA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIiksCiAgICBCYWNrZ3JvdW5kID0gX3JlcXVpcmUzLkJhY2tncm91bmQ7CiAgdmFyIF9yZXF1aXJlNCA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25hdmJhci5tanMiKSwKICAgIE5hdmJhciA9IF9yZXF1aXJlNC5OYXZiYXI7CiAgdmFyIF9yZXF1aXJlNSA9IHJlcXVpcmUoIi4uL3NjcmlwdHMvYXBpLm1qcyIpLAogICAgSXNMb2dlZEluID0gX3JlcXVpcmU1LklzTG9nZWRJbiwKICAgIEJhbGFuY2UgPSBfcmVxdWlyZTUuQmFsYW5jZSwKICAgIFN0YXRzID0gX3JlcXVpcmU1LlN0YXRzOwogIHZhciBfcmVxdWlyZTYgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9ub3RpZmljYXRpb25zLm1qcyIpLAogICAgTm90aWZpY2F0aW9uID0gX3JlcXVpcmU2Lk5vdGlmaWNhdGlvbjsKICB2YXIgX3JlcXVpcmU3ID0gcmVxdWlyZSgiLi4vc2NyaXB0cy9jb29raWVzLm1qcyIpLAogICAgc2V0Q29va2llID0gX3JlcXVpcmU3LnNldENvb2tpZSwKICAgIGdldENvb2tpZSA9IF9yZXF1aXJlNy5nZXRDb29raWUsCiAgICBjaGVja0Nvb2tpZSA9IF9yZXF1aXJlNy5jaGVja0Nvb2tpZTsKICBpZiAoSXNMb2dlZEluKCkgPT0gZmFsc2UpIHsKICAgIE5vdGlmaWNhdGlvbigxLCAiWW91IG5lZWQgdG8gYmUgbG9nZ2VkIGluIHRvIGFjY2VzcyB0aGlzIHBhZ2UuIik7CiAgICByb3V0ZXIubmF2aWdhdGVUbygiL2V4cGxvcmUiKTsKICAgIHJldHVybiAiIjsKICB9CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiRGFzaGJvYXJkIik7CiAgdmFyIGRpc3BsYXkgPSBuZXcgRGlzcGxheSgpOwogIHBhZ2UuY2xlYXIoWyJiYWNrZ3JvdW5kIiwgIm5hdmJhciIsICJmb250cyIsICJuZXdfcG9zdF9idXR0b24iXSk7CiAgRm9udHMocm91dGVyKTsKICBCYWNrZ3JvdW5kKHJvdXRlcik7CiAgTmF2YmFyKHJvdXRlcik7CiAgdmFyIGJsYW5rX2xvZ28gPSBwYWdlLmltYWdlKCJsb2dvX2JsYW5rLnN2ZyIpOwogIHBhZ2UuaHRtbCgiXG4gICAgICA8ZGl2IGlkPVwiYmlnLWNvbnRhaW5lclwiPlxuICAgICAgICA8ZGl2IGlkPVwiY29udGFpbmVyXCI+XG4gICAgICAgICAgPGRpdiBpZD1cImNvbnQtMVwiIGNsYXNzPVwiY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8ZGl2IGlkPVwiY29udC0xLTVcIj5cbiAgICAgICAgICAgICAgPGltZyBpZD1cImRhc2gtcHJvZmlsZS1waWN0dXJlXCIgLz5cbiAgICAgICAgICAgICAgPGRpdiBpZD1cIndlbGNvbWVcIj4gV2VsY29tZSBiYWNrIExvYWRpbmcuPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgaWQ9XCJjb250LTEtOFwiPlxuICAgICAgICAgICAgICA8ZGl2IGlkPVwiYmFsYW5jZVwiPkJhbGFuY2U6IDA8L2Rpdj4gXG4gICAgICAgICAgICAgIDxpbWcgc3JjPVwiIi5jb25jYXQoYmxhbmtfbG9nbywgIlwiIGFsdD1cIkEgd2hpdGUgdmVyc2lvbiBvZiB0aGUgYmxvY2tjb2luIGxvZ28uXCIgaWQ9XCJjdXJyZW5jeVwiLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgaWQ9XCJjb250LTJcIiBjbGFzcz1cImNvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGRpdiBpZD1cInN0YXRzXCIgY2xhc3M9XCJ0aXRsZVwiPlN0YXRzPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGlkPVwic3RhdHMtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdGF0XCI+PHNwYW4gY2xhc3M9XCJtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkXCIgaWQ9XCJpY29uLTFcIj5mYXZvcml0ZTwvc3Bhbj4gPHNwYW4gaWQ9XCJsaWtlc1wiPjA8L3NwYW4+IDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3RhdFwiPjxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZFwiIGlkPVwiaWNvbi0yXCI+dmlzaWJpbGl0eTwvc3Bhbj4gPHNwYW4gaWQ9XCJ2aWV3c1wiPjA8L3NwYW4+IDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3RhdFwiPjxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZFwiIGlkPVwiaWNvbi0zXCI+Y29tbWVudDwvc3Bhbj4gPHNwYW4gaWQ9XCJjb21tZW50c1wiPjA8L3NwYW4+IDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3RhdFwiPjxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZFwiIGlkPVwiaWNvbi00XCI+c3luYzwvc3Bhbj4gPHNwYW4gaWQ9XCJyZXBvc3RzXCI+MDwvc3Bhbj4gPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGlkPVwiY29udC0zXCIgY2xhc3M9XCJjb250YWluZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0aXRsZVwiPkxlYWRlcmJvYXJkczwvZGl2PlxuICAgICAgICAgICAgPGRpdiBpZD1cImxiLWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGJcIj48c3BhbiBpZD1cImxiLWJhbGFuY2VcIiBjbGFzcz1cImxiLWJpZ1wiPiMwPC9zcGFuPjxicj5Ub3RhbCBCYWxhbmNlPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsYlwiPjxzcGFuIGlkPVwibGItdmlld3NcIiBjbGFzcz1cImxiLWJpZ1wiPiMwPC9zcGFuPjxicj5Ub3RhbCBWaWV3czwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGJcIj48c3BhbiBpZD1cImxiLWxpa2VzXCIgY2xhc3M9XCJsYi1iaWdcIj4jMDwvc3Bhbj48YnI+VG90YWwgTGlrZXM8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgaWQ9XCJjb250LTRcIiBjbGFzcz1cImNvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRpdGxlXCI+UXVpY2sgTGlua3M8L2Rpdj4gIFxuICAgICAgICAgICAgPGRpdiBpZD1cImxpbmtzLWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGlua1wiIGlkPVwibGluay1zZXR0aW5nc1wiPjxwPlNldHRpbmdzPC9wPjwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGlua1wiIGlkPVwibGluay1leHBsb3JlXCI+PHA+RXhwbG9yZTwvcD48L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImxpbmtcIiBpZD1cImxpbmstZmVlZFwiPjxwPkZlZWQ8L3A+PC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaW5rXCIgaWQ9XCJsaW5rLXByb2ZpbGVcIj48cD5Qcm9maWxlPC9wPjwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGlua1wiIGlkPVwibGluay1zdGF0dXNcIj48cD5TdGF0dXM8L3A+PC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaW5rXCIgaWQ9XCJsaW5rLWxhbmRpbmdcIj48cD5MYW5kaW5nPC9wPjwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgIikpOwogIHBhZ2UuY3NzKCJcbiAgICAubGluayB7XG4gICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgIGJvcmRlcjogIi5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXIiXSwgIjtcbiAgICAgIHdpZHRoOiAyMCU7XG4gICAgICBoZWlnaHQ6IDQwJTtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsxXSwgIjtcbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIGZvbnQtZmFtaWx5OiAnIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogNDAwO1xuICAgICAgdGV4dC1hbGlnbjpjZW50ZXI7XG4gICAgICBib3JkZXItcmFkaXVzOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXItcmFkaXVzIl1bMF0sICI7XG4gICAgICBtYXJnaW46NSU7XG4gICAgICBtYXJnaW4tdG9wOjA7XG4gICAgICBtYXJnaW4tYm90dG9tOjA7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjtcbiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICB9XG4gICAgI2xpbmtzLWNvbnRhaW5lciB7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgZmxleC13cmFwOiB3cmFwO1xuICAgICAgd2lkdGg6MTAwJTtcbiAgICAgIGhlaWdodDo3MCU7XG4gICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICAgIHRvcDoyNSU7XG4gICAgICBsZWZ0OjA7XG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO1xuICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgIH1cbiAgICAjbGItY29udGFpbmVyIHtcbiAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgIGp1c3RpZnktY29udGVudDpzcGFjZS1ldmVubHk7XG4gICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICAgIGxlZnQ6MDtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOnJvdztcbiAgICAgIHdpZHRoOjEwMCU7XG4gICAgICBoZWlnaHQ6NzAlO1xuICAgICAgdG9wOjIwJTtcbiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICB9XG4gICAgLmxiIHtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsxXSwgIjtcbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIGZvbnQtZmFtaWx5OiAnIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogNDAwO1xuICAgICAgdGV4dC1hbGlnbjpjZW50ZXI7XG4gICAgfVxuICAgIC5sYi1iaWcge1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzNdLCAiO1xuICAgIH1cbiAgICAjc3RhdHMge1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzNdLCAiO1xuICAgIH1cbiAgICAjaWNvbi0xIHtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVszXSwgIjtcbiAgICB9XG4gICAgI2ljb24tMiB7XG4gICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bM10sICI7XG4gICAgfVxuICAgICNpY29uLTMge1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzNdLCAiO1xuICAgIH1cbiAgICAjaWNvbi00IHtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVszXSwgIjtcbiAgICB9XG4gICAgLnN0YXQge1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzNdLCAiO1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgZm9udC1mYW1pbHk6ICciKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiJywgc2Fucy1zZXJpZjtcbiAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7XG4gICAgfVxuICAgICNzdGF0cy1jb250YWluZXIge1xuICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjtcbiAgICAgIHBvc2l0aW9uOmFic29sdXRlO1xuICAgICAgdG9wOjA7XG4gICAgICBsZWZ0OjA7XG4gICAgICBmbGV4LWRpcmVjdGlvbjpjb2x1bW47XG4gICAgICB3aWR0aDoxMDAlO1xuICAgICAgaGVpZ2h0OjcwJTtcbiAgICAgIHRvcDoyMCU7XG4gICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgfVxuICAgICN3ZWxjb21lIHtcbiAgICAgIGZvbnQtZmFtaWx5OiAnIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogNDAwO1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzJdLCAiO1xuICAgICAgbWFyZ2luLWxlZnQ6NXB4O1xuICAgIH1cbiAgICAjYmFsYW5jZSB7XG4gICAgICBmb250LWZhbWlseTogJyIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICInLCBzYW5zLXNlcmlmO1xuICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVs0XSwgIjtcbiAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgIGp1c3RpZnktY29udGVudDpmbGV4LWVuZDtcbiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgIG1hcmdpbi1sZWZ0OjIuNSU7XG4gICAgICBtYXJnaW4tcmlnaHQ6MjJweDtcbiAgICB9XG4gICAgI2NvbnQtMS01IHtcbiAgICAgIHBvc2l0aW9uOmFic29sdXRlO1xuICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAganVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnQ7XG4gICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgICB0b3A6NSU7XG4gICAgICBsZWZ0OjIuNSU7XG4gICAgICB3aWR0aDo1MCU7XG4gICAgfVxuICAgICNjb250LTEtOCB7XG4gICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgIGp1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O1xuICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgICAgdG9wOjA7XG4gICAgICBsZWZ0OjA7XG4gICAgICB3aWR0aDoxMDAlO1xuICAgICAgaGVpZ2h0OjEwMCU7XG4gICAgfVxuICAgICNiYWxhbmNlIGltZyB7XG4gICAgICB3aWR0aDo3NXB4O1xuICAgICAgaGVpZ2h0Ojc1cHg7XG4gICAgfVxuICAgIC50aXRsZSB7XG4gICAgICBmb250LWZhbWlseTogJyIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICInLCBzYW5zLXNlcmlmO1xuICAgICAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsyXSwgIjtcbiAgICAgIHBvc2l0aW9uOmFic29sdXRlO1xuICAgICAgdG9wOjUlO1xuICAgICAgbGVmdDoyLjUlO1xuICAgIH1cbiAgICAjYmlnLWNvbnRhaW5lciB7XG4gICAgICB3aWR0aDoxMDAlO1xuICAgICAgaGVpZ2h0OjEwMCU7XG4gICAgICBkaXNwbGF5OmZsZXg7XG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO1xuICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG4gICAgICB0b3A6MDtcbiAgICAgIGxlZnQ6MDtcbiAgICB9XG4gICAgI2NvbnRhaW5lciB7XG4gICAgICB3aWR0aDo4MCU7XG4gICAgICBoZWlnaHQ6ODAlO1xuICAgIH1cbiAgICAuY29udGFpbmVyIHtcbiAgICAgIGJvcmRlcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyIl0sICI7XG4gICAgICBib3JkZXItcmFkaXVzOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXItcmFkaXVzIl1bMV0sICI7XG4gICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICB9XG4gICAgI2NvbnQtMXtcbiAgICAgIHdpZHRoOjgwJTtcbiAgICAgIGhlaWdodDozOSU7XG4gICAgICB0b3A6MTAlO1xuICAgICAgbGVmdDoxMCU7XG4gICAgfVxuXG4gICAgI2NvbnQtMSBpbWd7XG4gICAgICB3aWR0aDo2NXB4O1xuICAgICAgYm9yZGVyLXJhZGl1czoyNTZweDtcbiAgICAgIGhlaWdodDo2NXB4O1xuICAgIH1cblxuICAgICNjb250LTJ7XG4gICAgICB3aWR0aDozOS43NSU7XG4gICAgICBoZWlnaHQ6MzklO1xuICAgICAgdG9wOjUwJTtcbiAgICAgIGxlZnQ6MTAlO1xuICAgIH1cbiAgICAjY29udC0ze1xuICAgICAgd2lkdGg6MzkuNzUlO1xuICAgICAgaGVpZ2h0OjE5JTtcbiAgICAgIHJpZ2h0OjEwJTtcbiAgICAgIHRvcDo1MCU7XG4gICAgfVxuICAgICNjb250LTR7XG4gICAgICB3aWR0aDozOS43NSU7XG4gICAgICBoZWlnaHQ6MTklO1xuICAgICAgcmlnaHQ6MTAlO1xuICAgICAgdG9wOjcwJTtcbiAgICB9XG4gICIpKTsKICBmdW5jdGlvbiBvbl9yZW5kZXIoKSB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgid2VsY29tZSIpLmlubmVyVGV4dCA9ICJXZWxjb21lIGJhY2sgIiArIGdldENvb2tpZSgidjEtdXNlciIpICsgIi4iOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRhc2gtcHJvZmlsZS1waWN0dXJlIikuc3JjID0gZ2V0Q29va2llKCJ2MS1wcm9maWxlLXBpY3R1cmUiKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaW5rLXNldHRpbmdzIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9zZXR0aW5ncyIpOwogICAgfTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaW5rLXByb2ZpbGUiKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICByb3V0ZXIubmF2aWdhdGVUbygiL3Byb2ZpbGUvIiArIGdldENvb2tpZSgidjEtaWQiKSk7CiAgICB9OwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpbmstc3RhdHVzIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9zdGF0dXMiKTsKICAgIH07CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGluay1sYW5kaW5nIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi8iKTsKICAgIH07CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGluay1mZWVkIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9mZWVkIik7CiAgICB9OwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpbmstZXhwbG9yZSIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvZXhwbG9yZSIpOwogICAgfTsKICAgIEJhbGFuY2UoZ2V0Q29va2llKCJ2MS1pZCIpKS50aGVuKGZ1bmN0aW9uIChiYWxhbmNlKSB7CiAgICAgIGlmIChiYWxhbmNlID09PSBmYWxzZSkgewogICAgICAgIE5vdGlmaWNhdGlvbigxLCAiQW4gZXJyb3Igb2NjdXJlZC4gQ29kZTogdTQwNGQgIik7CiAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9leHBsb3JlIik7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJiYWxhbmNlIikuaW5uZXJUZXh0ID0gIkJhbGFuY2U6ICIgKyBNYXRoLmZsb29yKGJhbGFuY2UpOwogICAgfSk7CiAgICBTdGF0cyhnZXRDb29raWUoInYxLWlkIikpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgaWYgKGRhdGEgPT09IGZhbHNlKSB7CiAgICAgICAgTm90aWZpY2F0aW9uKDEsICJBbiBlcnJvciBvY2N1cmVkLiBDb2RlOiB1NDA0ZCAiKTsKICAgICAgICByb3V0ZXIubmF2aWdhdGVUbygiL2V4cGxvcmUiKTsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpa2VzIikuaW5uZXJUZXh0ID0gZGF0YVsibGlrZXMiXTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInZpZXdzIikuaW5uZXJUZXh0ID0gZGF0YVsidmlld3MiXTsKICAgIH0pOwogIH0KICBwYWdlLnNwYXduX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBzcGF3biB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIHBhZ2Uub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIjoyLCIuLi9lbGVtZW50cy9mb250cy5tanMiOjQsIi4uL2VsZW1lbnRzL25hdmJhci5tanMiOjYsIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIjo4LCIuLi9saWIvRnJhbWV3b3JrLm1qcyI6MTAsIi4uL3NjcmlwdHMvYXBpLm1qcyI6MjksIi4uL3NjcmlwdHMvY29va2llcy5tanMiOjMwfV0sMTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuTm90Rm91bmQgPSBOb3RGb3VuZDsKZnVuY3Rpb24gTm90Rm91bmQocm91dGVyKSB7CiAgdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiLi4vbGliL0ZyYW1ld29yay5tanMiKSwKICAgIFBhZ2UgPSBfcmVxdWlyZS5QYWdlLAogICAgRGlzcGxheSA9IF9yZXF1aXJlLkRpc3BsYXk7CiAgdmFyIF9yZXF1aXJlMiA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL2ZvbnRzLm1qcyIpLAogICAgRm9udHMgPSBfcmVxdWlyZTIuRm9udHM7CiAgdmFyIF9yZXF1aXJlMyA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIiksCiAgICBCYWNrZ3JvdW5kID0gX3JlcXVpcmUzLkJhY2tncm91bmQ7CiAgdmFyIF9yZXF1aXJlNCA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25hdmJhci5tanMiKSwKICAgIE5hdmJhciA9IF9yZXF1aXJlNC5OYXZiYXI7CiAgdmFyIF9yZXF1aXJlNSA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL2Zvb3Rlci5tanMiKSwKICAgIEZvb3RlciA9IF9yZXF1aXJlNS5Gb290ZXI7CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiTm90Rm91bmQiKTsKICB2YXIgZGlzcGxheSA9IG5ldyBEaXNwbGF5KCk7CiAgcGFnZS5jbGVhcihbImJhY2tncm91bmQiLCAibmF2YmFyIiwgImZvbnRzIiwgImZvb3RlciJdKTsKICBGb250cyhyb3V0ZXIpOwogIEJhY2tncm91bmQocm91dGVyKTsKICBOYXZiYXIocm91dGVyKTsKICBGb290ZXIocm91dGVyKTsKICBwYWdlLmh0bWwoIjxkaXYgaWQ9XCJjZW50ZXItY29udGFpblwiPlxuICAgICAgICA8ZGl2IGlkPVwiZXJyb3ItY29kZVwiPiA0MDQgPC9kaXY+XG4gICAgICAgIDxoMz4gSSBkb25cdTIwMTl0IGtub3cgd2hvIG9yIHdoYXQgd2VudCB3cm9uZywgYnV0IHNvbWVvbmUgb3Igc29tZXRoaW5nIHN1cmUgd2VudCAhIDwvaDM+XG4gICAgICAgIDxhIGNsYXNzPVwiYnV0dG9uXCIgaWQ9XCJtYWluLW1lbnVcIj5NYWluIE1lbnU8L2E+XG4gICAgPC9kaXY+Iik7CiAgcGFnZS5jc3MoIlxuICAgICNjZW50ZXItY29udGFpbiB7XG4gICAgICAgIHotaW5kZXg6MDtcbiAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG4gICAgICAgIHRvcDowO1xuICAgICAgICBsZWZ0OjA7XG4gICAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIH1cblxuICAgICNlcnJvci1jb2RlIHtcbiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICBmb250LWZhbWlseTogIi5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bNF0sICI7XG4gICAgICAgIGZvbnQtc3R5bGU6IG5vcm1hbDtcbiAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDtcbiAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDE0OWRlZywgIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJiYWNrZ3JvdW5kIilbImVsaXBzZS1jb2xvciJdWzBdLCAiIDAlLCAiKS5jb25jYXQoZGlzcGxheS5nZXQoImJhY2tncm91bmQiKVsiZWxpcHNlLWNvbG9yIl1bMV0sICIgMTAwJSk7XG4gICAgICAgIC13ZWJraXQtYmFja2dyb3VuZC1jbGlwOiB0ZXh0O1xuICAgICAgICBjb2xvcjogdHJhbnNwYXJlbnQ7XG4gICAgfVxuXG4gICAgaDMge1xuICAgICAgICBmb250LWZhbWlseTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7XG4gICAgfVxuXG4gICAgLmJ1dHRvbiB7XG4gICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcbiAgICAgIGN1cnNvcjpwb2ludGVyO1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgZm9udC1mYW1pbHk6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICIsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bM10sICI7XG4gICAgICBmb250LXdlaWdodDogNDAwO1xuICAgICAgei1pbmRleDogMTA7XG4gICAgfVxuXG4gICAgI21haW4tbWVudSB7XG4gICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcbiAgICAgIGN1cnNvcjpwb2ludGVyO1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgZm9udC1mYW1pbHk6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICIsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bM10sICI7XG4gICAgICBmb250LXdlaWdodDogNDAwO1xuICAgICAgei1pbmRleDogMTA7XG4gICAgfVxuXG4gICAgYSB7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xuICAgIH1cbiIpKTsKICBwYWdlLmRlbGV0ZV9hbmltYXRpb24oIlxuICAgIEBrZXlmcmFtZXMgZGVsZXRlIHtcbiAgICAgICAgMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxMCUpOyAvKiBBZGp1c3QgdGhlIGRpc3RhbmNlIHlvdSB3YW50IHRvIG1vdmUgb24gdGhlIHktYXhpcyAqL1xuICAgICAgICB9XG4gICAgICB9XG4gICAgIik7CiAgcGFnZS5zcGF3bl9hbmltYXRpb24oIlxuICAgIEBrZXlmcmFtZXMgc3Bhd24ge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwJSk7XG4gICAgICAgIH1cbiAgICAgICAgMTAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBmdW5jdGlvbiBvbl9yZW5kZXIoKSB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWFpbi1tZW51Iikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi8iKTsKICAgIH07CiAgfQogIHBhZ2Uub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIjoyLCIuLi9lbGVtZW50cy9mb250cy5tanMiOjQsIi4uL2VsZW1lbnRzL2Zvb3Rlci5tanMiOjUsIi4uL2VsZW1lbnRzL25hdmJhci5tanMiOjYsIi4uL2xpYi9GcmFtZXdvcmsubWpzIjoxMH1dLDE1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkV4cGxvcmUgPSBFeHBsb3JlOwpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsgfQpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9CmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIGFycjJbaV0gPSBhcnJbaV07IHJldHVybiBhcnIyOyB9CmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChyLCBsKSB7IHZhciB0ID0gbnVsbCA9PSByID8gbnVsbCA6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBTeW1ib2wgJiYgcltTeW1ib2wuaXRlcmF0b3JdIHx8IHJbIkBAaXRlcmF0b3IiXTsgaWYgKG51bGwgIT0gdCkgeyB2YXIgZSwgbiwgaSwgdSwgYSA9IFtdLCBmID0gITAsIG8gPSAhMTsgdHJ5IHsgaWYgKGkgPSAodCA9IHQuY2FsbChyKSkubmV4dCwgMCA9PT0gbCkgeyBpZiAoT2JqZWN0KHQpICE9PSB0KSByZXR1cm47IGYgPSAhMTsgfSBlbHNlIGZvciAoOyAhKGYgPSAoZSA9IGkuY2FsbCh0KSkuZG9uZSkgJiYgKGEucHVzaChlLnZhbHVlKSwgYS5sZW5ndGggIT09IGwpOyBmID0gITApOyB9IGNhdGNoIChyKSB7IG8gPSAhMCwgbiA9IHI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghZiAmJiBudWxsICE9IHRbInJldHVybiJdICYmICh1ID0gdFsicmV0dXJuIl0oKSwgT2JqZWN0KHUpICE9PSB1KSkgcmV0dXJuOyB9IGZpbmFsbHkgeyBpZiAobykgdGhyb3cgbjsgfSB9IHJldHVybiBhOyB9IH0KZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CmZ1bmN0aW9uIEV4cGxvcmUocm91dGVyKSB7CiAgdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiLi4vbGliL0ZyYW1ld29yay5tanMiKSwKICAgIFBhZ2UgPSBfcmVxdWlyZS5QYWdlOwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb250cy5tanMiKSwKICAgIEZvbnRzID0gX3JlcXVpcmUyLkZvbnRzOwogIHZhciBfcmVxdWlyZTMgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyIpLAogICAgQmFja2dyb3VuZCA9IF9yZXF1aXJlMy5CYWNrZ3JvdW5kOwogIHZhciBfcmVxdWlyZTQgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIiksCiAgICBOYXZiYXIgPSBfcmVxdWlyZTQuTmF2YmFyOwogIHZhciBfcmVxdWlyZTUgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9wb3N0Lm1qcyIpLAogICAgUG9zdCA9IF9yZXF1aXJlNS5Qb3N0OwogIHZhciBfcmVxdWlyZTYgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlNi5Jc0xvZ2VkSW47CiAgdmFyIF9yZXF1aXJlNyA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIiksCiAgICBOb3RpZmljYXRpb24gPSBfcmVxdWlyZTcuTm90aWZpY2F0aW9uOwogIHZhciBfcmVxdWlyZTggPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uZXdfcG9zdF9idXR0b24ubWpzIiksCiAgICBOZXdQb3N0QnV0dG9uID0gX3JlcXVpcmU4Lk5ld1Bvc3RCdXR0b247CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiRXhwbG9yZSIpOwogIHBhZ2UuY2xlYXIoWyJiYWNrZ3JvdW5kIiwgIm5hdmJhciIsICJmb250cyIsICJuZXdfcG9zdF9idXR0b24iXSk7CiAgRm9udHMocm91dGVyKTsKICBCYWNrZ3JvdW5kKHJvdXRlcik7CiAgTmF2YmFyKHJvdXRlcik7CiAgTmV3UG9zdEJ1dHRvbihyb3V0ZXIpOwogIHBhZ2UuaHRtbCgiXG4gICAgPGRpdiBpZD1cInBvc3QtY29udGFpbmVyXCI+XG5cbiAgICA8L2Rpdj5cbiAgICAiKTsKICBwYWdlLmNzcygiXG5cbiAgICAjcG9zdC1jb250YWluZXIge1xuICAgICAgICBtYXJnaW4tdG9wOiA3LjUlO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIG1pbi1oZWlnaHQ6MTAwJTtcbiAgICAgICAgd2lkdGg6MTAwJTtcbiAgICAgICAgaGVpZ2h0OmZpdC1jb250ZW50O1xuICAgICAgICB0b3A6MDtcbiAgICAgICAgbGVmdDowO1xuICAgICAgICBkaXNwbGF5OmZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDpzdGFydDtcbiAgICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjpjb2x1bW47XG4gICAgfVxuXG4gICAgI3Bvc3QtY29udGFpbmVyIHBvc3Qge1xuICAgICAgd2lkdGg6NjAlO1xuICAgICAgaGVpZ2h0OmZpdC1jb250ZW50O1xuICAgICAgbWluLWhlaWdodDogNSU7XG4gICAgICBtYXJnaW46IDElXG4gICAgfVxuICAgICIpOwogIHZhciBhcGlfdXJsID0gIndzczovL2FwaS5ibG9ja2NvaW4uc29jaWFsIjsKICBpZiAod2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09ICIxMjcuMC4wLjEiIHx8IHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PSAibG9jYWxob3N0IikgewogICAgYXBpX3VybCA9ICJ3czovLzEyNy4wLjAuMTo4MDgwIjsKICB9CiAgdmFyIHNvY2tldCA9IG51bGw7CiAgZnVuY3Rpb24gb25fcmVuZGVyKCkgewogICAgc29ja2V0ID0gbmV3IFdlYlNvY2tldChhcGlfdXJsICsgJy9wb3N0Jyk7CiAgICB2YXIgY2FjaGUgPSBbXTsKICAgIGZ1bmN0aW9uIHdhaXRGb3JOb25OdWxsQ2FjaGUoKSB7CiAgICAgIHZhciBpbnRlcnZhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMTAwOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBmdW5jdGlvbiBjaGVja1ZhcmlhYmxlKCkgewogICAgICAgICAgY2FjaGU7CiAgICAgICAgICBpZiAoY2FjaGUgIT09IG51bGwpIHsKICAgICAgICAgICAgcmVzb2x2ZShjYWNoZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZXRUaW1lb3V0KGNoZWNrVmFyaWFibGUsIGludGVydmFsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2hlY2tWYXJpYWJsZSgpOwogICAgICB9KTsKICAgIH0KICAgIGZ1bmN0aW9uIHBhcnNlY2FjaGUoKSB7CiAgICAgIGlmIChjYWNoZSAhPSBudWxsKSB7CiAgICAgICAgaWYgKGNhY2hlWyJvcGNvZGUiXSA9PSAyKSB7CiAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9PYmplY3QkZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKGNhY2hlWyJkYXRhIl0pOyBfaSA8IF9PYmplY3QkZW50cmllcy5sZW5ndGg7IF9pKyspIHsKICAgICAgICAgICAgdmFyIF9PYmplY3QkZW50cmllcyRfaSA9IF9zbGljZWRUb0FycmF5KF9PYmplY3QkZW50cmllc1tfaV0sIDIpLAogICAgICAgICAgICAgIGtleSA9IF9PYmplY3QkZW50cmllcyRfaVswXSwKICAgICAgICAgICAgICB2YWx1ZSA9IF9PYmplY3QkZW50cmllcyRfaVsxXTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICB2YXIgcG9zdCA9IHZhbHVlOwogICAgICAgICAgICAgIHZhciBwb3N0X2RhdGEgPSBwb3N0WyJkYXRhIl07CiAgICAgICAgICAgICAgcG9zdF9kYXRhWyJ1c2VyLWlkIl0gPSBwb3N0WyJwcm9maWxlIl1bImlkIl07CiAgICAgICAgICAgICAgcG9zdF9kYXRhWyJ1c2VyIl0gPSBwb3N0WyJwcm9maWxlIl1bImRpc3BsYXkiXTsKICAgICAgICAgICAgICBwb3N0X2RhdGFbInByb2ZpbGUtcGljdHVyZSJdID0gcG9zdFsicHJvZmlsZSJdWyJwcm9maWxlLXBpY3R1cmUiXTsKICAgICAgICAgICAgICBwb3N0X2RhdGFbImJhZGdlcyJdID0gcG9zdFsicHJvZmlsZSJdWyJiYWRnZXMiXTsKICAgICAgICAgICAgICB2YXIgbmV3X3Bvc3QgPSBuZXcgUG9zdChyb3V0ZXIsIHBvc3RfZGF0YSwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvc3QtY29udGFpbmVyIikpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIiwgZS5zdGFjayk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIiwgZS5uYW1lKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IiLCBlLm1lc3NhZ2UpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChldmVudCkgewogICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7CiAgICAgIGNhY2hlID0gZGF0YTsKICAgICAgcGFyc2VjYWNoZSgpOwogICAgfSk7CiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignY2xvc2UnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgc29ja2V0ID0gbmV3IFdlYlNvY2tldChhcGlfdXJsICsgJy9wb3N0Jyk7CiAgICB9KTsKICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdvcGVuJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAnb3Bjb2RlJzogMiwKICAgICAgICAnbGltaXQnOiAxMAogICAgICB9KSk7CiAgICB9KTsKICAgIHdpbmRvdy5vbnNjcm9sbCA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNjcm9sbEhlaWdodCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQ7CiAgICAgIHZhciBzY3JvbGxUb3AgPSB3aW5kb3cucGFnZVlPZmZzZXQgIT09IHVuZGVmaW5lZCA/IHdpbmRvdy5wYWdlWU9mZnNldCA6IChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgfHwgZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlIHx8IGRvY3VtZW50LmJvZHkpLnNjcm9sbFRvcDsKICAgICAgdmFyIHdpbmRvd0hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDsKICAgICAgaWYgKHNjcm9sbFRvcCArIHdpbmRvd0hlaWdodCA+PSBzY3JvbGxIZWlnaHQpIHsKICAgICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAnb3Bjb2RlJzogMiwKICAgICAgICAgICdsaW1pdCc6IDIwCiAgICAgICAgfSkpOwogICAgICAgIHBhcnNlY2FjaGUoKTsKICAgICAgfQogICAgfTsKICB9CiAgcGFnZS5kZWxldGVfYW5pbWF0aW9uKCJcbiAgICBAa2V5ZnJhbWVzIGRlbGV0ZSB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwJSk7XG4gICAgICAgIH1cbiAgICAgICAgMTAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMTAlKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIHBhZ2Uuc3Bhd25fYW5pbWF0aW9uKCJcbiAgICBAa2V5ZnJhbWVzIHNwYXduIHtcbiAgICAgICAgMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xMCUpO1xuICAgICAgICB9XG4gICAgICAgIDEwMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOyAvKiBBZGp1c3QgdGhlIGRpc3RhbmNlIHlvdSB3YW50IHRvIG1vdmUgb24gdGhlIHktYXhpcyAqL1xuICAgICAgICB9XG4gICAgICB9XG4gICAgIik7CiAgZnVuY3Rpb24gb25fZGVsZXRlKCkgewogICAgc29ja2V0LmNsb3NlKCk7CiAgfQogIHBhZ2Uub25fZGVsZXRlKG9uX2RlbGV0ZSk7CiAgcGFnZS5vbl9yZW5kZXIob25fcmVuZGVyKTsKICBwYWdlLnJlbmRlcigpOwp9Cgp9LHsiLi4vZWxlbWVudHMvYmFja2dyb3VuZC5tanMiOjIsIi4uL2VsZW1lbnRzL2ZvbnRzLm1qcyI6NCwiLi4vZWxlbWVudHMvbmF2YmFyLm1qcyI6NiwiLi4vZWxlbWVudHMvbmV3X3Bvc3RfYnV0dG9uLm1qcyI6NywiLi4vZWxlbWVudHMvbm90aWZpY2F0aW9ucy5tanMiOjgsIi4uL2VsZW1lbnRzL3Bvc3QubWpzIjo5LCIuLi9saWIvRnJhbWV3b3JrLm1qcyI6MTAsIi4uL3NjcmlwdHMvYXBpLm1qcyI6Mjl9XSwxNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5GZWVkID0gRmVlZDsKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfQpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQociwgbCkgeyB2YXIgdCA9IG51bGwgPT0gciA/IG51bGwgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgU3ltYm9sICYmIHJbU3ltYm9sLml0ZXJhdG9yXSB8fCByWyJAQGl0ZXJhdG9yIl07IGlmIChudWxsICE9IHQpIHsgdmFyIGUsIG4sIGksIHUsIGEgPSBbXSwgZiA9ICEwLCBvID0gITE7IHRyeSB7IGlmIChpID0gKHQgPSB0LmNhbGwocikpLm5leHQsIDAgPT09IGwpIHsgaWYgKE9iamVjdCh0KSAhPT0gdCkgcmV0dXJuOyBmID0gITE7IH0gZWxzZSBmb3IgKDsgIShmID0gKGUgPSBpLmNhbGwodCkpLmRvbmUpICYmIChhLnB1c2goZS52YWx1ZSksIGEubGVuZ3RoICE9PSBsKTsgZiA9ICEwKTsgfSBjYXRjaCAocikgeyBvID0gITAsIG4gPSByOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIWYgJiYgbnVsbCAhPSB0WyJyZXR1cm4iXSAmJiAodSA9IHRbInJldHVybiJdKCksIE9iamVjdCh1KSAhPT0gdSkpIHJldHVybjsgfSBmaW5hbGx5IHsgaWYgKG8pIHRocm93IG47IH0gfSByZXR1cm4gYTsgfSB9CmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQpmdW5jdGlvbiBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihvLCBhbGxvd0FycmF5TGlrZSkgeyB2YXIgaXQgPSB0eXBlb2YgU3ltYm9sICE9PSAidW5kZWZpbmVkIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0gfHwgb1siQEBpdGVyYXRvciJdOyBpZiAoIWl0KSB7IGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSB7IGlmIChpdCkgbyA9IGl0OyB2YXIgaSA9IDA7IHZhciBGID0gZnVuY3Rpb24gRigpIHt9OyByZXR1cm4geyBzOiBGLCBuOiBmdW5jdGlvbiBuKCkgeyBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHsgZG9uZTogdHJ1ZSB9OyByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IG9baSsrXSB9OyB9LCBlOiBmdW5jdGlvbiBlKF9lKSB7IHRocm93IF9lOyB9LCBmOiBGIH07IH0gdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9IHZhciBub3JtYWxDb21wbGV0aW9uID0gdHJ1ZSwgZGlkRXJyID0gZmFsc2UsIGVycjsgcmV0dXJuIHsgczogZnVuY3Rpb24gcygpIHsgaXQgPSBpdC5jYWxsKG8pOyB9LCBuOiBmdW5jdGlvbiBuKCkgeyB2YXIgc3RlcCA9IGl0Lm5leHQoKTsgbm9ybWFsQ29tcGxldGlvbiA9IHN0ZXAuZG9uZTsgcmV0dXJuIHN0ZXA7IH0sIGU6IGZ1bmN0aW9uIGUoX2UyKSB7IGRpZEVyciA9IHRydWU7IGVyciA9IF9lMjsgfSwgZjogZnVuY3Rpb24gZigpIHsgdHJ5IHsgaWYgKCFub3JtYWxDb21wbGV0aW9uICYmIGl0WyJyZXR1cm4iXSAhPSBudWxsKSBpdFsicmV0dXJuIl0oKTsgfSBmaW5hbGx5IHsgaWYgKGRpZEVycikgdGhyb3cgZXJyOyB9IH0gfTsgfQpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSBhcnIyW2ldID0gYXJyW2ldOyByZXR1cm4gYXJyMjsgfQpmdW5jdGlvbiBGZWVkKHJvdXRlcikgewogIHZhciBfcmVxdWlyZSA9IHJlcXVpcmUoIi4uL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgICBQYWdlID0gX3JlcXVpcmUuUGFnZSwKICAgIERpc3BsYXkgPSBfcmVxdWlyZS5EaXNwbGF5OwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb250cy5tanMiKSwKICAgIEZvbnRzID0gX3JlcXVpcmUyLkZvbnRzOwogIHZhciBfcmVxdWlyZTMgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyIpLAogICAgQmFja2dyb3VuZCA9IF9yZXF1aXJlMy5CYWNrZ3JvdW5kOwogIHZhciBfcmVxdWlyZTQgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIiksCiAgICBOYXZiYXIgPSBfcmVxdWlyZTQuTmF2YmFyOwogIHZhciBfcmVxdWlyZTUgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9wb3N0Lm1qcyIpLAogICAgUG9zdCA9IF9yZXF1aXJlNS5Qb3N0OwogIHZhciBfcmVxdWlyZTYgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlNi5Jc0xvZ2VkSW47CiAgdmFyIF9yZXF1aXJlNyA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIiksCiAgICBOb3RpZmljYXRpb24gPSBfcmVxdWlyZTcuTm90aWZpY2F0aW9uOwogIHZhciBfcmVxdWlyZTggPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uZXdfcG9zdF9idXR0b24ubWpzIiksCiAgICBOZXdQb3N0QnV0dG9uID0gX3JlcXVpcmU4Lk5ld1Bvc3RCdXR0b247CiAgdmFyIF9yZXF1aXJlOSA9IHJlcXVpcmUoIi4uL3NjcmlwdHMvY29va2llcy5tanMiKSwKICAgIHNldENvb2tpZSA9IF9yZXF1aXJlOS5zZXRDb29raWUsCiAgICBnZXRDb29raWUgPSBfcmVxdWlyZTkuZ2V0Q29va2llLAogICAgY2hlY2tDb29raWUgPSBfcmVxdWlyZTkuY2hlY2tDb29raWU7CiAgaWYgKElzTG9nZWRJbigpID09IGZhbHNlKSB7CiAgICBOb3RpZmljYXRpb24oMSwgIllvdSBuZWVkIHRvIGJlIGxvZ2dlZCBpbiB0byBoYXZlIGEgZmVlZC4iKTsKICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvZXhwbG9yZSIpOwogICAgcmV0dXJuICIiOwogIH0KICB2YXIgZGlzcGxheSA9IG5ldyBEaXNwbGF5KCk7CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiRmVlZCIpOwogIHBhZ2UuY2xlYXIoWyJiYWNrZ3JvdW5kIiwgIm5hdmJhciIsICJmb250cyIsICJuZXdfcG9zdF9idXR0b24iXSk7CiAgRm9udHMocm91dGVyKTsKICBCYWNrZ3JvdW5kKHJvdXRlcik7CiAgTmF2YmFyKHJvdXRlcik7CiAgTmV3UG9zdEJ1dHRvbihyb3V0ZXIpOwogIHBhZ2UuaHRtbCgiXG4gICAgPGRpdiBpZD1cInBvc3QtY29udGFpbmVyXCI+XG4gICAgICA8ZGl2IGlkPVwiZW1wdHlcIj48aXRhbGljPkl0J3MgcHJldHR5IGVtcHR5IGluIHRoZXJlLCB5b3Ugc2hvdWxkIGZvbGxvdyA8c3Ryb25nPjxzcGFuIGlkPVwibWVcIj5tZTwvc3Bhbj48L3N0cm9uZz4gdG8gaGF2ZSBzb21lIGFjdGl2aXR5IDopPC9pdGFsaWM+PC9kaXY+XG4gICAgPC9kaXY+XG4gICAgIik7CiAgcGFnZS5jc3MoIlxuICAgICNtZSB7XG4gICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1xuICAgIH1cbiAgICAjZW1wdHkge1xuICAgICAgZm9udC1mYW1pbHk6ICIuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgIGZvbnQtd2VpZ2h0OiAzMDA7XG4gICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bMF0sICI7XG4gICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgfVxuICAgICNwb3N0LWNvbnRhaW5lciB7XG4gICAgICAgIG1hcmdpbi10b3A6IDcuNSU7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgbWluLWhlaWdodDoxMDAlO1xuICAgICAgICB3aWR0aDoxMDAlO1xuICAgICAgICBoZWlnaHQ6Zml0LWNvbnRlbnQ7XG4gICAgICAgIHRvcDowO1xuICAgICAgICBsZWZ0OjA7XG4gICAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OnN0YXJ0O1xuICAgICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgICAgIGZsZXgtZGlyZWN0aW9uOmNvbHVtbjtcbiAgICB9XG5cbiAgICAjcG9zdC1jb250YWluZXIgcG9zdCB7XG4gICAgICB3aWR0aDo2MCU7XG4gICAgICBoZWlnaHQ6Zml0LWNvbnRlbnQ7XG4gICAgICBtaW4taGVpZ2h0OiA1JTtcbiAgICAgIG1hcmdpbjogMSVcbiAgICB9XG4iKSk7CiAgdmFyIGFwaV91cmwgPSAid3NzOi8vYXBpLmJsb2NrY29pbi5zb2NpYWwiOwogIGlmICh3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT0gIjEyNy4wLjAuMSIgfHwgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09ICJsb2NhbGhvc3QiKSB7CiAgICBhcGlfdXJsID0gIndzOi8vMTI3LjAuMC4xOjgwODAiOwogIH0KICB2YXIgc29ja2V0ID0gbnVsbDsKICBmdW5jdGlvbiBvbl9yZW5kZXIoKSB7CiAgICBzb2NrZXQgPSBuZXcgV2ViU29ja2V0KGFwaV91cmwgKyAnL3Bvc3QnKTsKICAgIHZhciBjYWNoZSA9IG51bGw7CiAgICB2YXIgb2Zmc2V0ID0gMDsKICAgIHZhciBvcGNvZGUgPSA3OwogICAgZnVuY3Rpb24gd2FpdEZvck5vbk51bGxDYWNoZSgpIHsKICAgICAgdmFyIGludGVydmFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAxMDA7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIGZ1bmN0aW9uIGNoZWNrVmFyaWFibGUoKSB7CiAgICAgICAgICBjYWNoZTsKICAgICAgICAgIGlmIChjYWNoZSAhPT0gbnVsbCkgewogICAgICAgICAgICByZXNvbHZlKGNhY2hlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNldFRpbWVvdXQoY2hlY2tWYXJpYWJsZSwgaW50ZXJ2YWwpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjaGVja1ZhcmlhYmxlKCk7CiAgICAgIH0pOwogICAgfQogICAgZnVuY3Rpb24gcGFyc2VjYWNoZSgpIHsKICAgICAgaWYgKGNhY2hlICE9IG51bGwpIHsKICAgICAgICBpZiAoY2FjaGVbIm9wY29kZSJdID09IG9wY29kZSkgewogICAgICAgICAgdmFyIGRhdGFBcnJheSA9IGNhY2hlWyJkYXRhIl07CiAgICAgICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoZGF0YUFycmF5LmVudHJpZXMoKSksCiAgICAgICAgICAgIF9zdGVwOwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICB2YXIgX3N0ZXAkdmFsdWUgPSBfc2xpY2VkVG9BcnJheShfc3RlcC52YWx1ZSwgMiksCiAgICAgICAgICAgICAgICBpbmRleCA9IF9zdGVwJHZhbHVlWzBdLAogICAgICAgICAgICAgICAgdmFsdWUgPSBfc3RlcCR2YWx1ZVsxXTsKICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlbXB0eScpOwogICAgICAgICAgICAgIGlmIChlbGVtZW50ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdmFyIHBvc3QgPSB2YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBwb3N0X2RhdGEgPSBwb3N0WyJkYXRhIl07CiAgICAgICAgICAgICAgICBwb3N0X2RhdGFbInVzZXItaWQiXSA9IHBvc3RbInByb2ZpbGUiXVsiaWQiXTsKICAgICAgICAgICAgICAgIHBvc3RfZGF0YVsidXNlciJdID0gcG9zdFsicHJvZmlsZSJdWyJkaXNwbGF5Il07CiAgICAgICAgICAgICAgICBwb3N0X2RhdGFbInByb2ZpbGUtcGljdHVyZSJdID0gcG9zdFsicHJvZmlsZSJdWyJwcm9maWxlLXBpY3R1cmUiXTsKICAgICAgICAgICAgICAgIHBvc3RfZGF0YVsiYmFkZ2VzIl0gPSBwb3N0WyJwcm9maWxlIl1bImJhZGdlcyJdOwogICAgICAgICAgICAgICAgdmFyIG5ld19wb3N0ID0gbmV3IFBvc3Qocm91dGVyLCBwb3N0X2RhdGEsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwb3N0LWNvbnRhaW5lciIpKTsKICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IiLCBlLnN0YWNrKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciIsIGUubmFtZSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IiLCBlLm1lc3NhZ2UpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpOwogICAgICBjYWNoZSA9IGRhdGE7CiAgICAgIHBhcnNlY2FjaGUoKTsKICAgIH0pOwogICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2Nsb3NlJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoYXBpX3VybCArICcvcG9zdCcpOwogICAgfSk7CiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignb3BlbicsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgJ29wY29kZSc6IG9wY29kZSwKICAgICAgICAnb2Zmc2V0Jzogb2Zmc2V0LAogICAgICAgICJ1c2VyIjogZ2V0Q29va2llKCJ2MS1pZCIpLAogICAgICAgICJ0b2tlbiI6IGdldENvb2tpZSgidjEtdG9rZW4iKQogICAgICB9KSk7CiAgICAgIG9mZnNldCsrOwogICAgfSk7CiAgICB3aW5kb3cub25zY3JvbGwgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzY3JvbGxIZWlnaHQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0OwogICAgICB2YXIgc2Nyb2xsVG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0ICE9PSB1bmRlZmluZWQgPyB3aW5kb3cucGFnZVlPZmZzZXQgOiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IHx8IGRvY3VtZW50LmJvZHkucGFyZW50Tm9kZSB8fCBkb2N1bWVudC5ib2R5KS5zY3JvbGxUb3A7CiAgICAgIHZhciB3aW5kb3dIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7CiAgICAgIGlmIChzY3JvbGxUb3AgKyB3aW5kb3dIZWlnaHQgPj0gc2Nyb2xsSGVpZ2h0KSB7CiAgICAgICAgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgJ29wY29kZSc6IG9wY29kZSwKICAgICAgICAgICdvZmZzZXQnOiBvZmZzZXQsCiAgICAgICAgICAidXNlciI6IGdldENvb2tpZSgidjEtaWQiKSwKICAgICAgICAgICJ0b2tlbiI6IGdldENvb2tpZSgidjEtdG9rZW4iKQogICAgICAgIH0pKTsKICAgICAgICBvZmZzZXQrKzsKICAgICAgICBwYXJzZWNhY2hlKCk7CiAgICAgIH0KICAgIH07CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWUiKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICByb3V0ZXIubmF2aWdhdGVUbygiL3Byb2ZpbGUvM2VvcDUtMDAybGItdjI5MDQtZmNwZnMtYnM5eGYiKTsKICAgIH07CiAgfQogIHBhZ2UuZGVsZXRlX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBkZWxldGUge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCUpO1xuICAgICAgICB9XG4gICAgICAgIDEwMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwJSk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBwYWdlLnNwYXduX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBzcGF3biB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIGZ1bmN0aW9uIG9uX2RlbGV0ZSgpIHsKICAgIHNvY2tldC5jbG9zZSgpOwogIH0KICBwYWdlLm9uX2RlbGV0ZShvbl9kZWxldGUpOwogIHBhZ2Uub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIjoyLCIuLi9lbGVtZW50cy9mb250cy5tanMiOjQsIi4uL2VsZW1lbnRzL25hdmJhci5tanMiOjYsIi4uL2VsZW1lbnRzL25ld19wb3N0X2J1dHRvbi5tanMiOjcsIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIjo4LCIuLi9lbGVtZW50cy9wb3N0Lm1qcyI6OSwiLi4vbGliL0ZyYW1ld29yay5tanMiOjEwLCIuLi9zY3JpcHRzL2FwaS5tanMiOjI5LCIuLi9zY3JpcHRzL2Nvb2tpZXMubWpzIjozMH1dLDE3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkxhbmRpbmcgPSBMYW5kaW5nOwpmdW5jdGlvbiBMYW5kaW5nKHJvdXRlcikgewogIHZhciBfcmVxdWlyZSA9IHJlcXVpcmUoIi4uL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgICBQYWdlID0gX3JlcXVpcmUuUGFnZSwKICAgIERpc3BsYXkgPSBfcmVxdWlyZS5EaXNwbGF5OwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb250cy5tanMiKSwKICAgIEZvbnRzID0gX3JlcXVpcmUyLkZvbnRzOwogIHZhciBfcmVxdWlyZTMgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyIpLAogICAgQmFja2dyb3VuZCA9IF9yZXF1aXJlMy5CYWNrZ3JvdW5kOwogIHZhciBfcmVxdWlyZTQgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIiksCiAgICBOYXZiYXIgPSBfcmVxdWlyZTQuTmF2YmFyOwogIHZhciBfcmVxdWlyZTUgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb290ZXIubWpzIiksCiAgICBGb290ZXIgPSBfcmVxdWlyZTUuRm9vdGVyOwogIHZhciBfcmVxdWlyZTYgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uZXdfcG9zdF9idXR0b24ubWpzIiksCiAgICBOZXdQb3N0QnV0dG9uID0gX3JlcXVpcmU2Lk5ld1Bvc3RCdXR0b247CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiTGFuZGluZyIpOwogIHZhciBkaXNwbGF5ID0gbmV3IERpc3BsYXkoKTsKICBwYWdlLmNsZWFyKFsiYmFja2dyb3VuZCIsICJuYXZiYXIiLCAiZm9udHMiLCAiZm9vdGVyIiwgIm5ld19wb3N0X2J1dHRvbiJdKTsKICBOZXdQb3N0QnV0dG9uKHJvdXRlcik7CiAgRm9udHMocm91dGVyKTsKICBCYWNrZ3JvdW5kKHJvdXRlcik7CiAgTmF2YmFyKHJvdXRlcik7CiAgRm9vdGVyKHJvdXRlcik7CiAgdmFyIGJvcmRlciA9IHBhZ2UuaW1hZ2UoImJvcmRlci5zdmciKTsKICB2YXIgbW9ja3VwID0gcGFnZS5pbWFnZSgiTW9ja3VwLnBuZyIpOwogIHZhciBtb2NrdXBmcm9udCA9IHBhZ2UuaW1hZ2UoIk1vY2t1cEZyb250LnBuZyIpOwogIHBhZ2UuaHRtbCgiXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXJcIiBpZD1cImNvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRleHQgYmlnXCI+V3JpdGUsIFBvc3QsIEVhcm4uPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dCBzbWFsbFwiPkpvaW4gdXMgb24gYSBuZXcgc29jaWFsIGFkdmVudHVyZSB0b2RheSE8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgaWQ9XCJidXR0b25cIj5TaWduLVVwIE5vdzwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lci0yXCIgaWQ9XCJjb250YWluZXItMlwiPlxuICAgICAgICAgICAgPGltZyBpZD1cIm1vY2t1cFwiIHNyYz1cIiIuY29uY2F0KG1vY2t1cCwgIlwiIGFsdD1cIkJsb2NrY29pbiBtb2JpbGUgYXBwIG1vY2t1cC5cIj48L2ltZz5cbiAgICAgICAgPC9kaXY+IFxuICAgICIpKTsKICBwYWdlLmNzcygiXG4gICAgLnRleHQge1xuICAgICAgICBmb250LWZhbWlseTogJyIuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQtYm9sZCJdLCAiO1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bNF0sICI7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgXG4gICAgICAuc21hbGwge1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0LWxpZ2h0Il0sICI7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsxXSwgIjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLmNvbnRhaW5lciB7XG4gICAgICAgIHotaW5kZXg6NTA7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICB0b3A6MDtcbiAgICAgICAgbGVmdDowO1xuICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgIHdpZHRoOiA1MCU7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgZ2FwOiAxMHB4O1xuICAgICAgfVxuICAgICAgOjotd2Via2l0LXNjcm9sbGJhciB7XG4gICAgICAgIHdpZHRoOiAxMHB4O1xuICAgICAgfVxuICAgICAgXG4gICAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHtcbiAgICAgICAgYmFja2dyb3VuZDogbm9uZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7XG4gICAgICAgIGJhY2tncm91bmQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiYmFja2dyb3VuZCIpWyJlbGlwc2UtY29sb3IiXVswXSwgIjtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMzYwcHg7XG4gICAgICB9XG4gICAgICBcbiAgICAgIDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIge1xuICAgICAgICBiYWNrZ3JvdW5kOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImJhY2tncm91bmQiKVsiZWxpcHNlLWNvbG9yIl1bMV0sICI7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC5jb250YWluZXItMiB7XG4gICAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICB0b3A6MDtcbiAgICAgICAgcmlnaHQ6MDtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB3aWR0aDogNTAlO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIHotaW5kZXg6IDQ7XG4gICAgICB9XG4gICAgICBcbiAgICAgICNidXR0b24ge1xuICAgICAgICBib3JkZXItcmFkaXVzOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXItcmFkaXVzIl1bMV0sICI7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmb250LWZhbWlseTogJyIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICInLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0LWxpZ2h0Il0sICI7XG4gICAgICAgIGNvbG9yOiIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bMl0sICI7XG4gICAgICAgIGJhY2tncm91bmQ6IHVybCgiKS5jb25jYXQoYm9yZGVyLCAiKTtcbiAgICAgICAgYm94LXNoYWRvdzogbm9uZTtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICB3aWR0aDogMzYwcHg7XG4gICAgICAgIGhlaWdodDogNzBweDtcbiAgICAgICAgei1pbmRleDoxMDA7XG4gICAgICB9XG5cbiAgICBAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiAxMjcwcHgpe1xuICAgICAgICAgICAgI21vY2t1cCB7XG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHVybCgiKS5jb25jYXQobW9ja3VwZnJvbnQsICIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2NvbnRhaW5lciB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7IFxuICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2NvbnRhaW5lci0yIHtcbiAgICAgICAgICAgICAgICB0b3A6IDUwJTtcbiAgICAgICAgICAgICAgICB3aWR0aDoxMDAlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9vdGVyIHtcbiAgICAgICAgICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG4gICAgICAgICAgICAgIHRvcDoxNTAlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2NvcHkge1xuICAgICAgICAgICAgICB0b3A6MTAwJVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2JsdXIge1xuICAgICAgICAgICAgICBoZWlnaHQ6IDE1MCU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAuZWxpcHNlIHtcbiAgICAgICAgICAgICAgaGVpZ2h0OiA0OHZ3O1xuICAgICAgICAgICAgICB3aWR0aDogNDh2dztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgQG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDogNjUwcHgpe1xuICAgICAgICAgIFxuICAgICAgICAgICAgLmJpZyB7XG4gICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTAuN3Z3O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLnNtYWxsIHtcbiAgICAgICAgICAgICAgZm9udC1zaXplOiA0LjZ2dztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICBAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiA1NTBweCl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICNuYXZiYXIge1xuICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgICBtYXJnaW4tdG9wOiAyMHB4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLmNvbnRhaW5lci0zIHtcbiAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XG4gICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLnRyYW5zLWJ1dHRvbiB7XG4gICAgICAgICAgICAgIHdpZHRoOiAzMCU7XG4gICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAgICNjb3B5IHtcbiAgICAgICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgICAgICB0b3A6MDtcbiAgICAgICAgICAgICAgd2lkdGg6MTAwJTtcbiAgICAgICAgICAgICAgbGVmdDowO1xuICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAuY29udGFpbmVyLWxpbmtzIHtcbiAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDBweDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5jb250YWluZXItdGl0bGVzIHtcbiAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDBweDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvb3RlciB7XG4gICAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICAgICAgICAgIGhlaWdodDogMjAlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLmNvbnRhaW5lci00e1xuICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICAgIGJvdHRvbTogMzAlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICAiKSk7CiAgcGFnZS5kZWxldGVfYW5pbWF0aW9uKCJcbiAgICBAa2V5ZnJhbWVzIGRlbGV0ZSB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwJSk7XG4gICAgICAgIH1cbiAgICAgICAgMTAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMTAlKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIHBhZ2Uuc3Bhd25fYW5pbWF0aW9uKCJcbiAgICBAa2V5ZnJhbWVzIHNwYXduIHtcbiAgICAgICAgMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xMCUpO1xuICAgICAgICB9XG4gICAgICAgIDEwMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOyAvKiBBZGp1c3QgdGhlIGRpc3RhbmNlIHlvdSB3YW50IHRvIG1vdmUgb24gdGhlIHktYXhpcyAqL1xuICAgICAgICB9XG4gICAgICB9XG4gICAgIik7CiAgZnVuY3Rpb24gb25fcmVuZGVyKCkgewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1dHRvbiIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvcmVnaXN0ZXIiKTsKICAgIH07CiAgfQogIHBhZ2Uub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIjoyLCIuLi9lbGVtZW50cy9mb250cy5tanMiOjQsIi4uL2VsZW1lbnRzL2Zvb3Rlci5tanMiOjUsIi4uL2VsZW1lbnRzL25hdmJhci5tanMiOjYsIi4uL2VsZW1lbnRzL25ld19wb3N0X2J1dHRvbi5tanMiOjcsIi4uL2xpYi9GcmFtZXdvcmsubWpzIjoxMH1dLDE4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkxpdmUgPSBMaXZlOwp2YXIgX2Nvb2tpZXMgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2Nvb2tpZXMubWpzIik7CmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSAic3RyaW5nIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09ICJPYmplY3QiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSAiTWFwIiB8fCBuID09PSAiU2V0IikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSAiQXJndW1lbnRzIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH0KZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgYXJyMltpXSA9IGFycltpXTsgcmV0dXJuIGFycjI7IH0KZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KHIsIGwpIHsgdmFyIHQgPSBudWxsID09IHIgPyBudWxsIDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIFN5bWJvbCAmJiByW1N5bWJvbC5pdGVyYXRvcl0gfHwgclsiQEBpdGVyYXRvciJdOyBpZiAobnVsbCAhPSB0KSB7IHZhciBlLCBuLCBpLCB1LCBhID0gW10sIGYgPSAhMCwgbyA9ICExOyB0cnkgeyBpZiAoaSA9ICh0ID0gdC5jYWxsKHIpKS5uZXh0LCAwID09PSBsKSB7IGlmIChPYmplY3QodCkgIT09IHQpIHJldHVybjsgZiA9ICExOyB9IGVsc2UgZm9yICg7ICEoZiA9IChlID0gaS5jYWxsKHQpKS5kb25lKSAmJiAoYS5wdXNoKGUudmFsdWUpLCBhLmxlbmd0aCAhPT0gbCk7IGYgPSAhMCk7IH0gY2F0Y2ggKHIpIHsgbyA9ICEwLCBuID0gcjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFmICYmIG51bGwgIT0gdFsicmV0dXJuIl0gJiYgKHUgPSB0WyJyZXR1cm4iXSgpLCBPYmplY3QodSkgIT09IHUpKSByZXR1cm47IH0gZmluYWxseSB7IGlmIChvKSB0aHJvdyBuOyB9IH0gcmV0dXJuIGE7IH0gfQpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7IH0KZnVuY3Rpb24gTGl2ZShyb3V0ZXIpIHsKICB2YXIgX3JlcXVpcmUgPSByZXF1aXJlKCIuLi9saWIvRnJhbWV3b3JrLm1qcyIpLAogICAgUGFnZSA9IF9yZXF1aXJlLlBhZ2UsCiAgICBEaXNwbGF5ID0gX3JlcXVpcmUuRGlzcGxheTsKICB2YXIgX3JlcXVpcmUyID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvZm9udHMubWpzIiksCiAgICBGb250cyA9IF9yZXF1aXJlMi5Gb250czsKICB2YXIgX3JlcXVpcmUzID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvYmFja2dyb3VuZC5tanMiKSwKICAgIEJhY2tncm91bmQgPSBfcmVxdWlyZTMuQmFja2dyb3VuZDsKICB2YXIgX3JlcXVpcmU0ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvbmF2YmFyLm1qcyIpLAogICAgTmF2YmFyID0gX3JlcXVpcmU0Lk5hdmJhcjsKICB2YXIgX3JlcXVpcmU1ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvcG9zdC5tanMiKSwKICAgIFBvc3QgPSBfcmVxdWlyZTUuUG9zdCwKICAgIExpdmVQb3N0ID0gX3JlcXVpcmU1LkxpdmVQb3N0OwogIHZhciBfcmVxdWlyZTYgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlNi5Jc0xvZ2VkSW47CiAgdmFyIF9yZXF1aXJlNyA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIiksCiAgICBOb3RpZmljYXRpb24gPSBfcmVxdWlyZTcuTm90aWZpY2F0aW9uOwogIHZhciBfcmVxdWlyZTggPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uZXdfcG9zdF9idXR0b24ubWpzIiksCiAgICBOZXdQb3N0QnV0dG9uID0gX3JlcXVpcmU4Lk5ld1Bvc3RCdXR0b247CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiTGl2ZSIpOwogIHZhciBkaXNwbGF5ID0gbmV3IERpc3BsYXkoKTsKICBwYWdlLmNsZWFyKFsiYmFja2dyb3VuZCIsICJuYXZiYXIiLCAiZm9udHMiXSk7CiAgRm9udHMocm91dGVyKTsKICBCYWNrZ3JvdW5kKHJvdXRlcik7CiAgTmF2YmFyKHJvdXRlcik7CiAgcGFnZS5odG1sKCJcbiAgICA8ZGl2IGlkPVwicG9zdC1jb250YWluZXJcIj5cblxuICAgIDwvZGl2PlxuICAgIDxpbnB1dCBjbGFzcz1cInRleHQtaW5wdXRcIiAgaWQ9XCJtZXNzYWdlXCI+PC9pbnB1dD5cbiAgICAiKTsKICBwYWdlLmNzcygiXG4gICAgI3Bvc3QtY29udGFpbmVyIHtcbiAgICAgICAgbWFyZ2luLXRvcDogNy41JTtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICBtaW4taGVpZ2h0OjEwMCU7XG4gICAgICAgIHdpZHRoOjEwMCU7XG4gICAgICAgIGhlaWdodDpmaXQtY29udGVudDtcbiAgICAgICAgdG9wOjA7XG4gICAgICAgIGxlZnQ6MDtcbiAgICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6c3RhcnQ7XG4gICAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246Y29sdW1uO1xuICAgIH1cbiAgICAudGV4dC1pbnB1dCB7XG4gICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoIi5jb25jYXQoZGlzcGxheS5nZXQoImJhY2tncm91bmQiKVsiYmx1ciJdLCAiKTtcbiAgICAgIHdpZHRoOjkwJTtcbiAgICAgIG91dGxpbmU6bm9uZTtcbiAgICAgIGJhY2tncm91bmQ6bm9uZTtcbiAgICAgIGJvcmRlcjpzb2xpZCAxcHggIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICBib3JkZXItcmFkaXVzOiIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJvcmRlci1yYWRpdXMiXVsxXSwgIjtcbiAgICAgIG1pbi1oZWlnaHQ6NTBweDtcbiAgICAgIGZvbnQtZmFtaWx5OiAnIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICBjb2xvcjoiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVszXSwgIjtcbiAgICAgIHRleHQtYWxpZ246bGVmdDtcbiAgICAgIG1hcmdpbi1ib3R0b206MTVweDtcbiAgICAgIHBvc2l0aW9uOmZpeGVkO1xuICAgICAgbGVmdDo1JTtcbiAgICAgIGJvdHRvbTowO1xuICAgIH1cblxuICAgICNwb3N0LWNvbnRhaW5lciBwb3N0IHtcbiAgICAgIHdpZHRoOjYwJTtcbiAgICAgIGhlaWdodDpmaXQtY29udGVudDtcbiAgICAgIG1pbi1oZWlnaHQ6IDUlO1xuICAgICAgbWFyZ2luOiAxJVxuICAgIH1cbiIpKTsKICB2YXIgYXBpX3VybCA9ICJ3c3M6Ly9hcGkuYmxvY2tjb2luLnNvY2lhbCI7CiAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PSAiMTI3LjAuMC4xIiB8fCB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT0gImxvY2FsaG9zdCIpIHsKICAgIGFwaV91cmwgPSAid3M6Ly8xMjcuMC4wLjE6ODA4MCI7CiAgfQogIHZhciBzb2NrZXQgPSBudWxsOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoYXBpX3VybCArICcvcG9zdCcpOwogICAgdmFyIGNhY2hlID0gW107CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWVzc2FnZSIpLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInKSB7CiAgICAgICAgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgJ29wY29kZSc6IDYsCiAgICAgICAgICAndHlwZSc6IDMsCiAgICAgICAgICAndXNlcic6ICgwLCBfY29va2llcy5nZXRDb29raWUpKCJ2MS1pZCIpLAogICAgICAgICAgJ3Rva2VuJzogKDAsIF9jb29raWVzLmdldENvb2tpZSkoInYxLXRva2VuIiksCiAgICAgICAgICAnbWVzc2FnZSc6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtZXNzYWdlIikudmFsdWUKICAgICAgICB9KSk7CiAgICAgIH0KICAgIH0pOwogICAgZnVuY3Rpb24gd2FpdEZvck5vbk51bGxDYWNoZSgpIHsKICAgICAgdmFyIGludGVydmFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAxMDA7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIGZ1bmN0aW9uIGNoZWNrVmFyaWFibGUoKSB7CiAgICAgICAgICBjYWNoZTsKICAgICAgICAgIGlmIChjYWNoZSAhPT0gbnVsbCkgewogICAgICAgICAgICByZXNvbHZlKGNhY2hlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNldFRpbWVvdXQoY2hlY2tWYXJpYWJsZSwgaW50ZXJ2YWwpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjaGVja1ZhcmlhYmxlKCk7CiAgICAgIH0pOwogICAgfQogICAgZnVuY3Rpb24gcGFyc2VjYWNoZSgpIHsKICAgICAgaWYgKGNhY2hlICE9IG51bGwpIHsKICAgICAgICBpZiAoY2FjaGVbIm9wY29kZSJdID09IDYgJiYgY2FjaGVbInR5cGUiXSA9PSAyKSB7CiAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9PYmplY3QkZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKGNhY2hlWyJkYXRhIl0pOyBfaSA8IF9PYmplY3QkZW50cmllcy5sZW5ndGg7IF9pKyspIHsKICAgICAgICAgICAgdmFyIF9PYmplY3QkZW50cmllcyRfaSA9IF9zbGljZWRUb0FycmF5KF9PYmplY3QkZW50cmllc1tfaV0sIDIpLAogICAgICAgICAgICAgIGtleSA9IF9PYmplY3QkZW50cmllcyRfaVswXSwKICAgICAgICAgICAgICB2YWx1ZSA9IF9PYmplY3QkZW50cmllcyRfaVsxXTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICB2YXIgcG9zdCA9IHZhbHVlOwogICAgICAgICAgICAgIHZhciBwb3N0X2RhdGEgPSBwb3N0WyJkYXRhIl07CiAgICAgICAgICAgICAgcG9zdF9kYXRhWyJ1c2VyLWlkIl0gPSBwb3N0WyJwcm9maWxlIl1bImlkIl07CiAgICAgICAgICAgICAgcG9zdF9kYXRhWyJ1c2VyIl0gPSBwb3N0WyJwcm9maWxlIl1bImRpc3BsYXkiXTsKICAgICAgICAgICAgICBwb3N0X2RhdGFbInByb2ZpbGUtcGljdHVyZSJdID0gcG9zdFsicHJvZmlsZSJdWyJwcm9maWxlLXBpY3R1cmUiXTsKICAgICAgICAgICAgICBwb3N0X2RhdGFbImJhZGdlcyJdID0gcG9zdFsicHJvZmlsZSJdWyJiYWRnZXMiXTsKICAgICAgICAgICAgICB2YXIgbmV3X3Bvc3QgPSBuZXcgTGl2ZVBvc3Qocm91dGVyLCBwb3N0X2RhdGEsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwb3N0LWNvbnRhaW5lciIpKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciIsIGUuc3RhY2spOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciIsIGUubmFtZSk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIiwgZS5tZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpOwogICAgICBjYWNoZSA9IGRhdGE7CiAgICAgIHBhcnNlY2FjaGUoKTsKICAgIH0pOwogICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2Nsb3NlJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoYXBpX3VybCArICcvcG9zdCcpOwogICAgfSk7CiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignb3BlbicsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgJ29wY29kZSc6IDYsCiAgICAgICAgJ3R5cGUnOiAxLAogICAgICAgICd1c2VyJzogKDAsIF9jb29raWVzLmdldENvb2tpZSkoInYxLWlkIiksCiAgICAgICAgJ3Rva2VuJzogKDAsIF9jb29raWVzLmdldENvb2tpZSkoInYxLXRva2VuIikKICAgICAgfSkpOwogICAgICB3YWl0Rm9yTm9uTnVsbENhY2hlKCkudGhlbihmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICBwYXJzZWNhY2hlKCk7CiAgICAgIH0pOwogICAgfSk7CiAgfQogIDsKICBwYWdlLmRlbGV0ZV9hbmltYXRpb24oIlxuICAgIEBrZXlmcmFtZXMgZGVsZXRlIHtcbiAgICAgICAgMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxMCUpOyAvKiBBZGp1c3QgdGhlIGRpc3RhbmNlIHlvdSB3YW50IHRvIG1vdmUgb24gdGhlIHktYXhpcyAqL1xuICAgICAgICB9XG4gICAgICB9XG4gICAgIik7CiAgcGFnZS5zcGF3bl9hbmltYXRpb24oIlxuICAgIEBrZXlmcmFtZXMgc3Bhd24ge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwJSk7XG4gICAgICAgIH1cbiAgICAgICAgMTAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBmdW5jdGlvbiBvbl9kZWxldGUoKSB7CiAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICdvcGNvZGUnOiA2LAogICAgICAndHlwZSc6IDQsCiAgICAgICd1c2VyJzogKDAsIF9jb29raWVzLmdldENvb2tpZSkoInYxLWlkIiksCiAgICAgICd0b2tlbic6ICgwLCBfY29va2llcy5nZXRDb29raWUpKCJ2MS10b2tlbiIpCiAgICB9KSk7CiAgICBzb2NrZXQuY2xvc2UoKTsKICB9CiAgcGFnZS5vbl9kZWxldGUob25fZGVsZXRlKTsKICBwYWdlLm9uX3JlbmRlcihvbl9yZW5kZXIpOwogIHBhZ2UucmVuZGVyKCk7Cn0KCn0seyIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyI6MiwiLi4vZWxlbWVudHMvZm9udHMubWpzIjo0LCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIjo2LCIuLi9lbGVtZW50cy9uZXdfcG9zdF9idXR0b24ubWpzIjo3LCIuLi9lbGVtZW50cy9ub3RpZmljYXRpb25zLm1qcyI6OCwiLi4vZWxlbWVudHMvcG9zdC5tanMiOjksIi4uL2xpYi9GcmFtZXdvcmsubWpzIjoxMCwiLi4vc2NyaXB0cy9hcGkubWpzIjoyOSwiLi4vc2NyaXB0cy9jb29raWVzLm1qcyI6MzB9XSwxOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5Mb2dpbiA9IExvZ2luOwpmdW5jdGlvbiBMb2dpbihyb3V0ZXIpIHsKICB2YXIgX3JlcXVpcmUgPSByZXF1aXJlKCIuLi9saWIvRnJhbWV3b3JrLm1qcyIpLAogICAgUGFnZSA9IF9yZXF1aXJlLlBhZ2UsCiAgICBEaXNwbGF5ID0gX3JlcXVpcmUuRGlzcGxheTsKICB2YXIgX3JlcXVpcmUyID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvZm9udHMubWpzIiksCiAgICBGb250cyA9IF9yZXF1aXJlMi5Gb250czsKICB2YXIgX3JlcXVpcmUzID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvYmFja2dyb3VuZC5tanMiKSwKICAgIEJhY2tncm91bmQgPSBfcmVxdWlyZTMuQmFja2dyb3VuZDsKICB2YXIgX3JlcXVpcmU0ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvbmF2YmFyLm1qcyIpLAogICAgTmF2YmFyID0gX3JlcXVpcmU0Lk5hdmJhcjsKICB2YXIgX3JlcXVpcmU1ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvZm9vdGVyLm1qcyIpLAogICAgRm9vdGVyID0gX3JlcXVpcmU1LkZvb3RlcjsKICB2YXIgX3JlcXVpcmU2ID0gcmVxdWlyZSgiLi4vc2NyaXB0cy9hcGkubWpzIiksCiAgICBMb2dpbiA9IF9yZXF1aXJlNi5Mb2dpbjsKICB2YXIgX3JlcXVpcmU3ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvbm90aWZpY2F0aW9ucy5tanMiKSwKICAgIE5vdGlmaWNhdGlvbiA9IF9yZXF1aXJlNy5Ob3RpZmljYXRpb247CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiTG9naW4iKTsKICB2YXIgZGlzcGxheSA9IG5ldyBEaXNwbGF5KCk7CiAgdmFyIGJsYW5rX2xvZ28gPSBwYWdlLmltYWdlKCJsb2dvX2JsYW5rLnN2ZyIpOwogIHZhciBsb2dpbl9idXR0b24gPSBwYWdlLmltYWdlKCJsb2dpbl9idXR0b24uc3ZnIik7CiAgcGFnZS5jbGVhcihbImJhY2tncm91bmQiLCAibmF2YmFyIiwgImZvbnRzIiwgImZvb3RlciJdKTsKICBGb250cyhyb3V0ZXIpOwogIEJhY2tncm91bmQocm91dGVyKTsKICBOYXZiYXIocm91dGVyKTsKICBGb290ZXIocm91dGVyKTsKICBwYWdlLmh0bWwoIlxuICAgIDxzY3JpcHQgc3JjPVwiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9yZWNhcHRjaGEvYXBpLmpzP3JlbmRlcj02TGYxbjRJb0FBQUFBRVhGRWVsMUJma3hIcmN1ekpVSk5mUGlGQTNxXCI+PC9zY3JpcHQ+XG4gICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPlxuICAgICAgICA8aW1nIHNyYz1cIiIuY29uY2F0KGJsYW5rX2xvZ28sICJcIiBhbHQ9XCJBIHdoaXRlIHZlcnNpb24gb2YgdGhlIGJsb2NrY29pbiBsb2dvLlwiPjwvaW1nPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dFwiPldyaXRlLCBQb3N0LCBFYXJuLjwvZGl2PlxuICAgIDwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXItMlwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dCBzbWFsbFwiPkxvZ2luPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIj5hY2NvdW50X2NpcmNsZTwvc3Bhbj5cbiAgICAgICAgICAgIDxpbnB1dCBwbGFjZWhvbGRlcj1cIlVzZXJuYW1lXCIgaWQ9XCJ1c2VybmFtZVwiIHR5cGU9XCJ0ZXh0XCI+PC9pbnB1dD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIj5wYXNzd29yZDwvc3Bhbj5cbiAgICAgICAgICAgIDxpbnB1dCBwbGFjZWhvbGRlcj1cIlBhc3N3b3JkXCIgaWQ9XCJwYXNzd29yZFwiIHR5cGU9XCJwYXNzd29yZFwiPjwvaW5wdXQ+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8aW1nIHNyYz1cIiIpLmNvbmNhdChsb2dpbl9idXR0b24sICJcIiBhbHQ9XCJUaGUgbG9naW4gYnV0dG9uXCIgaWQ9XCJMb2dpblwiPjwvaW1nPlxuICAgICAgICA8YnV0dG9uIGlkPVwiUmVnaXN0ZXJcIj5PciBSZWdpc3RlcjwvYnV0dG9uPlxuICAgICAgICBcbiAgICAgICAgPGRpdiBjbGFzcz1cInRleHQgdmVyeS1zbWFsbFwiPlRoaXMgc2l0ZSBpcyBwcm90ZWN0ZWQgYnkgcmVDQVBUQ0hBLiA8YnI+VGhlIEdvb2dsZVxuICAgICAgICA8YSBocmVmPVwiaHR0cHM6Ly9wb2xpY2llcy5nb29nbGUuY29tL3ByaXZhY3lcIiBjbGFzcz1cImctbGlua1wiPlByaXZhY3kgUG9saWN5PC9hPiBhbmRcbiAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vcG9saWNpZXMuZ29vZ2xlLmNvbS90ZXJtc1wiIGNsYXNzPVwiZy1saW5rXCI+VGVybXMgb2YgU2VydmljZTwvYT4gYXBwbHkuPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgIikpOwogIHBhZ2UuY3NzKCJcbiAgICAuZy1saW5rIHtcbiAgICAgIGNvbG9yOiAiLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgIH0gXG5cbiAgICAudGV4dCB7XG4gICAgICAgIGZvbnQtZmFtaWx5OiAnIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIicsIHNhbnMtc2VyaWY7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQtYm9sZCJdLCAiO1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bNF0sICI7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgXG4gICAgICAuc21hbGwge1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0LWxpZ2h0Il0sICI7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsxXSwgIjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLnZlcnktc21hbGwge1xuICAgICAgICBtYXJnaW46MSU7XG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgZm9udC1zaXplOiAxNXB4O1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0LWxpZ2h0Il0sICI7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLmNvbnRhaW5lciB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICB0b3A6MDtcbiAgICAgICAgbGVmdDowO1xuICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgIHdpZHRoOiA1MCU7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgei1pbmRleDogNDtcbiAgICAgICAgZ2FwOiAxMHB4O1xuICAgICAgfVxuICAgICAgOjotd2Via2l0LXNjcm9sbGJhciB7XG4gICAgICAgIHdpZHRoOiAxMHB4O1xuICAgICAgfVxuICAgICAgXG4gICAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHtcbiAgICAgICAgYmFja2dyb3VuZDogbm9uZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7XG4gICAgICAgIGJhY2tncm91bmQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiYmFja2dyb3VuZCIpWyJlbGlwc2UtY29sb3IiXVswXSwgIjtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMzYwcHg7XG4gICAgICB9XG4gICAgICBcbiAgICAgIDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIge1xuICAgICAgICBiYWNrZ3JvdW5kOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImJhY2tncm91bmQiKVsiZWxpcHNlLWNvbG9yIl1bMV0sICI7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC5jb250YWluZXItMiB7XG4gICAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICB0b3A6MDtcbiAgICAgICAgcmlnaHQ6MDtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB3aWR0aDogNTAlO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIHotaW5kZXg6IDQ7XG4gICAgICB9XG4gICAgICBcbiAgICAgICNidXR0b24ge1xuICAgICAgICBib3JkZXItcmFkaXVzOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXItcmFkaXVzIl1bMV0sICI7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmb250LWZhbWlseTogJyIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICInLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0LWxpZ2h0Il0sICI7XG4gICAgICAgIGNvbG9yOiIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bM10sICI7XG4gICAgICAgIGJhY2tncm91bmQ6IHVybChib3JkZXIuc3ZnKTtcbiAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgICBib3gtc2hhZG93OiBub25lO1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIHdpZHRoOiAzNjBweDtcbiAgICAgICAgaGVpZ2h0OiA3MHB4O1xuICAgICAgfVxuICAgICAgLmZvcm0ge1xuICAgICAgICB3aWR0aDogMzc1cHg7XG4gICAgICAgIGhlaWdodDogNTVweDtcbiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC5mb3JtIHNwYW57XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzNdLCAiO1xuICAgICAgfVxuICAgICAgXG4gICAgICAuZm9ybSBpbnB1dHtcbiAgICAgICAgYmFja2dyb3VuZDogbm9uZTtcbiAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVswXSwgIjtcbiAgICAgICAgd2lkdGg6IDgwJTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLmZvcm0gaW5wdXQ6Zm9jdXMge1xuICAgICAgICBvdXRsaW5lOm5vbmUhaW1wb3J0YW50O1xuICAgICAgfVxuICAgICAgXG4gICAgICA6OnBsYWNlaG9sZGVyIHtcbiAgICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgfVxuICAgICAgXG4gICAgICBwe2NvbG9yOiIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAifVxuICAgICAgXG4gICAgICAjTG9naW4ge1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIG1hcmdpbi10b3A6IDMwcHg7XG4gICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgICAgd2lkdGg6IDMzMHB4O1xuICAgICAgICBoZWlnaHQ6IDUzcHg7XG4gICAgICB9XG4gICAgICBcbiAgICAgICNSZWdpc3RlciB7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgYmFja2dyb3VuZDogbm9uZTtcbiAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgICBmb250LWZhbWlseTogJyIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICInLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0LWxpZ2h0Il0sICI7XG4gICAgICAgIGNvbG9yOiIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bMV0sICI7XG4gICAgICAgIG1hcmdpbi10b3A6IDVweDtcbiAgICAgIH1cbiAgICAgIEBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDEyNzBweCl7XG4gICAgICAgICNtb2NrdXAge1xuICAgICAgICAgIGNvbnRlbnQ6IHVybChNb2NrdXBGcm9udC5wbmcpO1xuICAgICAgICB9XG4gICAgICAgIC5jb250YWluZXIge1xuICAgICAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgICAgICAgd2lkdGg6IDEwMCU7IFxuICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgfVxuICAgICAgICAuY29udGFpbmVyLTIge1xuICAgICAgICAgIHdpZHRoOjEwMCU7XG4gICAgICAgIH1cbiAgICAgICAgZm9vdGVyIHtcbiAgICAgICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICAgICAgICB0b3A6MTUwJTtcbiAgICAgICAgfVxuICAgICAgICAjY29weSB7XG4gICAgICAgICAgdG9wOjEwMCVcbiAgICAgICAgfVxuICAgICAgICAuZWxpcHNlIHtcbiAgICAgICAgICBoZWlnaHQ6IDQ4dnc7XG4gICAgICAgICAgd2lkdGg6IDQ4dnc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgQG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDogNjUwcHgpe1xuICAgICAgXG4gICAgICAgIC5iaWcge1xuICAgICAgICAgIGZvbnQtc2l6ZTogMTAuN3Z3O1xuICAgICAgICB9XG4gICAgICAgIC5zbWFsbCB7XG4gICAgICAgICAgZm9udC1zaXplOiA0LjZ2dztcbiAgICAgICAgfVxuICAgICAgXG4gICAgICB9XG4gICAgICBcbiAgICAgIEBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDU1MHB4KXtcbiAgICAgIFxuICAgICAgICAjbmF2YmFyIHtcbiAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICAgICAgbWFyZ2luLXRvcDogMjBweDtcbiAgICAgICAgfVxuICAgICAgICAuY29udGFpbmVyLTMge1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XG4gICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgfVxuICAgICAgICAudHJhbnMtYnV0dG9uIHtcbiAgICAgICAgICB3aWR0aDogMzAlO1xuICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgfVxuICAgICAgXG4gICAgICAgICNjb3B5IHtcbiAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgdG9wOjA7XG4gICAgICAgICAgd2lkdGg6MTAwJTtcbiAgICAgICAgICBsZWZ0OjA7XG4gICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICB9XG4gICAgICAgIC5jb250YWluZXItbGlua3Mge1xuICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgIG1hcmdpbi1ib3R0b206IDBweDtcbiAgICAgICAgfVxuICAgICAgICAuY29udGFpbmVyLXRpdGxlcyB7XG4gICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgbWFyZ2luLWJvdHRvbTogMHB4O1xuICAgICAgICB9XG4gICAgICAgIGZvb3RlciB7XG4gICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgICBoZWlnaHQ6IDIwJTtcbiAgICAgICAgfVxuICAgICAgICAuY29udGFpbmVyLTR7XG4gICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgIGJvdHRvbTogMzAlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgIikpOwogIHBhZ2UuZGVsZXRlX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBkZWxldGUge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCUpO1xuICAgICAgICB9XG4gICAgICAgIDEwMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwJSk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBwYWdlLnNwYXduX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBzcGF3biB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJSZWdpc3RlciIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvcmVnaXN0ZXIiKTsKICAgIH07CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTG9naW4iKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICBncmVjYXB0Y2hhLnJlYWR5KGZ1bmN0aW9uICgpIHsKICAgICAgICBncmVjYXB0Y2hhLmV4ZWN1dGUoJzZMZjFuNElvQUFBQUFFWEZFZWwxQmZreEhyY3V6SlVKTmZQaUZBM3EnLCB7CiAgICAgICAgICBhY3Rpb246ICdzdWJtaXQnCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAodG9rZW4pIHsKICAgICAgICAgIExvZ2luKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZScpLnZhbHVlLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmQnKS52YWx1ZSwgdG9rZW4pLnRoZW4oZnVuY3Rpb24gKHN1Y2Nlc3MpIHsKICAgICAgICAgICAgaWYgKHN1Y2Nlc3MgPT0gdHJ1ZSkgewogICAgICAgICAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvZXhwbG9yZSIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIE5vdGlmaWNhdGlvbigxLCBzdWNjZXNzKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGR1cmluZyBsb2dpbjoiLCBlcnJvcik7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KICBwYWdlLm9uX3JlbmRlcihvbl9yZW5kZXIpOwogIHBhZ2UucmVuZGVyKCk7Cn0KCn0seyIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyI6MiwiLi4vZWxlbWVudHMvZm9udHMubWpzIjo0LCIuLi9lbGVtZW50cy9mb290ZXIubWpzIjo1LCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIjo2LCIuLi9lbGVtZW50cy9ub3RpZmljYXRpb25zLm1qcyI6OCwiLi4vbGliL0ZyYW1ld29yay5tanMiOjEwLCIuLi9zY3JpcHRzL2FwaS5tanMiOjI5fV0sMjA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuTWFpbnRlbmFuY2UgPSBNYWludGVuYW5jZTsKZnVuY3Rpb24gTWFpbnRlbmFuY2Uocm91dGVyKSB7CiAgdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiLi4vbGliL0ZyYW1ld29yay5tanMiKSwKICAgIFBhZ2UgPSBfcmVxdWlyZS5QYWdlLAogICAgRGlzcGxheSA9IF9yZXF1aXJlLkRpc3BsYXk7CiAgdmFyIF9yZXF1aXJlMiA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL2ZvbnRzLm1qcyIpLAogICAgRm9udHMgPSBfcmVxdWlyZTIuRm9udHM7CiAgdmFyIF9yZXF1aXJlMyA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIiksCiAgICBCYWNrZ3JvdW5kID0gX3JlcXVpcmUzLkJhY2tncm91bmQ7CiAgdmFyIF9yZXF1aXJlNCA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25hdmJhci5tanMiKSwKICAgIE5hdmJhciA9IF9yZXF1aXJlNC5OYXZiYXI7CiAgdmFyIF9yZXF1aXJlNSA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL2Zvb3Rlci5tanMiKSwKICAgIEZvb3RlciA9IF9yZXF1aXJlNS5Gb290ZXI7CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiTWFpbnRlbmFuY2UiKTsKICB2YXIgZGlzcGxheSA9IG5ldyBEaXNwbGF5KCk7CiAgcGFnZS5jbGVhcihbImJhY2tncm91bmQiLCAiZm9udHMiXSk7CiAgRm9udHMocm91dGVyKTsKICBCYWNrZ3JvdW5kKHJvdXRlcik7CiAgcGFnZS5odG1sKCI8ZGl2IGlkPVwiY2VudGVyLWNvbnRhaW5cIj5cbiAgICAgICAgPGRpdiBpZD1cImVycm9yLWNvZGVcIj4gXHVEODNFXHVERDJCIDwvZGl2PlxuICAgICAgICA8aDM+QmxvY2tDb2luIGlzIGN1cnJlbnRseSB1bmRlciBtYWludGVuYW5jZSwgd2UgYXJlIHNvcnJ5IGZvciB0aGUgaW5jb252ZW5pZW5jZS48L2gzPlxuICAgICAgICA8YSBjbGFzcz1cImJ1dHRvblwiIGlkPVwibWFpbi1tZW51XCI+Q2hlY2sgdGhlIGRpc2NvcmQgZm9yIG5ld3MuPC9hPlxuICAgIDwvZGl2PiIpOwogIHBhZ2UuY3NzKCJcbiAgICAjY2VudGVyLWNvbnRhaW4ge1xuICAgICAgICB6LWluZGV4OiAiLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbInotaW5kZXgiXVswXSwgIjtcbiAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG4gICAgICAgIHRvcDowO1xuICAgICAgICBsZWZ0OjA7XG4gICAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIH1cblxuICAgICNlcnJvci1jb2RlIHtcbiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICBmb250LWZhbWlseTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzVdLCAiO1xuICAgICAgICBmb250LXN0eWxlOiBub3JtYWw7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQtYm9sZCJdLCAiO1xuICAgICAgICBsaW5lLWhlaWdodDogbm9ybWFsO1xuICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTQ5ZGVnLCAiKS5jb25jYXQoZGlzcGxheS5nZXQoImJhY2tncm91bmQiKVsiZWxpcHNlLWNvbG9yIl1bMF0sICIgMCUsICIpLmNvbmNhdChkaXNwbGF5LmdldCgiYmFja2dyb3VuZCIpWyJlbGlwc2UtY29sb3IiXVsxXSwgIiAxMDAlKTtcbiAgICAgICAgLXdlYmtpdC1iYWNrZ3JvdW5kLWNsaXA6IHRleHQ7XG4gICAgICAgIGNvbG9yOiB0cmFuc3BhcmVudDtcbiAgICB9XG5cbiAgICBoMyB7XG4gICAgICAgIGZvbnQtZmFtaWx5OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodCJdLCAiO1xuICAgIH1cblxuICAgIC5idXR0b24ge1xuICAgICAgcG9zaXRpb246cmVsYXRpdmU7XG4gICAgICBjdXJzb3I6cG9pbnRlcjtcbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIGZvbnQtZmFtaWx5OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzNdLCAiO1xuICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodCJdLCAiO1xuICAgICAgei1pbmRleDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiei1pbmRleCJdWzFdLCAiO1xuICAgICAgdGV4dC1kZWNvcmF0aW9uOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiYnV0dG9uLWRlY29yYXRpb24iXSwgIjtcbiAgICB9XG5cbiAgICAjbWFpbi1tZW51IHtcbiAgICAgIHBvc2l0aW9uOnJlbGF0aXZlO1xuICAgICAgY3Vyc29yOnBvaW50ZXI7XG4gICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICBmb250LWZhbWlseTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVszXSwgIjtcbiAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQiXSwgIjtcbiAgICAgIHotaW5kZXg6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbInotaW5kZXgiXVsxXSwgIjtcbiAgICB9XG5cbiAgICBhIHtcbiAgICAgICAgY3Vyc29yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsibGluay1jdXJzb3IiXSwgIjtcbiAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsibGluay1kZWNvcmF0aW9uIl0sICI7XG4gICAgfVxuIikpOwogIHBhZ2UuZGVsZXRlX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBkZWxldGUge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCUpO1xuICAgICAgICB9XG4gICAgICAgIDEwMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwJSk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBwYWdlLnNwYXduX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBzcGF3biB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtYWluLW1lbnUiKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICByb3V0ZXIubmF2aWdhdGVUbygiL2Rpc2NvcmQiKTsKICAgIH07CiAgfQogIHBhZ2Uub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIjoyLCIuLi9lbGVtZW50cy9mb250cy5tanMiOjQsIi4uL2VsZW1lbnRzL2Zvb3Rlci5tanMiOjUsIi4uL2VsZW1lbnRzL25hdmJhci5tanMiOjYsIi4uL2xpYi9GcmFtZXdvcmsubWpzIjoxMH1dLDIxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk5ld0NvbW1lbnQgPSBOZXdDb21tZW50OwpmdW5jdGlvbiBOZXdDb21tZW50KHJvdXRlcikgewogIHZhciBfcmVxdWlyZSA9IHJlcXVpcmUoIi4uL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgICBQYWdlID0gX3JlcXVpcmUuUGFnZSwKICAgIERpc3BsYXkgPSBfcmVxdWlyZS5EaXNwbGF5OwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb250cy5tanMiKSwKICAgIEZvbnRzID0gX3JlcXVpcmUyLkZvbnRzOwogIHZhciBfcmVxdWlyZTMgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyIpLAogICAgQmFja2dyb3VuZCA9IF9yZXF1aXJlMy5CYWNrZ3JvdW5kOwogIHZhciBfcmVxdWlyZTQgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIiksCiAgICBOYXZiYXIgPSBfcmVxdWlyZTQuTmF2YmFyOwogIHZhciBfcmVxdWlyZTUgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlNS5Jc0xvZ2VkSW4sCiAgICBDcmVhdGVDb21tZW50ID0gX3JlcXVpcmU1LkNyZWF0ZUNvbW1lbnQ7CiAgdmFyIF9yZXF1aXJlNiA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIiksCiAgICBOb3RpZmljYXRpb24gPSBfcmVxdWlyZTYuTm90aWZpY2F0aW9uOwogIGlmIChJc0xvZ2VkSW4oKSA9PSBmYWxzZSkgewogICAgTm90aWZpY2F0aW9uKDEsICJZb3UgbmVlZCB0byBiZSBsb2dnZWQgaW4gdG8gY3JlYXRlIGEgY29tbWVudC4iKTsKICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvZXhwbG9yZSIpOwogICAgcmV0dXJuICIiOwogIH0KICB2YXIgZGlzcGxheSA9IG5ldyBEaXNwbGF5KCk7CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiTmV3Q29tbWVudCIpOwogIHBhZ2UuY2xlYXIoWyJiYWNrZ3JvdW5kIiwgIm5hdmJhciIsICJmb250cyJdKTsKICBGb250cyhyb3V0ZXIpOwogIEJhY2tncm91bmQocm91dGVyKTsKICBOYXZiYXIocm91dGVyKTsKICB2YXIgcG9zdF9idXR0b24gPSBwYWdlLmltYWdlKCJuZXdfY29tbWVudC5zdmciKTsKICBwYWdlLmh0bWwoIlxuICAgICAgPGRpdiBpZD1cImNvbnRhaW5lclwiPlxuICAgICAgICA8ZGl2IGlkPVwibmV3LWNvbnRhaW5lclwiPlxuICAgICAgICAgIDxkaXYgaWQ9XCJuZXctaW5wdXRcIiA+XG4gICAgICAgICAgICA8ZGl2IGlkPVwiY2hhci1jb3VudFwiPjAvMjUwPC9kaXY+XG4gICAgICAgICAgICA8cCBjb250ZW50ZWRpdGFibGU9XCJ0cnVlXCIgbWF4bGVuZ3RoPTI0OSBwbGFjZWhvbGRlcj1cIkVudGVyIHRleHQgaGVyZS4uLlwiIGlkPVwibmV3LWlucHV0LXBhcmFcIj48L3A+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBpZD1cImJ1dHRvbi1jb250YWluZXJcIj5cbiAgICAgICAgICAgIDxpbWcgaWQ9XCJwb3N0LWJ1dHRvblwiIHNyYz1cIiIuY29uY2F0KHBvc3RfYnV0dG9uLCAiXCIgLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAiKSk7CiAgcGFnZS5jc3MoIlxuICAgICNwb3N0LWJ1dHRvbiB7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICB9XG4gICAgLm9wdGlvbi1iZyB7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6ICIuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyLXJhZGl1cyJdWzBdLCAiO1xuICAgICAgICBib3JkZXI6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJvcmRlciJdLCAiO1xuICAgICAgICBoZWlnaHQ6IDMwJTtcbiAgICAgICAgd2lkdGg6IDgwJTtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBtYXJnaW4tYm90dG9tOiAxJTtcbiAgICAgICAgYmFja2dyb3VuZDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYmFja2dyb3VuZCJdLCAiO1xuICAgIH1cbiAgICAub3B0aW9uLWlucHV0IHtcbiAgICAgICAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICBib3JkZXItdG9wOiBub25lO1xuICAgICAgICBib3JkZXItcmlnaHQ6IG5vbmU7XG4gICAgICAgIGJvcmRlci1sZWZ0OiBub25lO1xuICAgICAgICBtYXJnaW46IDUlO1xuICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgICAgICAgd2lkdGg6IDYwcHg7XG4gICAgICAgIGhlaWdodDogMzRweDtcbiAgICAgICAgYmFja2dyb3VuZDogbm9uZTtcbiAgICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0O1xuICAgICAgICBmb250LWZhbWlseTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzFdLCAiO1xuICAgICAgICBmb250LXN0eWxlOiBub3JtYWw7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQiXSwgIjtcbiAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDtcbiAgICB9XG4gICAgLm9wdGlvbi10aXRsZSB7XG4gICAgICAgIG1hcmdpbjogNSU7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgZm9udC1mYW1pbHk6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICIsIHNhbnMtc2VyaWY7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsyXSwgIjtcbiAgICAgICAgZm9udC1zdHlsZTogbm9ybWFsO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGxpbmUtaGVpZ2h0OiBub3JtYWw7XG4gICAgfVxuICAgICNjaGFyLWNvdW50IHtcbiAgICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICBmb250LWZhbWlseTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzBdLCAiO1xuICAgICAgICBmb250LXN0eWxlOiBub3JtYWw7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQiXSwgIjtcbiAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDtcbiAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICB9XG4gICAgI29wdGlvbi1jb250YWluZXIge1xuICAgICAgICBoZWlnaHQ6IDMwJTtcbiAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICBiYWNrZ3JvdW5kOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJiYWNrZ3JvdW5kIl0sICI7XG4gICAgfVxuICAgICNjb250YWluZXIge1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB0b3A6IDA7XG4gICAgICAgIGxlZnQ6IDA7XG4gICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgfVxuXG4gICAgLnN3aXRjaCB7XG4gICAgICAgIG1hcmdpbjogNSU7XG4gICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICB3aWR0aDogNjBweDtcbiAgICAgICAgaGVpZ2h0OiAzNHB4O1xuICAgIH1cbiAgICBcbiAgICAuc3dpdGNoIGlucHV0IHtcbiAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgd2lkdGg6IDA7XG4gICAgICAgIGhlaWdodDogMDtcbiAgICB9XG4gICAgXG4gICAgLnNsaWRlciB7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICB0b3A6IDA7XG4gICAgICAgIGxlZnQ6IDA7XG4gICAgICAgIHJpZ2h0OiAwO1xuICAgICAgICBib3R0b206IDA7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJhY2tncm91bmQiXSwgIjtcbiAgICAgICAgLXdlYmtpdC10cmFuc2l0aW9uOiAuNHM7XG4gICAgICAgIHRyYW5zaXRpb246IC40cztcbiAgICB9XG4gICAgXG4gICAgLnNsaWRlcjpiZWZvcmUge1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIGNvbnRlbnQ6IFwiXCI7XG4gICAgICAgIGhlaWdodDogMjZweDtcbiAgICAgICAgd2lkdGg6IDI2cHg7XG4gICAgICAgIGxlZnQ6IDRweDtcbiAgICAgICAgYm90dG9tOiA0cHg7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICAtd2Via2l0LXRyYW5zaXRpb246IC40cztcbiAgICAgICAgdHJhbnNpdGlvbjogLjRzO1xuICAgIH1cbiAgICBcbiAgICBpbnB1dDpjaGVja2VkICsgLnNsaWRlciB7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyMTk2RjM7XG4gICAgfVxuICAgIFxuICAgIGlucHV0OmZvY3VzICsgLnNsaWRlciB7XG4gICAgICAgIGJveC1zaGFkb3c6IDAgMCAxcHggIzIxOTZGMztcbiAgICB9XG4gICAgXG4gICAgaW5wdXQ6Y2hlY2tlZCArIC5zbGlkZXI6YmVmb3JlIHtcbiAgICAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMjZweCk7XG4gICAgICAgIC1tcy10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMjZweCk7XG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgyNnB4KTtcbiAgICB9XG4gICAgXG4gICAgLnNsaWRlci5yb3VuZCB7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJvcmRlci1yYWRpdXMiXVsyXSwgIjtcbiAgICB9XG4gICAgXG4gICAgLnNsaWRlci5yb3VuZDpiZWZvcmUge1xuICAgICAgICBib3JkZXItcmFkaXVzOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXItcmFkaXVzIl1bMl0sICI7XG4gICAgfVxuXG4gICAgI25ldy1jb250YWluZXIge1xuICAgICAgICB3aWR0aDogNjAlO1xuICAgICAgICBoZWlnaHQ6IDcwJTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyLXJhZGl1cyJdWzBdLCAiO1xuICAgICAgICBib3JkZXI6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJvcmRlciJdLCAiO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgYmFja2dyb3VuZDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYmFja2dyb3VuZCJdLCAiO1xuICAgIH1cblxuICAgICNuZXctaW5wdXQge1xuICAgICAgICB3aWR0aDogODAlO1xuICAgICAgICBoZWlnaHQ6IDMwJTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyLXJhZGl1cyJdWzFdLCAiO1xuICAgICAgICBib3JkZXI6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJvcmRlciJdLCAiO1xuICAgICAgICBiYWNrZ3JvdW5kOiBub25lO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHN0YXJ0O1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICBtYXJnaW46IDQlO1xuICAgICAgICBvdmVyZmxvdzogYXV0bztcbiAgICB9XG5cbiAgICBbY29udGVudGVkaXRhYmxlPXRydWVdOmVtcHR5OmJlZm9yZSB7XG4gICAgICAgIGNvbnRlbnQ6IGF0dHIocGxhY2Vob2xkZXIpO1xuICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTtcbiAgICAgICAgZGlzcGxheTogYmxvY2s7IC8qIEZvciBGaXJlZm94ICovXG4gICAgfVxuXG4gICAgI25ldy1pbnB1dC1wYXJhIHtcbiAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgIG91dGxpbmU6IG5vbmU7XG4gICAgICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7XG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgICBmb250LWZhbWlseTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzJdLCAiO1xuICAgICAgICBmb250LXN0eWxlOiBub3JtYWw7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQiXSwgIjtcbiAgICAgICAgbGluZS1oZWlnaHQ6IG5vcm1hbDtcbiAgICB9XG5cbiAgICA6OnBsYWNlaG9sZGVyIHtcbiAgICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgIH1cblxuICAgICNidXR0b24tY29udGFpbmVyIHtcbiAgICAgICAgbWFyZ2luOiA0JTtcbiAgICAgICAgd2lkdGg6IDgwJTtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICB9XG4iKSk7CiAgZnVuY3Rpb24gb25fcmVuZGVyKCkgewogICAgdmFyIGVkaXRhYmxlRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ldy1pbnB1dC1wYXJhJyk7CiAgICB2YXIgbWF4TGVuZ3RoID0gcGFyc2VJbnQoZWRpdGFibGVEaXYuZ2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnKSk7CiAgICB2YXIgcG9zdF9pZCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgiLyIpWzJdOwogICAgdmFyIHBhcmVudCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgiLyIpWzNdOwogICAgaWYgKHBhcmVudCA9PSB1bmRlZmluZWQpIHsKICAgICAgcGFyZW50ID0gIi8iOwogICAgfQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvc3QtYnV0dG9uIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgZ3JlY2FwdGNoYS5yZWFkeShmdW5jdGlvbiAoKSB7CiAgICAgICAgZ3JlY2FwdGNoYS5leGVjdXRlKCc2TGYxbjRJb0FBQUFBRVhGRWVsMUJma3hIcmN1ekpVSk5mUGlGQTNxJywgewogICAgICAgICAgYWN0aW9uOiAnc3VibWl0JwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRva2VuKSB7CiAgICAgICAgICBDcmVhdGVDb21tZW50KGVkaXRhYmxlRGl2LmlubmVyVGV4dCwgcG9zdF9pZCwgcGFyZW50LCB0b2tlbikudGhlbihmdW5jdGlvbiAoc3VjY2VzcykgewogICAgICAgICAgICBpZiAoc3VjY2VzcykgewogICAgICAgICAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvcG9zdC8iICsgcG9zdF9pZCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkNyZWF0ZSBQb3N0IGZhaWxlZC4iKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfTsKICAgIGVkaXRhYmxlRGl2LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHZhciB0ZXh0ID0gdGhpcy5pbm5lclRleHQ7CiAgICAgIHZhciBjdXJzb3JQb3NpdGlvbiA9IGdldENhcmV0UG9zaXRpb24odGhpcyk7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjaGFyLWNvdW50IikuaW5uZXJUZXh0ID0gdGV4dC5sZW5ndGggKyAiLzI1MCI7CiAgICAgIGlmICh0ZXh0Lmxlbmd0aCA+IG1heExlbmd0aCkgewogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgdmFyIHRydW5jYXRlZFRleHQgPSB0ZXh0LnN1YnN0cmluZygwLCBtYXhMZW5ndGgpOwogICAgICAgIHRoaXMuaW5uZXJUZXh0ID0gdHJ1bmNhdGVkVGV4dDsKICAgICAgICBzZXRDYXJldFBvc2l0aW9uKHRoaXMsIE1hdGgubWluKGN1cnNvclBvc2l0aW9uLCBtYXhMZW5ndGgpKTsKICAgICAgfQogICAgfSk7CiAgICBmdW5jdGlvbiBnZXRDYXJldFBvc2l0aW9uKGVsZW1lbnQpIHsKICAgICAgdmFyIHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsKICAgICAgcmV0dXJuIHNlbC5hbmNob3JPZmZzZXQ7CiAgICB9CiAgICBmdW5jdGlvbiBzZXRDYXJldFBvc2l0aW9uKGVsZW1lbnQsIHBvc2l0aW9uKSB7CiAgICAgIHZhciByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7CiAgICAgIHZhciBzZWwgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7CiAgICAgIHJhbmdlLnNldFN0YXJ0KGVsZW1lbnQuY2hpbGROb2Rlc1swXSwgcG9zaXRpb24pOwogICAgICByYW5nZS5jb2xsYXBzZSh0cnVlKTsKICAgICAgc2VsLnJlbW92ZUFsbFJhbmdlcygpOwogICAgICBzZWwuYWRkUmFuZ2UocmFuZ2UpOwogICAgfQogIH0KICA7CiAgcGFnZS5kZWxldGVfYW5pbWF0aW9uKCJcbiAgICBAa2V5ZnJhbWVzIGRlbGV0ZSB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwJSk7XG4gICAgICAgIH1cbiAgICAgICAgMTAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMTAlKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIHBhZ2Uuc3Bhd25fYW5pbWF0aW9uKCJcbiAgICBAa2V5ZnJhbWVzIHNwYXduIHtcbiAgICAgICAgMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xMCUpO1xuICAgICAgICB9XG4gICAgICAgIDEwMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOyAvKiBBZGp1c3QgdGhlIGRpc3RhbmNlIHlvdSB3YW50IHRvIG1vdmUgb24gdGhlIHktYXhpcyAqL1xuICAgICAgICB9XG4gICAgICB9XG4gICAgIik7CiAgcGFnZS5vbl9yZW5kZXIob25fcmVuZGVyKTsKICBwYWdlLnJlbmRlcigpOwp9Cgp9LHsiLi4vZWxlbWVudHMvYmFja2dyb3VuZC5tanMiOjIsIi4uL2VsZW1lbnRzL2ZvbnRzLm1qcyI6NCwiLi4vZWxlbWVudHMvbmF2YmFyLm1qcyI6NiwiLi4vZWxlbWVudHMvbm90aWZpY2F0aW9ucy5tanMiOjgsIi4uL2xpYi9GcmFtZXdvcmsubWpzIjoxMCwiLi4vc2NyaXB0cy9hcGkubWpzIjoyOX1dLDIyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk5ld1Bvc3QgPSBOZXdQb3N0OwpmdW5jdGlvbiBOZXdQb3N0KHJvdXRlcikgewogIHZhciBfcmVxdWlyZSA9IHJlcXVpcmUoIi4uL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgICBQYWdlID0gX3JlcXVpcmUuUGFnZSwKICAgIERpc3BsYXkgPSBfcmVxdWlyZS5EaXNwbGF5OwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb250cy5tanMiKSwKICAgIEZvbnRzID0gX3JlcXVpcmUyLkZvbnRzOwogIHZhciBfcmVxdWlyZTMgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyIpLAogICAgQmFja2dyb3VuZCA9IF9yZXF1aXJlMy5CYWNrZ3JvdW5kOwogIHZhciBfcmVxdWlyZTQgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIiksCiAgICBOYXZiYXIgPSBfcmVxdWlyZTQuTmF2YmFyOwogIHZhciBfcmVxdWlyZTUgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlNS5Jc0xvZ2VkSW4sCiAgICBDcmVhdGVQb3N0ID0gX3JlcXVpcmU1LkNyZWF0ZVBvc3Q7CiAgdmFyIF9yZXF1aXJlNiA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIiksCiAgICBOb3RpZmljYXRpb24gPSBfcmVxdWlyZTYuTm90aWZpY2F0aW9uOwogIGlmIChJc0xvZ2VkSW4oKSA9PSBmYWxzZSkgewogICAgTm90aWZpY2F0aW9uKDEsICJZb3UgbmVlZCB0byBiZSBsb2dnZWQgaW4gdG8gY3JlYXRlIGEgcG9zdC4iKTsKICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvZXhwbG9yZSIpOwogICAgcmV0dXJuICIiOwogIH0KICB2YXIgZGlzcGxheSA9IG5ldyBEaXNwbGF5KCk7CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiTmV3UG9zdCIpOwogIHBhZ2UuY2xlYXIoWyJiYWNrZ3JvdW5kIiwgIm5hdmJhciIsICJmb250cyJdKTsKICBGb250cyhyb3V0ZXIpOwogIEJhY2tncm91bmQocm91dGVyKTsKICBOYXZiYXIocm91dGVyKTsKICB2YXIgcG9zdF9idXR0b24gPSBwYWdlLmltYWdlKCJwb3N0X2J1dHRvbi5zdmciKTsKICBwYWdlLmh0bWwoIlxuICAgICAgPGRpdiBpZD1cImNvbnRhaW5lclwiPlxuICAgICAgICA8ZGl2IGlkPVwibmV3LWNvbnRhaW5lclwiPlxuICAgICAgICAgIDxkaXYgaWQ9XCJuZXctaW5wdXRcIiA+XG4gICAgICAgICAgICA8ZGl2IGlkPVwiY2hhci1jb3VudFwiPjAvMjUwPC9kaXY+XG4gICAgICAgICAgICA8cCBjb250ZW50ZWRpdGFibGU9XCJ0cnVlXCIgbWF4bGVuZ3RoPTI0OSBwbGFjZWhvbGRlcj1cIkVudGVyIHRleHQgaGVyZS4uLlwiIGlkPVwibmV3LWlucHV0LXBhcmFcIj48L3A+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBpZD1cIm9wdGlvbi1jb250YWluZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJvcHRpb24tYmdcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJvcHRpb24tdGl0bGVcIj5CdXlhYmxlPzwvZGl2PlxuICAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwic3dpdGNoXCI+XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cImJ1eWFibGVcIiAvPlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInNsaWRlciByb3VuZFwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm9wdGlvbi1iZ1wiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJvcHRpb24tdGl0bGVcIj5TdGFydGluZyBQcmljZTwvZGl2PlxuICAgICAgICAgIDxpbnB1dCBjbGFzcz1cIm9wdGlvbi1pbnB1dFwiIHR5cGU9XCJudW1iZXJcIiBpZD1cInN0YXJ0aW5nLXByaWNlXCIgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBpZD1cImJ1dHRvbi1jb250YWluZXJcIj5cbiAgICAgICAgICAgIDxpbWcgaWQ9XCJwb3N0LWJ1dHRvblwiIHNyYz1cIiIuY29uY2F0KHBvc3RfYnV0dG9uLCAiXCIgLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAiKSk7CiAgcGFnZS5jc3MoIlxuICAgICNwb3N0LWJ1dHRvbiB7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICB9XG4gICAgLm9wdGlvbi1iZyB7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6ICIuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyLXJhZGl1cyJdWzBdLCAiO1xuICAgICAgICBib3JkZXI6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJvcmRlciJdLCAiO1xuICAgICAgICBoZWlnaHQ6IDMwJTtcbiAgICAgICAgd2lkdGg6IDgwJTtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBtYXJnaW4tYm90dG9tOiAxJTtcbiAgICB9XG4gICAgLm9wdGlvbi1pbnB1dCB7XG4gICAgICAgIGJvcmRlci1ib3R0b206IDJweCBzb2xpZCAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgYm9yZGVyLXRvcDogbm9uZTtcbiAgICAgICAgYm9yZGVyLXJpZ2h0OiBub25lO1xuICAgICAgICBib3JkZXItbGVmdDogbm9uZTtcbiAgICAgICAgbWFyZ2luOiA1JTtcbiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgIHdpZHRoOiA2MHB4O1xuICAgICAgICBoZWlnaHQ6IDM0cHg7XG4gICAgICAgIGJhY2tncm91bmQ6IG5vbmU7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgdGV4dC1hbGlnbjogbGVmdDtcbiAgICAgICAgZm9udC1mYW1pbHk6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICIsIHNhbnMtc2VyaWY7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsxXSwgIjtcbiAgICAgICAgZm9udC1zdHlsZTogbm9ybWFsO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGxpbmUtaGVpZ2h0OiBub3JtYWw7XG4gICAgfVxuICAgIC5vcHRpb24tdGl0bGUge1xuICAgICAgICBtYXJnaW46IDUlO1xuICAgICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICAgIGZvbnQtZmFtaWx5OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bMl0sICI7XG4gICAgICAgIGZvbnQtc3R5bGU6IG5vcm1hbDtcbiAgICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodCJdLCAiO1xuICAgICAgICBsaW5lLWhlaWdodDogbm9ybWFsO1xuICAgIH1cbiAgICAjY2hhci1jb3VudCB7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgZm9udC1mYW1pbHk6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICIsIHNhbnMtc2VyaWY7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVswXSwgIjtcbiAgICAgICAgZm9udC1zdHlsZTogbm9ybWFsO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGxpbmUtaGVpZ2h0OiBub3JtYWw7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgfVxuICAgICNvcHRpb24tY29udGFpbmVyIHtcbiAgICAgICAgaGVpZ2h0OiAzMCU7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICB9XG4gICAgI2NvbnRhaW5lciB7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgIHRvcDogMDtcbiAgICAgICAgbGVmdDogMDtcbiAgICAgICAgcG9zaXRpb246IGZpeGVkO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICB9XG5cbiAgICAuc3dpdGNoIHtcbiAgICAgICAgbWFyZ2luOiA1JTtcbiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgIHdpZHRoOiA2MHB4O1xuICAgICAgICBoZWlnaHQ6IDM0cHg7XG4gICAgfVxuICAgIFxuICAgIC5zd2l0Y2ggaW5wdXQge1xuICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICB3aWR0aDogMDtcbiAgICAgICAgaGVpZ2h0OiAwO1xuICAgIH1cbiAgICBcbiAgICAuc2xpZGVyIHtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIHRvcDogMDtcbiAgICAgICAgbGVmdDogMDtcbiAgICAgICAgcmlnaHQ6IDA7XG4gICAgICAgIGJvdHRvbTogMDtcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2NjYzsgLyogVXBkYXRlZCB0byB1c2UgZ2xvYmFsIGJhY2tncm91bmQgY29sb3IgKi9cbiAgICAgICAgdHJhbnNpdGlvbjogLjRzO1xuICAgIH1cbiAgICBcbiAgICAuc2xpZGVyOmJlZm9yZSB7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgY29udGVudDogXCJcIjtcbiAgICAgICAgaGVpZ2h0OiAyNnB4O1xuICAgICAgICB3aWR0aDogMjZweDtcbiAgICAgICAgbGVmdDogNHB4O1xuICAgICAgICBib3R0b206IDRweDtcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7IC8qIFVwZGF0ZWQgdG8gdXNlIHRleHQgY29sb3IgKi9cbiAgICAgICAgdHJhbnNpdGlvbjogLjRzO1xuICAgIH1cbiAgICBcbiAgICBpbnB1dDpjaGVja2VkICsgLnNsaWRlciB7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyMTk2RjM7XG4gICAgfVxuICAgIFxuICAgIGlucHV0OmZvY3VzICsgLnNsaWRlciB7XG4gICAgICAgIGJveC1zaGFkb3c6IDAgMCAxcHggIzIxOTZGMztcbiAgICB9XG4gICAgXG4gICAgaW5wdXQ6Y2hlY2tlZCArIC5zbGlkZXI6YmVmb3JlIHtcbiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDI2cHgpO1xuICAgIH1cbiAgICBcbiAgICAuc2xpZGVyLnJvdW5kIHtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMzRweDtcbiAgICB9XG4gICAgXG4gICAgLnNsaWRlci5yb3VuZDpiZWZvcmUge1xuICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7XG4gICAgfVxuXG4gICAgI25ldy1jb250YWluZXIge1xuICAgICAgICB3aWR0aDogNjAlO1xuICAgICAgICBoZWlnaHQ6IDcwJTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyLXJhZGl1cyJdWzBdLCAiO1xuICAgICAgICBib3JkZXI6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJvcmRlciJdLCAiO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICB9XG5cbiAgICAjbmV3LWlucHV0IHtcbiAgICAgICAgd2lkdGg6IDgwJTtcbiAgICAgICAgaGVpZ2h0OiAzMCU7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJvcmRlci1yYWRpdXMiXVsxXSwgIjtcbiAgICAgICAgYm9yZGVyOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXIiXSwgIjtcbiAgICAgICAgYmFja2dyb3VuZDogbm9uZTtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzdGFydDtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgbWFyZ2luOiA0JTtcbiAgICAgICAgb3ZlcmZsb3c6IGF1dG87XG4gICAgfVxuXG4gICAgW2NvbnRlbnRlZGl0YWJsZT10cnVlXTplbXB0eTpiZWZvcmUge1xuICAgICAgICBjb250ZW50OiBhdHRyKHBsYWNlaG9sZGVyKTtcbiAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gICAgICAgIGRpc3BsYXk6IGJsb2NrOyAvKiBGb3IgRmlyZWZveCAqL1xuICAgIH1cblxuICAgICNuZXctaW5wdXQtcGFyYSB7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICBvdXRsaW5lOiBub25lO1xuICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wO1xuICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgZm9udC1mYW1pbHk6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICIsIHNhbnMtc2VyaWY7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsyXSwgIjtcbiAgICAgICAgZm9udC1zdHlsZTogbm9ybWFsO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGxpbmUtaGVpZ2h0OiBub3JtYWw7XG4gICAgfVxuXG4gICAgOjpwbGFjZWhvbGRlciB7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICB9XG5cbiAgICAjYnV0dG9uLWNvbnRhaW5lciB7XG4gICAgICAgIG1hcmdpbjogNCU7XG4gICAgICAgIHdpZHRoOiA4MCU7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgfVxuIikpOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIHZhciBlZGl0YWJsZURpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXctaW5wdXQtcGFyYScpOwogICAgdmFyIG1heExlbmd0aCA9IHBhcnNlSW50KGVkaXRhYmxlRGl2LmdldEF0dHJpYnV0ZSgnbWF4bGVuZ3RoJykpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvc3QtYnV0dG9uIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgZ3JlY2FwdGNoYS5yZWFkeShmdW5jdGlvbiAoKSB7CiAgICAgICAgZ3JlY2FwdGNoYS5leGVjdXRlKCc2TGYxbjRJb0FBQUFBRVhGRWVsMUJma3hIcmN1ekpVSk5mUGlGQTNxJywgewogICAgICAgICAgYWN0aW9uOiAnc3VibWl0JwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRva2VuKSB7CiAgICAgICAgICBDcmVhdGVQb3N0KGVkaXRhYmxlRGl2LmlubmVyVGV4dCwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eWFibGUiKS5jaGVja2VkLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhcnRpbmctcHJpY2UiKS52YWx1ZSwgdG9rZW4pLnRoZW4oZnVuY3Rpb24gKHN1Y2Nlc3MpIHsKICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICAgICAgICByb3V0ZXIubmF2aWdhdGVUbygiL2V4cGxvcmUiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBOb3RpZmljYXRpb24oMSwgc3VjY2Vzcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH07CiAgICBlZGl0YWJsZURpdi5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGZ1bmN0aW9uIChldmVudCkgewogICAgICB2YXIgdGV4dCA9IHRoaXMuaW5uZXJUZXh0OwogICAgICB2YXIgY3Vyc29yUG9zaXRpb24gPSBnZXRDYXJldFBvc2l0aW9uKHRoaXMpOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2hhci1jb3VudCIpLmlubmVyVGV4dCA9IHRleHQubGVuZ3RoICsgIi8yNTAiOwogICAgICBpZiAodGV4dC5sZW5ndGggPiBtYXhMZW5ndGgpIHsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIHZhciB0cnVuY2F0ZWRUZXh0ID0gdGV4dC5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKTsKICAgICAgICB0aGlzLmlubmVyVGV4dCA9IHRydW5jYXRlZFRleHQ7CiAgICAgICAgc2V0Q2FyZXRQb3NpdGlvbih0aGlzLCBNYXRoLm1pbihjdXJzb3JQb3NpdGlvbiwgbWF4TGVuZ3RoKSk7CiAgICAgIH0KICAgIH0pOwogICAgZnVuY3Rpb24gZ2V0Q2FyZXRQb3NpdGlvbihlbGVtZW50KSB7CiAgICAgIHZhciBzZWwgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7CiAgICAgIHJldHVybiBzZWwuYW5jaG9yT2Zmc2V0OwogICAgfQogICAgZnVuY3Rpb24gc2V0Q2FyZXRQb3NpdGlvbihlbGVtZW50LCBwb3NpdGlvbikgewogICAgICB2YXIgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOwogICAgICB2YXIgc2VsID0gd2luZG93LmdldFNlbGVjdGlvbigpOwogICAgICByYW5nZS5zZXRTdGFydChlbGVtZW50LmNoaWxkTm9kZXNbMF0sIHBvc2l0aW9uKTsKICAgICAgcmFuZ2UuY29sbGFwc2UodHJ1ZSk7CiAgICAgIHNlbC5yZW1vdmVBbGxSYW5nZXMoKTsKICAgICAgc2VsLmFkZFJhbmdlKHJhbmdlKTsKICAgIH0KICB9CiAgOwogIHBhZ2UuZGVsZXRlX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBkZWxldGUge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCUpO1xuICAgICAgICB9XG4gICAgICAgIDEwMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwJSk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBwYWdlLnNwYXduX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBzcGF3biB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIHBhZ2Uub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIjoyLCIuLi9lbGVtZW50cy9mb250cy5tanMiOjQsIi4uL2VsZW1lbnRzL25hdmJhci5tanMiOjYsIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIjo4LCIuLi9saWIvRnJhbWV3b3JrLm1qcyI6MTAsIi4uL3NjcmlwdHMvYXBpLm1qcyI6Mjl9XSwyMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5Qb3N0ID0gUG9zdDsKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfQpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSBhcnIyW2ldID0gYXJyW2ldOyByZXR1cm4gYXJyMjsgfQpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQociwgbCkgeyB2YXIgdCA9IG51bGwgPT0gciA/IG51bGwgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgU3ltYm9sICYmIHJbU3ltYm9sLml0ZXJhdG9yXSB8fCByWyJAQGl0ZXJhdG9yIl07IGlmIChudWxsICE9IHQpIHsgdmFyIGUsIG4sIGksIHUsIGEgPSBbXSwgZiA9ICEwLCBvID0gITE7IHRyeSB7IGlmIChpID0gKHQgPSB0LmNhbGwocikpLm5leHQsIDAgPT09IGwpIHsgaWYgKE9iamVjdCh0KSAhPT0gdCkgcmV0dXJuOyBmID0gITE7IH0gZWxzZSBmb3IgKDsgIShmID0gKGUgPSBpLmNhbGwodCkpLmRvbmUpICYmIChhLnB1c2goZS52YWx1ZSksIGEubGVuZ3RoICE9PSBsKTsgZiA9ICEwKTsgfSBjYXRjaCAocikgeyBvID0gITAsIG4gPSByOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIWYgJiYgbnVsbCAhPSB0WyJyZXR1cm4iXSAmJiAodSA9IHRbInJldHVybiJdKCksIE9iamVjdCh1KSAhPT0gdSkpIHJldHVybjsgfSBmaW5hbGx5IHsgaWYgKG8pIHRocm93IG47IH0gfSByZXR1cm4gYTsgfSB9CmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQpmdW5jdGlvbiBQb3N0KHJvdXRlcikgewogIHZhciBfcmVxdWlyZSA9IHJlcXVpcmUoIi4uL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgICBQYWdlID0gX3JlcXVpcmUuUGFnZSwKICAgIERpc3BsYXkgPSBfcmVxdWlyZS5EaXNwbGF5OwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb250cy5tanMiKSwKICAgIEZvbnRzID0gX3JlcXVpcmUyLkZvbnRzOwogIHZhciBfcmVxdWlyZTMgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyIpLAogICAgQmFja2dyb3VuZCA9IF9yZXF1aXJlMy5CYWNrZ3JvdW5kOwogIHZhciBfcmVxdWlyZTQgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIiksCiAgICBOYXZiYXIgPSBfcmVxdWlyZTQuTmF2YmFyOwogIHZhciBfcmVxdWlyZTUgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9wb3N0Lm1qcyIpLAogICAgUG9zdCA9IF9yZXF1aXJlNS5Qb3N0OwogIHZhciBfcmVxdWlyZTYgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlNi5Jc0xvZ2VkSW4sCiAgICBHZXRDb21tZW50cyA9IF9yZXF1aXJlNi5HZXRDb21tZW50czsKICB2YXIgX3JlcXVpcmU3ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvbm90aWZpY2F0aW9ucy5tanMiKSwKICAgIE5vdGlmaWNhdGlvbiA9IF9yZXF1aXJlNy5Ob3RpZmljYXRpb247CiAgdmFyIF9yZXF1aXJlOCA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25ld19wb3N0X2J1dHRvbi5tanMiKSwKICAgIE5ld1Bvc3RCdXR0b24gPSBfcmVxdWlyZTguTmV3UG9zdEJ1dHRvbjsKICB2YXIgX3JlcXVpcmU5ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvY29tbWVudC5tanMiKSwKICAgIENvbW1lbnQgPSBfcmVxdWlyZTkuQ29tbWVudDsKICB2YXIgZGlzcGxheSA9IG5ldyBEaXNwbGF5KCk7CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiUG9zdCIpOwogIHBhZ2UuY2xlYXIoWyJiYWNrZ3JvdW5kIiwgIm5hdmJhciIsICJmb250cyIsICJuZXdfcG9zdF9idXR0b24iXSk7CiAgRm9udHMocm91dGVyKTsKICBCYWNrZ3JvdW5kKHJvdXRlcik7CiAgTmF2YmFyKHJvdXRlcik7CiAgTmV3UG9zdEJ1dHRvbihyb3V0ZXIpOwogIHBhZ2UuaHRtbCgiXG4gICAgPGRpdiBpZD1cImNvbW1lbnQtY29udGFpbmVyXCIgLz5cbiAgICAgICAgPGRpdiBpZD1cInBvc3QtY29udGFpbmVyLXNpbmdsZVwiPiA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInRpdGxlXCI+Q29tbWVudHMgPGRpdiBpZD1cIm5ldy1idXR0b25cIj48c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIj5hZGQ8L3NwYW4+IE5ldyBDb21tZW50IDwvZGl2PiA8L2Rpdj5cbiAgICAgICAgPGRpdiBpZD1cImNvbW1lbnQtY29udGFpbmVyXCI+PC9kaXY+XG4gICAgPC9kaXY+XG4gICAgIik7CiAgcGFnZS5jc3MoIlxuICAgICNnbG9iYWwtY29udGFpbmVyIHtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzdGFydDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICBsZWZ0OiAwO1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgaGVpZ2h0OiBmaXQtY29udGVudDtcbiAgICB9XG4gICAgLnRpdGxlIHtcbiAgICAgICAgZm9udC1mYW1pbHk6ICIuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodCJdLCAiO1xuICAgICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsyXSwgIjsgLyogQWRqdXN0IGZvbnQgc2l6ZSAqL1xuICAgICAgICB3aWR0aDogNjAlO1xuICAgIH1cblxuICAgICNwb3N0LWNvbnRhaW5lci1zaW5nbGUge1xuICAgICAgICBtYXJnaW4tdG9wOiA3LjUlO1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgaGVpZ2h0OiBmaXQtY29udGVudDtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzdGFydDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICB9XG5cbiAgICAjcG9zdC1jb250YWluZXItc2luZ2xlIHBvc3Qge1xuICAgICAgICB3aWR0aDogNjAlO1xuICAgICAgICBoZWlnaHQ6IGZpdC1jb250ZW50O1xuICAgICAgICBtaW4taGVpZ2h0OiA1JTtcbiAgICAgICAgbWFyZ2luOiAxJTtcbiAgICB9XG5cbiAgICAjY29tbWVudC1jb250YWluZXIge1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgaGVpZ2h0OiBmaXQtY29udGVudDtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzdGFydDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICB9XG5cbiAgICAjY29tbWVudC1jb250YWluZXIgY29tbWVudCB7XG4gICAgICAgIHdpZHRoOiA2MCU7XG4gICAgICAgIGhlaWdodDogZml0LWNvbnRlbnQ7XG4gICAgICAgIG1pbi1oZWlnaHQ6IDUlO1xuICAgICAgICBtYXJnaW4tdG9wOiAxJTtcbiAgICB9XG5cbiAgICAjbmV3LWJ1dHRvbiB7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgdHJhbnNpdGlvbi1kdXJhdGlvbjogMC41cztcbiAgICAgICAgZm9udC1mYW1pbHk6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICIsIHNhbnMtc2VyaWY7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQiXSwgIjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzFdLCAiOyAvKiBBZGp1c3QgZm9udCBzaXplICovXG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgaGVpZ2h0OiBhdXRvO1xuICAgICAgICB3aWR0aDogYXV0bztcbiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICB3aWR0aDogZml0LWNvbnRlbnQ7XG4gICAgfVxuICAgICNuZXctYnV0dG9uOmhvdmVyIHtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQocGFyc2VJbnQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzJdKSArIDIsICJweDsgLyogSW5jcmVhc2UgZm9udCBzaXplIG9uIGhvdmVyICovXG4gICAgfVxuIikpOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIHZhciBhcGlfdXJsID0gIndzczovL2FwaS5ibG9ja2NvaW4uc29jaWFsIjsKICAgIGlmICh3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT0gIjEyNy4wLjAuMSIgfHwgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09ICJsb2NhbGhvc3QiKSB7CiAgICAgIGFwaV91cmwgPSAid3M6Ly8xMjcuMC4wLjE6ODA4MCI7CiAgICB9CiAgICB2YXIgc29ja2V0ID0gbnVsbDsKICAgIHZhciBjYWNoZSA9IG51bGw7CiAgICB2YXIgcG9zdF9pZCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgiLyIpWzJdOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm5ldy1idXR0b24iKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICByb3V0ZXIubmF2aWdhdGVUbygiL2NvbW1lbnQvIiArIHBvc3RfaWQpOwogICAgfTsKICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoYXBpX3VybCArICcvcG9zdCcpOwogICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpOwogICAgICBjYWNoZSA9IGRhdGE7CiAgICB9KTsKICAgIGZ1bmN0aW9uIHdhaXRGb3JOb25OdWxsQ2FjaGUoKSB7CiAgICAgIHZhciBpbnRlcnZhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMTAwOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBmdW5jdGlvbiBjaGVja1ZhcmlhYmxlKCkgewogICAgICAgICAgY2FjaGU7CiAgICAgICAgICBpZiAoY2FjaGUgIT09IG51bGwpIHsKICAgICAgICAgICAgcmVzb2x2ZShjYWNoZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZXRUaW1lb3V0KGNoZWNrVmFyaWFibGUsIGludGVydmFsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2hlY2tWYXJpYWJsZSgpOwogICAgICB9KTsKICAgIH0KICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdvcGVuJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAnb3Bjb2RlJzogMSwKICAgICAgICAiaWQiOiBwb3N0X2lkCiAgICAgIH0pKTsKICAgIH0pOwogICAgd2FpdEZvck5vbk51bGxDYWNoZSgpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgIHZhciBwb3N0ID0gdmFsdWU7CiAgICAgIGlmICh2YWx1ZVsic3VjY2VzcyJdICE9IHRydWUpIHsKICAgICAgICBOb3RpZmljYXRpb24oMSwgIlVua25vd24gUG9zdCIpOwogICAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvZXhwbG9yZSIpOwogICAgICAgIHJldHVybiAiIjsKICAgICAgfQogICAgICB2YXIgcG9zdF9kYXRhID0gcG9zdFsiZGF0YSJdOwogICAgICBwb3N0X2RhdGFbInVzZXItaWQiXSA9IHBvc3RbInByb2ZpbGUiXVsiaWQiXTsKICAgICAgcG9zdF9kYXRhWyJ1c2VyIl0gPSBwb3N0WyJwcm9maWxlIl1bImRpc3BsYXkiXTsKICAgICAgcG9zdF9kYXRhWyJwcm9maWxlLXBpY3R1cmUiXSA9IHBvc3RbInByb2ZpbGUiXVsicHJvZmlsZS1waWN0dXJlIl07CiAgICAgIHBvc3RfZGF0YVsiYmFkZ2VzIl0gPSBwb3N0WyJwcm9maWxlIl1bImJhZGdlcyJdOwogICAgICB2YXIgbmV3X3Bvc3QgPSBuZXcgUG9zdChyb3V0ZXIsIHBvc3RfZGF0YSwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvc3QtY29udGFpbmVyLXNpbmdsZSIpKTsKICAgIH0pOwogICAgdmFyIHBvc3RfaGllcmFyY3kgPSB7fTsgLy9JZyB0aGF0J3MgaG93IHlvdSB3cml0ZSBpdCBpJ20gbm90IHN1cmUgYWJvdXQgaXQgdGJoIGJ1dCBpJ20gZ29ubmEgbGV0IGl0IGxpa2UgdGhhdCBmb3Igbm93CgogICAgZnVuY3Rpb24gYWRkX2FsbF9jb21tZW50c19mb3Jfa2V5KGtleSkgewogICAgICAvL2EgYml0IGxvbmcgSSBoYXZlIHRvIGFkbWl0IGxvbAogICAgICBpZiAoa2V5IGluIHBvc3RfaGllcmFyY3kpIHsKICAgICAgICBmb3IgKHZhciBjb21tZW50IGluIHBvc3RfaGllcmFyY3lba2V5XSkgewogICAgICAgICAgdmFyIHBhcmVudCA9ICJjb21tZW50LWNvbnRhaW5lciI7CiAgICAgICAgICBpZiAoa2V5ICE9ICIvIikgewogICAgICAgICAgICBwYXJlbnQgPSBrZXkgKyAiLWNvbnRhaW5lciI7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZyhwYXJlbnQpOwogICAgICAgICAgY29uc29sZS5sb2cocG9zdF9oaWVyYXJjeVtrZXldW2NvbW1lbnRdKTsKICAgICAgICAgIHZhciBuZXdfY29tbWVudCA9IG5ldyBDb21tZW50KHJvdXRlciwgcG9zdF9oaWVyYXJjeVtrZXldW2NvbW1lbnRdLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwYXJlbnQpLCBwb3N0X2lkKTsKICAgICAgICAgIGFkZF9hbGxfY29tbWVudHNfZm9yX2tleShwb3N0X2hpZXJhcmN5W2tleV1bY29tbWVudF1bImlkIl0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgR2V0Q29tbWVudHMocG9zdF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICBmb3IgKHZhciBfaSA9IDAsIF9PYmplY3QkZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKGRhdGEpOyBfaSA8IF9PYmplY3QkZW50cmllcy5sZW5ndGg7IF9pKyspIHsKICAgICAgICB2YXIgX09iamVjdCRlbnRyaWVzJF9pID0gX3NsaWNlZFRvQXJyYXkoX09iamVjdCRlbnRyaWVzW19pXSwgMiksCiAgICAgICAgICBrZXkgPSBfT2JqZWN0JGVudHJpZXMkX2lbMF0sCiAgICAgICAgICB2YWx1ZSA9IF9PYmplY3QkZW50cmllcyRfaVsxXTsKICAgICAgICBjb25zb2xlLmxvZyh2YWx1ZSk7CiAgICAgICAgaWYgKHZhbHVlWyJwYXJlbnQiXSBpbiBwb3N0X2hpZXJhcmN5KSB7CiAgICAgICAgICBwb3N0X2hpZXJhcmN5W3ZhbHVlWyJwYXJlbnQiXV0ucHVzaCh2YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHBvc3RfaGllcmFyY3lbdmFsdWVbInBhcmVudCJdXSA9IFt2YWx1ZV07CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKHBvc3RfaGllcmFyY3kpOwogICAgICBhZGRfYWxsX2NvbW1lbnRzX2Zvcl9rZXkoIi8iKTsKICAgICAgLy9jb25zdCBuZXdfY29tbWVudCA9IG5ldyBDb21tZW50KHJvdXRlcix2YWx1ZSxkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29tbWVudC1jb250YWluZXIiKSkKICAgIH0pOwogIH0KICBwYWdlLmRlbGV0ZV9hbmltYXRpb24oIlxuICAgIEBrZXlmcmFtZXMgZGVsZXRlIHtcbiAgICAgICAgMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxMCUpOyAvKiBBZGp1c3QgdGhlIGRpc3RhbmNlIHlvdSB3YW50IHRvIG1vdmUgb24gdGhlIHktYXhpcyAqL1xuICAgICAgICB9XG4gICAgICB9XG4gICAgIik7CiAgcGFnZS5zcGF3bl9hbmltYXRpb24oIlxuICAgIEBrZXlmcmFtZXMgc3Bhd24ge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwJSk7XG4gICAgICAgIH1cbiAgICAgICAgMTAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBmdW5jdGlvbiBvbl9kZWxldGUoKSB7CiAgICBzb2NrZXQuY2xvc2UoKTsKICB9CiAgcGFnZS5vbl9kZWxldGUob25fZGVsZXRlKTsKICBwYWdlLm9uX3JlbmRlcihvbl9yZW5kZXIpOwogIHBhZ2UucmVuZGVyKCk7Cn0KCn0seyIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyI6MiwiLi4vZWxlbWVudHMvY29tbWVudC5tanMiOjMsIi4uL2VsZW1lbnRzL2ZvbnRzLm1qcyI6NCwiLi4vZWxlbWVudHMvbmF2YmFyLm1qcyI6NiwiLi4vZWxlbWVudHMvbmV3X3Bvc3RfYnV0dG9uLm1qcyI6NywiLi4vZWxlbWVudHMvbm90aWZpY2F0aW9ucy5tanMiOjgsIi4uL2VsZW1lbnRzL3Bvc3QubWpzIjo5LCIuLi9saWIvRnJhbWV3b3JrLm1qcyI6MTAsIi4uL3NjcmlwdHMvYXBpLm1qcyI6Mjl9XSwyNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5Qcm9maWxlID0gUHJvZmlsZTsKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfQpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSBhcnIyW2ldID0gYXJyW2ldOyByZXR1cm4gYXJyMjsgfQpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQociwgbCkgeyB2YXIgdCA9IG51bGwgPT0gciA/IG51bGwgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgU3ltYm9sICYmIHJbU3ltYm9sLml0ZXJhdG9yXSB8fCByWyJAQGl0ZXJhdG9yIl07IGlmIChudWxsICE9IHQpIHsgdmFyIGUsIG4sIGksIHUsIGEgPSBbXSwgZiA9ICEwLCBvID0gITE7IHRyeSB7IGlmIChpID0gKHQgPSB0LmNhbGwocikpLm5leHQsIDAgPT09IGwpIHsgaWYgKE9iamVjdCh0KSAhPT0gdCkgcmV0dXJuOyBmID0gITE7IH0gZWxzZSBmb3IgKDsgIShmID0gKGUgPSBpLmNhbGwodCkpLmRvbmUpICYmIChhLnB1c2goZS52YWx1ZSksIGEubGVuZ3RoICE9PSBsKTsgZiA9ICEwKTsgfSBjYXRjaCAocikgeyBvID0gITAsIG4gPSByOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIWYgJiYgbnVsbCAhPSB0WyJyZXR1cm4iXSAmJiAodSA9IHRbInJldHVybiJdKCksIE9iamVjdCh1KSAhPT0gdSkpIHJldHVybjsgfSBmaW5hbGx5IHsgaWYgKG8pIHRocm93IG47IH0gfSByZXR1cm4gYTsgfSB9CmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQpmdW5jdGlvbiBQcm9maWxlKHJvdXRlcikgewogIHZhciBfcmVxdWlyZSA9IHJlcXVpcmUoIi4uL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgICBQYWdlID0gX3JlcXVpcmUuUGFnZSwKICAgIERpc3BsYXkgPSBfcmVxdWlyZS5EaXNwbGF5OwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb250cy5tanMiKSwKICAgIEZvbnRzID0gX3JlcXVpcmUyLkZvbnRzOwogIHZhciBfcmVxdWlyZTMgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyIpLAogICAgQmFja2dyb3VuZCA9IF9yZXF1aXJlMy5CYWNrZ3JvdW5kOwogIHZhciBfcmVxdWlyZTQgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIiksCiAgICBOYXZiYXIgPSBfcmVxdWlyZTQuTmF2YmFyOwogIHZhciBfcmVxdWlyZTUgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb290ZXIubWpzIiksCiAgICBGb290ZXIgPSBfcmVxdWlyZTUuRm9vdGVyOwogIHZhciBfcmVxdWlyZTYgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9wb3N0Lm1qcyIpLAogICAgUG9zdCA9IF9yZXF1aXJlNi5Qb3N0OwogIHZhciBfcmVxdWlyZTcgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIEdldFByb2ZpbGUgPSBfcmVxdWlyZTcuR2V0UHJvZmlsZSwKICAgIEZvbGxvd1VzZXIgPSBfcmVxdWlyZTcuRm9sbG93VXNlciwKICAgIEZvbGxvd2VkVXNlciA9IF9yZXF1aXJlNy5Gb2xsb3dlZFVzZXI7CiAgdmFyIF9yZXF1aXJlOCA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIiksCiAgICBOb3RpZmljYXRpb24gPSBfcmVxdWlyZTguTm90aWZpY2F0aW9uOwogIHZhciBfcmVxdWlyZTkgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uZXdfcG9zdF9idXR0b24ubWpzIiksCiAgICBOZXdQb3N0QnV0dG9uID0gX3JlcXVpcmU5Lk5ld1Bvc3RCdXR0b247CiAgdmFyIF9yZXF1aXJlMTAgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2Nvb2tpZXMubWpzIiksCiAgICBzZXRDb29raWUgPSBfcmVxdWlyZTEwLnNldENvb2tpZSwKICAgIGdldENvb2tpZSA9IF9yZXF1aXJlMTAuZ2V0Q29va2llLAogICAgY2hlY2tDb29raWUgPSBfcmVxdWlyZTEwLmNoZWNrQ29va2llOwogIHZhciBkaXNwbGF5ID0gbmV3IERpc3BsYXkoKTsKICB2YXIgcGFnZSA9IG5ldyBQYWdlKCJQcm9maWxlIik7CiAgcGFnZS5jbGVhcihbImJhY2tncm91bmQiLCAibmF2YmFyIiwgImZvbnRzIiwgIm5ld19wb3N0X2J1dHRvbiJdKTsKICBGb250cyhyb3V0ZXIpOwogIEJhY2tncm91bmQocm91dGVyKTsKICBOYXZiYXIocm91dGVyKTsKICBOZXdQb3N0QnV0dG9uKHJvdXRlcik7CiAgdmFyIGJvcmRlciA9IHBhZ2UuaW1hZ2UoImJvcmRlci5zdmciKTsKICB2YXIgbW9ja3VwID0gcGFnZS5pbWFnZSgiTW9ja3VwLnBuZyIpOwogIHZhciBtb2NrdXBmcm9udCA9IHBhZ2UuaW1hZ2UoIk1vY2t1cEZyb250LnBuZyIpOwogIHBhZ2UuaHRtbCgiXG4gICAgICA8aW1nIGlkPVwiYmFubmVyXCIgLz5cbiAgICAgIDxkaXYgaWQ9XCJiYW5uZXItY29udGFpbmVyXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJiYW5yciBsZWZ0XCI+XG4gICAgICAgICAgPGltZyBpZD1cInByb2ZpbGUtcGljXCI+IDwvaW1nPlxuICAgICAgICAgIDxkaXYgaWQ9XCJ1c2VybmFtZVwiPkxvYWRpbmcuLi48L2Rpdj5cbiAgICAgICAgICA8ZGl2IGlkPVwiYmFkZ2VzLWNvbnRhaW5lclwiPjwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImJhbnJyIHJpZ2h0XCI+XG4gICAgICAgICAgPGRpdiBpZD1cImZvbGxvd2VyLWNvdW50XCI+Rm9sbG93ZXJzIC0gPHNwYW4gaWQ9XCJmb2xsb3dlci1jb3VudC1pbnRcIj48L3NwYW4+PC9kaXY+XG4gICAgICAgICAgPGRpdiBpZD1cImZvbGxvdy1idXR0b25cIj4gRm9sbG93IDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImJpZy1jb250YWluZXJcIj5cbiAgICAgICAgPGRpdiBpZD1cImJ1dHRvbi1jb250YWluZXJcIj5cbiAgICAgICAgICA8ZGl2IGlkPVwicG9wdWxhclwiIGNsYXNzPVwiYnV0dG9uIHN0cm9uZ1wiPk1vc3QgUG9wdWxhcjwvZGl2PlxuICAgICAgICAgIDxkaXYgaWQ9XCJidXllZFwiIGNsYXNzPVwiYnV0dG9uXCI+Qm91Z2h0IFBvc3RzPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGlkPVwiZGVzY3JpcHRpb25cIj5Mb2FkaW5nLi4uPC9kaXY+XG4gICAgICA8ZGl2IGlkPVwicG9zdC1jb250YWluZXJcIj48L2Rpdj5cbiAgICAiKTsKICBwYWdlLmNzcygiXG4gICAgI2Rlc2NyaXB0aW9uIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIHdpZHRoOiA2MCU7XG4gICAgICBsZWZ0OiAyMCU7XG4gICAgICB0b3A6IDM1JTtcbiAgICAgIGZvbnQtZmFtaWx5OiAiLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICIsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bMV0sICI7IC8qIEFkanVzdCBmb250IHNpemUgKi9cbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICB9XG4gICAgI3Bvc3QtY29udGFpbmVyIHtcbiAgICAgIHRvcDogNDIlO1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgbWluLWhlaWdodDogNTAlO1xuICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICBoZWlnaHQ6IGZpdC1jb250ZW50O1xuICAgICAgbGVmdDogMDtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHN0YXJ0O1xuICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgfVxuXG4gICAgI3Bvc3QtY29udGFpbmVyIHBvc3Qge1xuICAgICAgd2lkdGg6IDYwJTtcbiAgICAgIGhlaWdodDogZml0LWNvbnRlbnQ7XG4gICAgICBtaW4taGVpZ2h0OiA1JTtcbiAgICAgIG1hcmdpbjogMSU7XG4gICAgfVxuICAgIC5iaWctY29udGFpbmVyIHtcbiAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgdG9wOiAzOSU7XG4gICAgICBsZWZ0OiAwO1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7ICAgXG4gICAgfVxuICAgICNidXR0b24tY29udGFpbmVyIHtcbiAgICAgIHdpZHRoOiA2MCU7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcbiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7ICBcbiAgICB9XG4gICAgLmJ1dHRvbiB7XG4gICAgICBmb250LWZhbWlseTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQiXSwgIjtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsxXSwgIjsgLyogQWRqdXN0IGZvbnQgc2l6ZSAqL1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgbWFyZ2luLXJpZ2h0OiA1JTtcbiAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICB9XG4gICAgLnN0cm9uZyB7XG4gICAgICBmb250LXdlaWdodDogNjAwO1xuICAgIH1cbiAgICAuYmFkZ2Uge1xuICAgICAgZm9udC1zaXplOiA1MHB4O1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiOyAvKiBVc2UgdGV4dCBjb2xvciBmb3IgYmFkZ2UgKi9cbiAgICB9XG4gICAgI2JhZGdlcy1jb250YWluZXIge1xuICAgICAgd2lkdGg6IDIwJTtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0O1xuICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgIG1hcmdpbjogMSU7XG4gICAgfVxuICAgICNwcm9maWxlLXBpYyB7XG4gICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgIHdpZHRoOiAyMCU7XG4gICAgICBvYmplY3QtZml0OiBjb3ZlcjtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDI1NnB4O1xuICAgIH1cbiAgICAucmlnaHQge1xuICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcbiAgICAgIG1hcmdpbi1yaWdodDogMTAuOCU7XG4gICAgfVxuICAgIC5sZWZ0IHtcbiAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcbiAgICAgIG1hcmdpbi1sZWZ0OiAxMC44JTtcbiAgICB9XG4gICAgI3VzZXJuYW1lIHtcbiAgICAgIGZvbnQtZmFtaWx5OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodCJdLCAiO1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzNdLCAiOyAvKiBBZGp1c3QgZm9udCBzaXplICovXG4gICAgICBsZWZ0OiAyMCU7XG4gICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICBtYXJnaW4tbGVmdDogMyU7XG4gICAgICBtYXJnaW4tcmlnaHQ6IDElO1xuICAgIH1cbiAgICAjZm9sbG93ZXItY291bnQge1xuICAgICAgZm9udC1mYW1pbHk6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250Il0sICIsIHNhbnMtc2VyaWY7XG4gICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bMl0sICI7IC8qIEFkanVzdCBmb250IHNpemUgKi9cbiAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgIG1hcmdpbjogMyU7XG4gICAgfVxuICAgICNmb2xsb3ctYnV0dG9uIHtcbiAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgIHRyYW5zaXRpb24tZHVyYXRpb246IDAuNXM7XG4gICAgICBmb250LWZhbWlseTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgIGZvbnQtd2VpZ2h0OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udC13ZWlnaHQiXSwgIjtcbiAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsyXSwgIjsgLyogQWRqdXN0IGZvbnQgc2l6ZSAqL1xuICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgICAgYm9yZGVyLXJhZGl1czogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyLXJhZGl1cyJdWzBdLCAiOyAvKiBVc2UgZ2xvYmFsIGJvcmRlciByYWRpdXMgKi9cbiAgICAgIGJvcmRlcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyIl0sICI7IC8qIFVzZSBnbG9iYWwgYm9yZGVyICovXG4gICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICB3aWR0aDogYXV0bztcbiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICB9XG4gICAgI2ZvbGxvdy1idXR0b246aG92ZXIge1xuICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQocGFyc2VJbnQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzJdKSArIDIsICJweDsgLyogSW5jcmVhc2UgZm9udCBzaXplIG9uIGhvdmVyICovXG4gICAgfVxuICAgICNiYW5uZXIge1xuICAgICAgdG9wOiA3LjUlO1xuICAgICAgaGVpZ2h0OiBhdXRvO1xuICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICBtYXgtaGVpZ2h0OiAyMCU7XG4gICAgICBvYmplY3QtZml0OiBjb3ZlcjtcbiAgICAgIGxlZnQ6IDA7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgfVxuICAgIC5iYW5yciB7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgd2lkdGg6IDMwJTtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIH1cbiAgICAjYmFubmVyLWNvbnRhaW5lciB7XG4gICAgICBsZWZ0OiAwO1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgdG9wOiAzMiU7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICAgIGhlaWdodDogMDtcbiAgICB9XG4iKSk7CiAgcGFnZS5zcGF3bl9hbmltYXRpb24oIlxuICAgIEBrZXlmcmFtZXMgc3Bhd24ge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwJSk7XG4gICAgICAgIH1cbiAgICAgICAgMTAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICB2YXIgYXBpX3VybCA9ICJ3c3M6Ly9hcGkuYmxvY2tjb2luLnNvY2lhbCI7CiAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PSAiMTI3LjAuMC4xIiB8fCB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT0gImxvY2FsaG9zdCIpIHsKICAgIGFwaV91cmwgPSAid3M6Ly8xMjcuMC4wLjE6ODA4MCI7CiAgfQogIHZhciBzb2NrZXQgPSBudWxsOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIHZhciBjYWNoZSA9IG51bGw7CiAgICB2YXIgb2Zmc2V0ID0gMDsKICAgIHZhciBvcGNvZGUgPSAzOwogICAgdmFyIGZvbGxvd2VkID0gZmFsc2U7CiAgICB2YXIgdXNlciA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgiLyIpWzJdOwogICAgaWYgKHVzZXIgPT0gZ2V0Q29va2llKCJ2MS1pZCIpKSB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmb2xsb3ctYnV0dG9uIikuaW5uZXJUZXh0ID0gIkVkaXQiOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZm9sbG93LWJ1dHRvbiIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi9zZXR0aW5ncy9wcm9maWxlIik7CiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICBGb2xsb3dlZFVzZXIodXNlcikudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIGZvbGxvd2VkID0gZGF0YVsiZm9sbG93ZWQiXTsKICAgICAgICBpZiAoZGF0YVsiZm9sbG93ZWQiXSkgewogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZvbGxvdy1idXR0b24iKS5pbm5lclRleHQgPSAiVW5mb2xsb3ciOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmb2xsb3ctYnV0dG9uIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBncmVjYXB0Y2hhLnJlYWR5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGdyZWNhcHRjaGEuZXhlY3V0ZSgnNkxmMW40SW9BQUFBQUVYRkVlbDFCZmt4SHJjdXpKVUpOZlBpRkEzcScsIHsKICAgICAgICAgICAgYWN0aW9uOiAnc3VibWl0JwogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAodG9rZW4pIHsKICAgICAgICAgICAgRm9sbG93VXNlcih1c2VyLCB0b2tlbik7CiAgICAgICAgICAgIGlmIChmb2xsb3dlZCkgewogICAgICAgICAgICAgIGZvbGxvd2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZvbGxvdy1idXR0b24iKS5pbm5lclRleHQgPSAiRm9sbG93IjsKICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZm9sbG93ZXItY291bnQtaW50IikuaW5uZXJUZXh0ID0gcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZvbGxvd2VyLWNvdW50LWludCIpLmlubmVyVGV4dCkgLSAxOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGZvbGxvd2VkID0gdHJ1ZTsKICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZm9sbG93LWJ1dHRvbiIpLmlubmVyVGV4dCA9ICJVbmZvbGxvdyI7CiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZvbGxvd2VyLWNvdW50LWludCIpLmlubmVyVGV4dCA9IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmb2xsb3dlci1jb3VudC1pbnQiKS5pbm5lclRleHQpICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICB9CiAgICBHZXRQcm9maWxlKHVzZXIpLnRoZW4oZnVuY3Rpb24gKHByb2ZpbGUpIHsKICAgICAgaWYgKHByb2ZpbGUgPT0gZmFsc2UpIHsKICAgICAgICBOb3RpZmljYXRpb24oMSwgIlVua25vd24gVXNlci4iKTsKICAgICAgICByb3V0ZXIubmF2aWdhdGVUbygiL2V4cGxvcmUiKTsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInVzZXJuYW1lIikuaW5uZXJUZXh0ID0gcHJvZmlsZVsiZGlzcGxheSJdOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZm9sbG93ZXItY291bnQtaW50IikuaW5uZXJUZXh0ID0gcHJvZmlsZVsiZm9sbG93ZXJzIl07CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcm9maWxlLXBpYyIpLnNyYyA9IHByb2ZpbGVbInByb2ZpbGUtcGljdHVyZSJdOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYmFubmVyIikuc3JjID0gcHJvZmlsZVsiYmFubmVyIl07CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkZXNjcmlwdGlvbiIpLmlubmVyVGV4dCA9IHByb2ZpbGVbImFib3V0Il07CiAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYmFkZ2VzLWNvbnRhaW5lciIpOwogICAgICB2YXIgYmFkZ2VzID0gWyJhd2FyZF9zdGFyIiwgInZlcmlmaWVkIiwgInNoaWVsZF9wZXJzb24iLCAic21hcnRfdG95IiwgImxvY2FsX2ZpcmVfZGVwYXJ0bWVudCIsICJzY2llbmNlIiwgJ2J1Z19yZXBvcnQnXTsKICAgICAgdmFyIHRpdGxlcyA9IFsiQmxvY2tDb2luIEFkbWluIiwgIlZlcmlmaWVkIEFjY291bnQiLCAiQmxvY2tDb2luIFN0YWZmIiwgIkJvdCBBY2NvdW50IiwgIkJsb2NrQ29pbiBQcmVtaXVtIiwgIkJldGEgVGVzdGVyIiwgIkJ1ZyBSZXBvcnQiXTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9maWxlWyJiYWRnZXMiXS5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpOwogICAgICAgIHNwYW4uY2xhc3NOYW1lID0gIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWQgYmFkZ2UiOwogICAgICAgIHNwYW4uaW5uZXJIVE1MID0gYmFkZ2VzW3Byb2ZpbGVbImJhZGdlcyJdW2ldXTsKICAgICAgICBzcGFuLnRpdGxlID0gdGl0bGVzW3Byb2ZpbGVbImJhZGdlcyJdW2ldXTsKICAgICAgICAvLyBBcHBlbmQgdGhlIHNwYW4gZWxlbWVudCB0byB0aGUgY29udGFpbmVyIGRpdgogICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzcGFuKTsKICAgICAgfQogICAgfSk7CiAgICBzb2NrZXQgPSBuZXcgV2ViU29ja2V0KGFwaV91cmwgKyAnL3Bvc3QnKTsKICAgIGZ1bmN0aW9uIGNsZWFyUG9zdHMoKSB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwb3N0LWNvbnRhaW5lciIpLmlubmVySFRNTCA9ICIiOwogICAgfQogICAgZnVuY3Rpb24gcmVtb3ZlU3Ryb25nKCkgewogICAgICB2YXIgZWxlbWVudHMgPSBwYWdlLmRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3N0cm9uZycpOwogICAgICB2YXIgZWxlbWVudHNBcnJheSA9IEFycmF5LmZyb20oZWxlbWVudHMpOwogICAgICBlbGVtZW50c0FycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3N0cm9uZycpOwogICAgICB9KTsKICAgIH0KICAgIGZ1bmN0aW9uIHdhaXRGb3JOb25OdWxsQ2FjaGUoKSB7CiAgICAgIHZhciBpbnRlcnZhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMTAwOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBmdW5jdGlvbiBjaGVja1ZhcmlhYmxlKCkgewogICAgICAgICAgY2FjaGU7CiAgICAgICAgICBpZiAoY2FjaGUgIT09IG51bGwpIHsKICAgICAgICAgICAgcmVzb2x2ZShjYWNoZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZXRUaW1lb3V0KGNoZWNrVmFyaWFibGUsIGludGVydmFsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2hlY2tWYXJpYWJsZSgpOwogICAgICB9KTsKICAgIH0KICAgIGZ1bmN0aW9uIHBhcnNlY2FjaGUoKSB7CiAgICAgIGlmIChjYWNoZSAhPSBudWxsKSB7CiAgICAgICAgaWYgKGNhY2hlWyJvcGNvZGUiXSA9PSBvcGNvZGUpIHsKICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX09iamVjdCRlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMoY2FjaGVbImRhdGEiXSk7IF9pIDwgX09iamVjdCRlbnRyaWVzLmxlbmd0aDsgX2krKykgewogICAgICAgICAgICB2YXIgX09iamVjdCRlbnRyaWVzJF9pID0gX3NsaWNlZFRvQXJyYXkoX09iamVjdCRlbnRyaWVzW19pXSwgMiksCiAgICAgICAgICAgICAga2V5ID0gX09iamVjdCRlbnRyaWVzJF9pWzBdLAogICAgICAgICAgICAgIHZhbHVlID0gX09iamVjdCRlbnRyaWVzJF9pWzFdOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHZhciBwb3N0ID0gdmFsdWU7CiAgICAgICAgICAgICAgdmFyIHBvc3RfZGF0YSA9IHBvc3RbImRhdGEiXTsKICAgICAgICAgICAgICBwb3N0X2RhdGFbInVzZXItaWQiXSA9IHBvc3RbInByb2ZpbGUiXVsiaWQiXTsKICAgICAgICAgICAgICBwb3N0X2RhdGFbInVzZXIiXSA9IHBvc3RbInByb2ZpbGUiXVsiZGlzcGxheSJdOwogICAgICAgICAgICAgIHBvc3RfZGF0YVsicHJvZmlsZS1waWN0dXJlIl0gPSBwb3N0WyJwcm9maWxlIl1bInByb2ZpbGUtcGljdHVyZSJdOwogICAgICAgICAgICAgIHBvc3RfZGF0YVsiYmFkZ2VzIl0gPSBwb3N0WyJwcm9maWxlIl1bImJhZGdlcyJdOwogICAgICAgICAgICAgIHZhciBuZXdfcG9zdCA9IG5ldyBQb3N0KHJvdXRlciwgcG9zdF9kYXRhLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicG9zdC1jb250YWluZXIiKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKF91bnVzZWQpIHt9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChldmVudCkgewogICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7CiAgICAgIGNhY2hlID0gZGF0YTsKICAgICAgcGFyc2VjYWNoZSgpOwogICAgfSk7CiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignY2xvc2UnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgc29ja2V0ID0gbmV3IFdlYlNvY2tldChhcGlfdXJsICsgJy9wb3N0Jyk7CiAgICB9KTsKICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdvcGVuJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAnb3Bjb2RlJzogb3Bjb2RlLAogICAgICAgICdvZmZzZXQnOiBvZmZzZXQsCiAgICAgICAgInVzZXIiOiB1c2VyCiAgICAgIH0pKTsKICAgICAgb2Zmc2V0Kys7CiAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAnb3Bjb2RlJzogb3Bjb2RlLAogICAgICAgICdvZmZzZXQnOiBvZmZzZXQsCiAgICAgICAgInVzZXIiOiB1c2VyCiAgICAgIH0pKTsKICAgICAgb2Zmc2V0Kys7CiAgICAgIHdhaXRGb3JOb25OdWxsQ2FjaGUoKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIHBhcnNlY2FjaGUoKTsKICAgICAgfSk7CiAgICB9KTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXllZCIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChvcGNvZGUgPT0gNCkgewogICAgICAgIHJldHVybiAiIjsKICAgICAgfQogICAgICBvZmZzZXQgPSAwOwogICAgICBvcGNvZGUgPSA0OwogICAgICBjYWNoZSA9IG51bGw7CiAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAnb3Bjb2RlJzogb3Bjb2RlLAogICAgICAgICdvZmZzZXQnOiBvZmZzZXQsCiAgICAgICAgInVzZXIiOiB1c2VyCiAgICAgIH0pKTsKICAgICAgb2Zmc2V0Kys7CiAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAnb3Bjb2RlJzogb3Bjb2RlLAogICAgICAgICdvZmZzZXQnOiBvZmZzZXQsCiAgICAgICAgInVzZXIiOiB1c2VyCiAgICAgIH0pKTsKICAgICAgb2Zmc2V0Kys7CiAgICAgIHJlbW92ZVN0cm9uZygpOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5ZWQiKS5jbGFzc0xpc3QuYWRkKCdzdHJvbmcnKTsKICAgICAgd2FpdEZvck5vbk51bGxDYWNoZSgpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgY2xlYXJQb3N0cygpOwogICAgICAgIHBhcnNlY2FjaGUoKTsKICAgICAgfSk7CiAgICB9OwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvcHVsYXIiKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAob3Bjb2RlID09IDMpIHsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgICAgb2Zmc2V0ID0gMDsKICAgICAgb3Bjb2RlID0gMzsKICAgICAgY2FjaGUgPSBudWxsOwogICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgJ29wY29kZSc6IG9wY29kZSwKICAgICAgICAnb2Zmc2V0Jzogb2Zmc2V0LAogICAgICAgICJ1c2VyIjogdXNlcgogICAgICB9KSk7CiAgICAgIG9mZnNldCsrOwogICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgJ29wY29kZSc6IG9wY29kZSwKICAgICAgICAnb2Zmc2V0Jzogb2Zmc2V0LAogICAgICAgICJ1c2VyIjogdXNlcgogICAgICB9KSk7CiAgICAgIG9mZnNldCsrOwogICAgICByZW1vdmVTdHJvbmcoKTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvcHVsYXIiKS5jbGFzc0xpc3QuYWRkKCdzdHJvbmcnKTsKICAgICAgd2FpdEZvck5vbk51bGxDYWNoZSgpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgY2xlYXJQb3N0cygpOwogICAgICAgIHBhcnNlY2FjaGUoKTsKICAgICAgfSk7CiAgICB9OwogICAgd2luZG93Lm9uc2Nyb2xsID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2Nyb2xsSGVpZ2h0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodDsKICAgICAgdmFyIHNjcm9sbFRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldCAhPT0gdW5kZWZpbmVkID8gd2luZG93LnBhZ2VZT2Zmc2V0IDogKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCB8fCBkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUgfHwgZG9jdW1lbnQuYm9keSkuc2Nyb2xsVG9wOwogICAgICB2YXIgd2luZG93SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0OwogICAgICBpZiAoc2Nyb2xsVG9wICsgd2luZG93SGVpZ2h0ID49IHNjcm9sbEhlaWdodCkgewogICAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICdvcGNvZGUnOiBvcGNvZGUsCiAgICAgICAgICAnb2Zmc2V0Jzogb2Zmc2V0LAogICAgICAgICAgInVzZXIiOiB1c2VyCiAgICAgICAgfSkpOwogICAgICAgIG9mZnNldCsrOwogICAgICAgIHBhcnNlY2FjaGUoKTsKICAgICAgfQogICAgfTsKICB9CiAgcGFnZS5vbl9yZW5kZXIob25fcmVuZGVyKTsKICBwYWdlLnJlbmRlcigpOwp9Cgp9LHsiLi4vZWxlbWVudHMvYmFja2dyb3VuZC5tanMiOjIsIi4uL2VsZW1lbnRzL2ZvbnRzLm1qcyI6NCwiLi4vZWxlbWVudHMvZm9vdGVyLm1qcyI6NSwiLi4vZWxlbWVudHMvbmF2YmFyLm1qcyI6NiwiLi4vZWxlbWVudHMvbmV3X3Bvc3RfYnV0dG9uLm1qcyI6NywiLi4vZWxlbWVudHMvbm90aWZpY2F0aW9ucy5tanMiOjgsIi4uL2VsZW1lbnRzL3Bvc3QubWpzIjo5LCIuLi9saWIvRnJhbWV3b3JrLm1qcyI6MTAsIi4uL3NjcmlwdHMvYXBpLm1qcyI6MjksIi4uL3NjcmlwdHMvY29va2llcy5tanMiOjMwfV0sMjU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuUmVkaXJlY3QgPSBSZWRpcmVjdDsKZnVuY3Rpb24gUmVkaXJlY3Qocm91dGVyKSB7CiAgdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiLi4vbGliL0ZyYW1ld29yay5tanMiKSwKICAgIFBhZ2UgPSBfcmVxdWlyZS5QYWdlOwogIHZhciBwYWdlID0gbmV3IFBhZ2UoIlJlZGlyZWN0Iik7CiAgdmFyIGxpbmtzID0gewogICAgIi9zdGF0dXMiOiAiaHR0cHM6Ly9ibG9ja2NvaW4uYmV0dGVydXB0aW1lLmNvbS8iLAogICAgIi9kaXNjb3JkIjogImh0dHBzOi8vZGlzY29yZC5nZy9ETmt5eUM0aHNoIiwKICAgICIvYXBpIjogImh0dHBzOi8vYXBpLmJsb2NrY29pbi5zb2NpYWwiLAogICAgIi90d2l0dGVyIjogImh0dHBzOi8vdHdpdHRlci5jb20vYmxvY2tjb2luMCIsCiAgICAiL3NjcmF0Y2giOiAiaHR0cHM6Ly9zY3JhdGNoLm1pdC5lZHUvcHJvamVjdHMvODI0NjEzMjUyLyIsCiAgICAiL2RvY3MiOiAiaHR0cHM6Ly9kb2NzLmJsb2NrY29pbi5oZXJhc2l1bS5kZXYvZG9jcy9pbnRybyIKICB9OwogIHBhZ2UuaHRtbCgiIik7CiAgcGFnZS5jc3MoJycpOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKGxpbmtzW3dpbmRvdy5sb2NhdGlvbi5wYXRobmFtZV0pOwogIH0KICBwYWdlLm9uX3JlbmRlcihvbl9yZW5kZXIpOwogIHBhZ2UucmVuZGVyKCk7Cn0KCn0seyIuLi9saWIvRnJhbWV3b3JrLm1qcyI6MTB9XSwyNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5SZWdpc3RlciA9IFJlZ2lzdGVyOwpmdW5jdGlvbiBSZWdpc3Rlcihyb3V0ZXIpIHsKICB2YXIgX3JlcXVpcmUgPSByZXF1aXJlKCIuLi9saWIvRnJhbWV3b3JrLm1qcyIpLAogICAgUGFnZSA9IF9yZXF1aXJlLlBhZ2UsCiAgICBEaXNwbGF5ID0gX3JlcXVpcmUuRGlzcGxheTsKICB2YXIgX3JlcXVpcmUyID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvZm9udHMubWpzIiksCiAgICBGb250cyA9IF9yZXF1aXJlMi5Gb250czsKICB2YXIgX3JlcXVpcmUzID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvYmFja2dyb3VuZC5tanMiKSwKICAgIEJhY2tncm91bmQgPSBfcmVxdWlyZTMuQmFja2dyb3VuZDsKICB2YXIgX3JlcXVpcmU0ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvbmF2YmFyLm1qcyIpLAogICAgTmF2YmFyID0gX3JlcXVpcmU0Lk5hdmJhcjsKICB2YXIgX3JlcXVpcmU1ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvZm9vdGVyLm1qcyIpLAogICAgRm9vdGVyID0gX3JlcXVpcmU1LkZvb3RlcjsKICB2YXIgX3JlcXVpcmU2ID0gcmVxdWlyZSgiLi4vc2NyaXB0cy9hcGkubWpzIiksCiAgICBSZWdpc3RlciA9IF9yZXF1aXJlNi5SZWdpc3RlcjsKICB2YXIgX3JlcXVpcmU3ID0gcmVxdWlyZSgiLi4vZWxlbWVudHMvbm90aWZpY2F0aW9ucy5tanMiKSwKICAgIE5vdGlmaWNhdGlvbiA9IF9yZXF1aXJlNy5Ob3RpZmljYXRpb247CiAgdmFyIGRpc3BsYXkgPSBuZXcgRGlzcGxheSgpOwogIHZhciBwYWdlID0gbmV3IFBhZ2UoIlJlZ2lzdGVyIik7CiAgdmFyIGJsYW5rX2xvZ28gPSBwYWdlLmltYWdlKCJsb2dvX2JsYW5rLnN2ZyIpOwogIHZhciByZWdpc3Rlcl9idXR0b24gPSBwYWdlLmltYWdlKCJyZWdpc3Rlcl9idXR0b24uc3ZnIik7CiAgcGFnZS5jbGVhcihbImJhY2tncm91bmQiLCAibmF2YmFyIiwgImZvbnRzIiwgImZvb3RlciJdKTsKICBGb250cyhyb3V0ZXIpOwogIEJhY2tncm91bmQocm91dGVyKTsKICBOYXZiYXIocm91dGVyKTsKICBGb290ZXIocm91dGVyKTsKICBwYWdlLmh0bWwoIlxuICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXJcIj5cbiAgICAgICAgPGltZyBzcmM9XCIiLmNvbmNhdChibGFua19sb2dvLCAiXCIgYWx0PVwiQSB3aGl0ZSB2ZXJzaW9uIG9mIHRoZSBibG9ja2NvaW4gbG9nb1wiPjwvaW1nPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dFwiPldyaXRlLCBQb3N0LCBFYXJuLjwvZGl2PlxuICAgIDwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXItMlwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dCBzbWFsbFwiPlJlZ2lzdGVyPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIj5hY2NvdW50X2NpcmNsZTwvc3Bhbj5cbiAgICAgICAgICAgIDxpbnB1dCBwbGFjZWhvbGRlcj1cIlVzZXJuYW1lXCIgaWQ9XCJ1c2VybmFtZVwiIHR5cGU9XCJ0ZXh0XCI+PC9pbnB1dD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIj5tYWlsPC9zcGFuPlxuICAgICAgICAgICAgPGlucHV0IHBsYWNlaG9sZGVyPVwiRS1NYWlsXCIgaWQ9XCJjb250YWN0XCIgdHlwZT1cImVtYWlsXCI+PC9pbnB1dD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIj5wYXNzd29yZDwvc3Bhbj5cbiAgICAgICAgICAgIDxpbnB1dCBwbGFjZWhvbGRlcj1cIlBhc3N3b3JkXCIgaWQ9XCJwYXNzd29yZFwiIHR5cGU9XCJwYXNzd29yZFwiPjwvaW5wdXQ+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8aW1nIHNyYz1cIiIpLmNvbmNhdChyZWdpc3Rlcl9idXR0b24sICJcIiBhbHQ9XCJUaGUgcmVnaXN0ZXIgYnV0dG9uXCIgaWQ9XCJSZWdpc3RlclwiPjwvaW1nPlxuICAgICAgICA8YnV0dG9uIGlkPVwiTG9naW5cIj5PciBMb2dpbjwvYnV0dG9uPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dCB2ZXJ5LXNtYWxsXCI+QnkgY2xpY2tpbmcgJ1JlZ2lzdGVyJywgeW91IGFncmVlIHdpdGggQmxvY2tDb2luJ3NcbiAgICAgICAgPGEgaWQ9XCJwb2xpY3lcIiBjbGFzcz1cImctbGlua1wiPlByaXZhY3kgUG9saWN5PC9hPiBhbmRcbiAgICAgICAgPGEgaWQ9XCJ0b3NcIiBjbGFzcz1cImctbGlua1wiPlRlcm1zIG9mIFNlcnZpY2U8L2E+LjwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dCB2ZXJ5LXNtYWxsXCI+VGhpcyBzaXRlIGlzIHByb3RlY3RlZCBieSByZUNBUFRDSEEuIDxicj5UaGUgR29vZ2xlXG4gICAgICAgIDxhIGhyZWY9XCJodHRwczovL3BvbGljaWVzLmdvb2dsZS5jb20vcHJpdmFjeVwiIGNsYXNzPVwiZy1saW5rXCI+UHJpdmFjeSBQb2xpY3k8L2E+IGFuZFxuICAgICAgICA8YSBocmVmPVwiaHR0cHM6Ly9wb2xpY2llcy5nb29nbGUuY29tL3Rlcm1zXCIgY2xhc3M9XCJnLWxpbmtcIj5UZXJtcyBvZiBTZXJ2aWNlPC9hPiBhcHBseS48L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICAiKSk7CiAgcGFnZS5jc3MoIlxuICAgIC5nLWxpbmsge1xuICAgICAgICBjb2xvcjogIi5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmUgIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICAgIGN1cnNvcjpwb2ludGVyO1xuICAgIH0gXG5cbiAgICAudGV4dCB7XG4gICAgICAgIGZvbnQtZmFtaWx5OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0LWJvbGQiXSwgIjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzRdLCAiOyAvKiBBZGp1c3QgZm9udCBzaXplICovXG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICB9XG4gICAgXG4gICAgLnNtYWxsIHtcbiAgICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodC1saWdodCJdLCAiO1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bMV0sICI7XG4gICAgfVxuICAgIFxuICAgIC52ZXJ5LXNtYWxsIHtcbiAgICAgICAgbWFyZ2luOjElO1xuICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVswXSwgIjtcbiAgICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodC1saWdodCJdLCAiO1xuICAgIH1cblxuICAgIC5jb250YWluZXIge1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgdG9wOjA7XG4gICAgICAgIGxlZnQ6MDtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB3aWR0aDogNTAlO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIHotaW5kZXg6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbInotaW5kZXgiXVswXSwgIjsgLyogQWRqdXN0IHotaW5kZXggKi9cbiAgICAgICAgZ2FwOiAxMHB4O1xuICAgIH1cbiAgICBcbiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyIHtcbiAgICAgICAgd2lkdGg6IDEwcHg7XG4gICAgfVxuICAgIFxuICAgIDo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2sge1xuICAgICAgICBiYWNrZ3JvdW5kOiBub25lO1xuICAgIH1cbiAgICBcbiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHtcbiAgICAgICAgYmFja2dyb3VuZDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7IC8qIEFkanVzdCBzY3JvbGxiYXIgY29sb3IgKi9cbiAgICAgICAgYm9yZGVyLXJhZGl1czogMzYwcHg7XG4gICAgfVxuICAgIFxuICAgIDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIge1xuICAgICAgICBiYWNrZ3JvdW5kOiAjNTU1O1xuICAgIH1cbiAgICBcbiAgICAuY29udGFpbmVyLTIge1xuICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgdG9wOjA7XG4gICAgICAgIHJpZ2h0OjA7XG4gICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgd2lkdGg6IDUwJTtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICB6LWluZGV4OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJ6LWluZGV4Il1bMF0sICI7IC8qIEFkanVzdCB6LWluZGV4ICovXG4gICAgfVxuICAgIFxuICAgICNidXR0b24ge1xuICAgICAgICBib3JkZXItcmFkaXVzOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXItcmFkaXVzIl1bMl0sICI7IC8qIEFkanVzdCBib3JkZXIgcmFkaXVzICovXG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmb250LWZhbWlseTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodCJdLCAiO1xuICAgICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVszXSwgIjtcbiAgICAgICAgYmFja2dyb3VuZDogdXJsKGJvcmRlci5zdmcpO1xuICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICAgIGJveC1zaGFkb3c6IG5vbmU7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgd2lkdGg6IDM2MHB4O1xuICAgICAgICBoZWlnaHQ6IDcwcHg7XG4gICAgfVxuICAgIFxuICAgIC5mb3JtIHtcbiAgICAgICAgd2lkdGg6IDM3NXB4O1xuICAgICAgICBoZWlnaHQ6IDU1cHg7XG4gICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjsgLyogQWRqdXN0IGJvcmRlciBjb2xvciAqL1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgfVxuICAgIFxuICAgIC5mb3JtIHNwYW57XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzNdLCAiO1xuICAgIH1cbiAgICBcbiAgICAuZm9ybSBpbnB1dHtcbiAgICAgICAgYmFja2dyb3VuZDogbm9uZTtcbiAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsxXSwgIjtcbiAgICAgICAgd2lkdGg6IDgwJTtcbiAgICB9XG4gICAgXG4gICAgLmZvcm0gaW5wdXQ6Zm9jdXMge1xuICAgICAgICBvdXRsaW5lOm5vbmUhaW1wb3J0YW50O1xuICAgIH1cbiAgICBcbiAgICA6OnBsYWNlaG9sZGVyIHtcbiAgICAgICAgY29sb3I6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJjb2xvciJdLCAiO1xuICAgIH1cbiAgICBcbiAgICBwe1xuICAgICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgfVxuICAgIFxuICAgICNSZWdpc3RlciB7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgbWFyZ2luLXRvcDogMzBweDtcbiAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgICB3aWR0aDogMzMwcHg7XG4gICAgICAgIGhlaWdodDogNTNweDtcbiAgICB9XG4gICAgXG4gICAgI0xvZ2luIHtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBiYWNrZ3JvdW5kOiBub25lO1xuICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICAgIGZvbnQtZmFtaWx5OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzJdLCAiO1xuICAgICAgICBtYXJnaW4tdG9wOiA1cHg7XG4gICAgfVxuICAgIFxuICAgICNtb2NrdXAge1xuICAgICAgICBjb250ZW50OiB1cmwoTW9ja3VwMy5wbmcpO1xuICAgIH1cbiAgICBcbiAgICBAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiAxMjcwcHgpe1xuICAgICAgICAjbW9ja3VwIHtcbiAgICAgICAgICAgIGNvbnRlbnQ6IHVybChNb2NrdXBGcm9udC5wbmcpO1xuICAgICAgICB9XG4gICAgICAgIC5jb250YWluZXIge1xuICAgICAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlOyBcbiAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgfVxuICAgICAgICAuY29udGFpbmVyLTIge1xuICAgICAgICAgICAgd2lkdGg6MTAwJTtcbiAgICAgICAgfVxuICAgICAgICBmb290ZXIge1xuICAgICAgICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG4gICAgICAgICAgICB0b3A6MTUwJTtcbiAgICAgICAgfVxuICAgICAgICAjY29weSB7XG4gICAgICAgICAgICB0b3A6MTAwJVxuICAgICAgICB9XG4gICAgICAgIC5lbGlwc2Uge1xuICAgICAgICAgICAgaGVpZ2h0OiA0OHZ3O1xuICAgICAgICAgICAgd2lkdGg6IDQ4dnc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgQG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDogNjUwcHgpe1xuICAgICAgICAuYmlnIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTAuN3Z3O1xuICAgICAgICB9XG4gICAgICAgIC5zbWFsbCB7XG4gICAgICAgICAgICBmb250LXNpemU6IDQuNnZ3O1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIEBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDU1MHB4KXtcbiAgICAgICAgI25hdmJhciB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDIwcHg7XG4gICAgICAgIH1cbiAgICAgICAgLmNvbnRhaW5lci0zIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDtcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgfVxuICAgICAgICAudHJhbnMtYnV0dG9uIHtcbiAgICAgICAgICAgIHdpZHRoOiAzMCU7XG4gICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgIH1cbiAgICAgICAgI2NvcHkge1xuICAgICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgICAgdG9wOjA7XG4gICAgICAgICAgICB3aWR0aDoxMDAlO1xuICAgICAgICAgICAgbGVmdDowO1xuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICB9XG4gICAgICAgIC5jb250YWluZXItbGlua3Mge1xuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAwcHg7XG4gICAgICAgIH1cbiAgICAgICAgLmNvbnRhaW5lci10aXRsZXMge1xuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAwcHg7XG4gICAgICAgIH1cbiAgICAgICAgZm9vdGVyIHtcbiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICAgICAgICBoZWlnaHQ6IDIwJTtcbiAgICAgICAgfVxuICAgICAgICAuY29udGFpbmVyLTR7XG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBib3R0b206IDMwJTtcbiAgICAgICAgfVxuICAgIH1cbiIpKTsKICBwYWdlLmRlbGV0ZV9hbmltYXRpb24oIlxuICAgIEBrZXlmcmFtZXMgZGVsZXRlIHtcbiAgICAgICAgMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxMCUpOyAvKiBBZGp1c3QgdGhlIGRpc3RhbmNlIHlvdSB3YW50IHRvIG1vdmUgb24gdGhlIHktYXhpcyAqL1xuICAgICAgICB9XG4gICAgICB9XG4gICAgIik7CiAgcGFnZS5zcGF3bl9hbmltYXRpb24oIlxuICAgIEBrZXlmcmFtZXMgc3Bhd24ge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMDtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwJSk7XG4gICAgICAgIH1cbiAgICAgICAgMTAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBmdW5jdGlvbiBvbl9yZW5kZXIoKSB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTG9naW4iKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICByb3V0ZXIubmF2aWdhdGVUbygiL2xvZ2luIik7CiAgICB9OwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvbGljeSIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvbGVnYWwvcG9saWN5Iik7CiAgICB9OwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRvcyIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJvdXRlci5uYXZpZ2F0ZVRvKCIvbGVnYWwvdG9zIik7CiAgICB9OwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlJlZ2lzdGVyIikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgZ3JlY2FwdGNoYS5yZWFkeShmdW5jdGlvbiAoKSB7CiAgICAgICAgZ3JlY2FwdGNoYS5leGVjdXRlKCc2TGYxbjRJb0FBQUFBRVhGRWVsMUJma3hIcmN1ekpVSk5mUGlGQTNxJywgewogICAgICAgICAgYWN0aW9uOiAnc3VibWl0JwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRva2VuKSB7CiAgICAgICAgICBSZWdpc3Rlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWUnKS52YWx1ZSwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhY3QnKS52YWx1ZSwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkJykudmFsdWUsIHRva2VuKS50aGVuKGZ1bmN0aW9uIChzdWNjZXNzKSB7CiAgICAgICAgICAgIGlmIChzdWNjZXNzID09IHRydWUpIHsKICAgICAgICAgICAgICByb3V0ZXIubmF2aWdhdGVUbygiL2V4cGxvcmUiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBOb3RpZmljYXRpb24oMSwgc3VjY2Vzcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBkdXJpbmcgcmVnaXN0cmF0aW9uOiIsIGVycm9yKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH07CiAgfQogIHBhZ2Uub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIjoyLCIuLi9lbGVtZW50cy9mb250cy5tanMiOjQsIi4uL2VsZW1lbnRzL2Zvb3Rlci5tanMiOjUsIi4uL2VsZW1lbnRzL25hdmJhci5tanMiOjYsIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIjo4LCIuLi9saWIvRnJhbWV3b3JrLm1qcyI6MTAsIi4uL3NjcmlwdHMvYXBpLm1qcyI6Mjl9XSwyNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCmZ1bmN0aW9uIF90eXBlb2YobykgeyAiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2YiOyByZXR1cm4gX3R5cGVvZiA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiAic3ltYm9sIiA9PSB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID8gZnVuY3Rpb24gKG8pIHsgcmV0dXJuIHR5cGVvZiBvOyB9IDogZnVuY3Rpb24gKG8pIHsgcmV0dXJuIG8gJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG8uY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2YgbzsgfSwgX3R5cGVvZihvKTsgfQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuU2V0dGluZ3MgPSBTZXR0aW5nczsKZnVuY3Rpb24gX3JlZ2VuZXJhdG9yUnVudGltZSgpIHsgInVzZSBzdHJpY3QiOyAvKiEgcmVnZW5lcmF0b3ItcnVudGltZSAtLSBDb3B5cmlnaHQgKGMpIDIwMTQtcHJlc2VudCwgRmFjZWJvb2ssIEluYy4gLS0gbGljZW5zZSAoTUlUKTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlZ2VuZXJhdG9yL2Jsb2IvbWFpbi9MSUNFTlNFICovIF9yZWdlbmVyYXRvclJ1bnRpbWUgPSBmdW5jdGlvbiBfcmVnZW5lcmF0b3JSdW50aW1lKCkgeyByZXR1cm4gZTsgfTsgdmFyIHQsIGUgPSB7fSwgciA9IE9iamVjdC5wcm90b3R5cGUsIG4gPSByLmhhc093blByb3BlcnR5LCBvID0gT2JqZWN0LmRlZmluZVByb3BlcnR5IHx8IGZ1bmN0aW9uICh0LCBlLCByKSB7IHRbZV0gPSByLnZhbHVlOyB9LCBpID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sID8gU3ltYm9sIDoge30sIGEgPSBpLml0ZXJhdG9yIHx8ICJAQGl0ZXJhdG9yIiwgYyA9IGkuYXN5bmNJdGVyYXRvciB8fCAiQEBhc3luY0l0ZXJhdG9yIiwgdSA9IGkudG9TdHJpbmdUYWcgfHwgIkBAdG9TdHJpbmdUYWciOyBmdW5jdGlvbiBkZWZpbmUodCwgZSwgcikgeyByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIGUsIHsgdmFsdWU6IHIsIGVudW1lcmFibGU6ICEwLCBjb25maWd1cmFibGU6ICEwLCB3cml0YWJsZTogITAgfSksIHRbZV07IH0gdHJ5IHsgZGVmaW5lKHt9LCAiIik7IH0gY2F0Y2ggKHQpIHsgZGVmaW5lID0gZnVuY3Rpb24gZGVmaW5lKHQsIGUsIHIpIHsgcmV0dXJuIHRbZV0gPSByOyB9OyB9IGZ1bmN0aW9uIHdyYXAodCwgZSwgciwgbikgeyB2YXIgaSA9IGUgJiYgZS5wcm90b3R5cGUgaW5zdGFuY2VvZiBHZW5lcmF0b3IgPyBlIDogR2VuZXJhdG9yLCBhID0gT2JqZWN0LmNyZWF0ZShpLnByb3RvdHlwZSksIGMgPSBuZXcgQ29udGV4dChuIHx8IFtdKTsgcmV0dXJuIG8oYSwgIl9pbnZva2UiLCB7IHZhbHVlOiBtYWtlSW52b2tlTWV0aG9kKHQsIHIsIGMpIH0pLCBhOyB9IGZ1bmN0aW9uIHRyeUNhdGNoKHQsIGUsIHIpIHsgdHJ5IHsgcmV0dXJuIHsgdHlwZTogIm5vcm1hbCIsIGFyZzogdC5jYWxsKGUsIHIpIH07IH0gY2F0Y2ggKHQpIHsgcmV0dXJuIHsgdHlwZTogInRocm93IiwgYXJnOiB0IH07IH0gfSBlLndyYXAgPSB3cmFwOyB2YXIgaCA9ICJzdXNwZW5kZWRTdGFydCIsIGwgPSAic3VzcGVuZGVkWWllbGQiLCBmID0gImV4ZWN1dGluZyIsIHMgPSAiY29tcGxldGVkIiwgeSA9IHt9OyBmdW5jdGlvbiBHZW5lcmF0b3IoKSB7fSBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvbigpIHt9IGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKCkge30gdmFyIHAgPSB7fTsgZGVmaW5lKHAsIGEsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0pOyB2YXIgZCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiwgdiA9IGQgJiYgZChkKHZhbHVlcyhbXSkpKTsgdiAmJiB2ICE9PSByICYmIG4uY2FsbCh2LCBhKSAmJiAocCA9IHYpOyB2YXIgZyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLnByb3RvdHlwZSA9IEdlbmVyYXRvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHApOyBmdW5jdGlvbiBkZWZpbmVJdGVyYXRvck1ldGhvZHModCkgeyBbIm5leHQiLCAidGhyb3ciLCAicmV0dXJuIl0uZm9yRWFjaChmdW5jdGlvbiAoZSkgeyBkZWZpbmUodCwgZSwgZnVuY3Rpb24gKHQpIHsgcmV0dXJuIHRoaXMuX2ludm9rZShlLCB0KTsgfSk7IH0pOyB9IGZ1bmN0aW9uIEFzeW5jSXRlcmF0b3IodCwgZSkgeyBmdW5jdGlvbiBpbnZva2UociwgbywgaSwgYSkgeyB2YXIgYyA9IHRyeUNhdGNoKHRbcl0sIHQsIG8pOyBpZiAoInRocm93IiAhPT0gYy50eXBlKSB7IHZhciB1ID0gYy5hcmcsIGggPSB1LnZhbHVlOyByZXR1cm4gaCAmJiAib2JqZWN0IiA9PSBfdHlwZW9mKGgpICYmIG4uY2FsbChoLCAiX19hd2FpdCIpID8gZS5yZXNvbHZlKGguX19hd2FpdCkudGhlbihmdW5jdGlvbiAodCkgeyBpbnZva2UoIm5leHQiLCB0LCBpLCBhKTsgfSwgZnVuY3Rpb24gKHQpIHsgaW52b2tlKCJ0aHJvdyIsIHQsIGksIGEpOyB9KSA6IGUucmVzb2x2ZShoKS50aGVuKGZ1bmN0aW9uICh0KSB7IHUudmFsdWUgPSB0LCBpKHUpOyB9LCBmdW5jdGlvbiAodCkgeyByZXR1cm4gaW52b2tlKCJ0aHJvdyIsIHQsIGksIGEpOyB9KTsgfSBhKGMuYXJnKTsgfSB2YXIgcjsgbyh0aGlzLCAiX2ludm9rZSIsIHsgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQsIG4pIHsgZnVuY3Rpb24gY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKSB7IHJldHVybiBuZXcgZShmdW5jdGlvbiAoZSwgcikgeyBpbnZva2UodCwgbiwgZSwgcik7IH0pOyB9IHJldHVybiByID0gciA/IHIudGhlbihjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZywgY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcpIDogY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKTsgfSB9KTsgfSBmdW5jdGlvbiBtYWtlSW52b2tlTWV0aG9kKGUsIHIsIG4pIHsgdmFyIG8gPSBoOyByZXR1cm4gZnVuY3Rpb24gKGksIGEpIHsgaWYgKG8gPT09IGYpIHRocm93IG5ldyBFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgcnVubmluZyIpOyBpZiAobyA9PT0gcykgeyBpZiAoInRocm93IiA9PT0gaSkgdGhyb3cgYTsgcmV0dXJuIHsgdmFsdWU6IHQsIGRvbmU6ICEwIH07IH0gZm9yIChuLm1ldGhvZCA9IGksIG4uYXJnID0gYTs7KSB7IHZhciBjID0gbi5kZWxlZ2F0ZTsgaWYgKGMpIHsgdmFyIHUgPSBtYXliZUludm9rZURlbGVnYXRlKGMsIG4pOyBpZiAodSkgeyBpZiAodSA9PT0geSkgY29udGludWU7IHJldHVybiB1OyB9IH0gaWYgKCJuZXh0IiA9PT0gbi5tZXRob2QpIG4uc2VudCA9IG4uX3NlbnQgPSBuLmFyZztlbHNlIGlmICgidGhyb3ciID09PSBuLm1ldGhvZCkgeyBpZiAobyA9PT0gaCkgdGhyb3cgbyA9IHMsIG4uYXJnOyBuLmRpc3BhdGNoRXhjZXB0aW9uKG4uYXJnKTsgfSBlbHNlICJyZXR1cm4iID09PSBuLm1ldGhvZCAmJiBuLmFicnVwdCgicmV0dXJuIiwgbi5hcmcpOyBvID0gZjsgdmFyIHAgPSB0cnlDYXRjaChlLCByLCBuKTsgaWYgKCJub3JtYWwiID09PSBwLnR5cGUpIHsgaWYgKG8gPSBuLmRvbmUgPyBzIDogbCwgcC5hcmcgPT09IHkpIGNvbnRpbnVlOyByZXR1cm4geyB2YWx1ZTogcC5hcmcsIGRvbmU6IG4uZG9uZSB9OyB9ICJ0aHJvdyIgPT09IHAudHlwZSAmJiAobyA9IHMsIG4ubWV0aG9kID0gInRocm93Iiwgbi5hcmcgPSBwLmFyZyk7IH0gfTsgfSBmdW5jdGlvbiBtYXliZUludm9rZURlbGVnYXRlKGUsIHIpIHsgdmFyIG4gPSByLm1ldGhvZCwgbyA9IGUuaXRlcmF0b3Jbbl07IGlmIChvID09PSB0KSByZXR1cm4gci5kZWxlZ2F0ZSA9IG51bGwsICJ0aHJvdyIgPT09IG4gJiYgZS5pdGVyYXRvclsicmV0dXJuIl0gJiYgKHIubWV0aG9kID0gInJldHVybiIsIHIuYXJnID0gdCwgbWF5YmVJbnZva2VEZWxlZ2F0ZShlLCByKSwgInRocm93IiA9PT0gci5tZXRob2QpIHx8ICJyZXR1cm4iICE9PSBuICYmIChyLm1ldGhvZCA9ICJ0aHJvdyIsIHIuYXJnID0gbmV3IFR5cGVFcnJvcigiVGhlIGl0ZXJhdG9yIGRvZXMgbm90IHByb3ZpZGUgYSAnIiArIG4gKyAiJyBtZXRob2QiKSksIHk7IHZhciBpID0gdHJ5Q2F0Y2gobywgZS5pdGVyYXRvciwgci5hcmcpOyBpZiAoInRocm93IiA9PT0gaS50eXBlKSByZXR1cm4gci5tZXRob2QgPSAidGhyb3ciLCByLmFyZyA9IGkuYXJnLCByLmRlbGVnYXRlID0gbnVsbCwgeTsgdmFyIGEgPSBpLmFyZzsgcmV0dXJuIGEgPyBhLmRvbmUgPyAocltlLnJlc3VsdE5hbWVdID0gYS52YWx1ZSwgci5uZXh0ID0gZS5uZXh0TG9jLCAicmV0dXJuIiAhPT0gci5tZXRob2QgJiYgKHIubWV0aG9kID0gIm5leHQiLCByLmFyZyA9IHQpLCByLmRlbGVnYXRlID0gbnVsbCwgeSkgOiBhIDogKHIubWV0aG9kID0gInRocm93Iiwgci5hcmcgPSBuZXcgVHlwZUVycm9yKCJpdGVyYXRvciByZXN1bHQgaXMgbm90IGFuIG9iamVjdCIpLCByLmRlbGVnYXRlID0gbnVsbCwgeSk7IH0gZnVuY3Rpb24gcHVzaFRyeUVudHJ5KHQpIHsgdmFyIGUgPSB7IHRyeUxvYzogdFswXSB9OyAxIGluIHQgJiYgKGUuY2F0Y2hMb2MgPSB0WzFdKSwgMiBpbiB0ICYmIChlLmZpbmFsbHlMb2MgPSB0WzJdLCBlLmFmdGVyTG9jID0gdFszXSksIHRoaXMudHJ5RW50cmllcy5wdXNoKGUpOyB9IGZ1bmN0aW9uIHJlc2V0VHJ5RW50cnkodCkgeyB2YXIgZSA9IHQuY29tcGxldGlvbiB8fCB7fTsgZS50eXBlID0gIm5vcm1hbCIsIGRlbGV0ZSBlLmFyZywgdC5jb21wbGV0aW9uID0gZTsgfSBmdW5jdGlvbiBDb250ZXh0KHQpIHsgdGhpcy50cnlFbnRyaWVzID0gW3sgdHJ5TG9jOiAicm9vdCIgfV0sIHQuZm9yRWFjaChwdXNoVHJ5RW50cnksIHRoaXMpLCB0aGlzLnJlc2V0KCEwKTsgfSBmdW5jdGlvbiB2YWx1ZXMoZSkgeyBpZiAoZSB8fCAiIiA9PT0gZSkgeyB2YXIgciA9IGVbYV07IGlmIChyKSByZXR1cm4gci5jYWxsKGUpOyBpZiAoImZ1bmN0aW9uIiA9PSB0eXBlb2YgZS5uZXh0KSByZXR1cm4gZTsgaWYgKCFpc05hTihlLmxlbmd0aCkpIHsgdmFyIG8gPSAtMSwgaSA9IGZ1bmN0aW9uIG5leHQoKSB7IGZvciAoOyArK28gPCBlLmxlbmd0aDspIGlmIChuLmNhbGwoZSwgbykpIHJldHVybiBuZXh0LnZhbHVlID0gZVtvXSwgbmV4dC5kb25lID0gITEsIG5leHQ7IHJldHVybiBuZXh0LnZhbHVlID0gdCwgbmV4dC5kb25lID0gITAsIG5leHQ7IH07IHJldHVybiBpLm5leHQgPSBpOyB9IH0gdGhyb3cgbmV3IFR5cGVFcnJvcihfdHlwZW9mKGUpICsgIiBpcyBub3QgaXRlcmFibGUiKTsgfSByZXR1cm4gR2VuZXJhdG9yRnVuY3Rpb24ucHJvdG90eXBlID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIG8oZywgImNvbnN0cnVjdG9yIiwgeyB2YWx1ZTogR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIGNvbmZpZ3VyYWJsZTogITAgfSksIG8oR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsICJjb25zdHJ1Y3RvciIsIHsgdmFsdWU6IEdlbmVyYXRvckZ1bmN0aW9uLCBjb25maWd1cmFibGU6ICEwIH0pLCBHZW5lcmF0b3JGdW5jdGlvbi5kaXNwbGF5TmFtZSA9IGRlZmluZShHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgdSwgIkdlbmVyYXRvckZ1bmN0aW9uIiksIGUuaXNHZW5lcmF0b3JGdW5jdGlvbiA9IGZ1bmN0aW9uICh0KSB7IHZhciBlID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgdCAmJiB0LmNvbnN0cnVjdG9yOyByZXR1cm4gISFlICYmIChlID09PSBHZW5lcmF0b3JGdW5jdGlvbiB8fCAiR2VuZXJhdG9yRnVuY3Rpb24iID09PSAoZS5kaXNwbGF5TmFtZSB8fCBlLm5hbWUpKTsgfSwgZS5tYXJrID0gZnVuY3Rpb24gKHQpIHsgcmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZih0LCBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSkgOiAodC5fX3Byb3RvX18gPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgZGVmaW5lKHQsIHUsICJHZW5lcmF0b3JGdW5jdGlvbiIpKSwgdC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKGcpLCB0OyB9LCBlLmF3cmFwID0gZnVuY3Rpb24gKHQpIHsgcmV0dXJuIHsgX19hd2FpdDogdCB9OyB9LCBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpLCBkZWZpbmUoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUsIGMsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0pLCBlLkFzeW5jSXRlcmF0b3IgPSBBc3luY0l0ZXJhdG9yLCBlLmFzeW5jID0gZnVuY3Rpb24gKHQsIHIsIG4sIG8sIGkpIHsgdm9pZCAwID09PSBpICYmIChpID0gUHJvbWlzZSk7IHZhciBhID0gbmV3IEFzeW5jSXRlcmF0b3Iod3JhcCh0LCByLCBuLCBvKSwgaSk7IHJldHVybiBlLmlzR2VuZXJhdG9yRnVuY3Rpb24ocikgPyBhIDogYS5uZXh0KCkudGhlbihmdW5jdGlvbiAodCkgeyByZXR1cm4gdC5kb25lID8gdC52YWx1ZSA6IGEubmV4dCgpOyB9KTsgfSwgZGVmaW5lSXRlcmF0b3JNZXRob2RzKGcpLCBkZWZpbmUoZywgdSwgIkdlbmVyYXRvciIpLCBkZWZpbmUoZywgYSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSksIGRlZmluZShnLCAidG9TdHJpbmciLCBmdW5jdGlvbiAoKSB7IHJldHVybiAiW29iamVjdCBHZW5lcmF0b3JdIjsgfSksIGUua2V5cyA9IGZ1bmN0aW9uICh0KSB7IHZhciBlID0gT2JqZWN0KHQpLCByID0gW107IGZvciAodmFyIG4gaW4gZSkgci5wdXNoKG4pOyByZXR1cm4gci5yZXZlcnNlKCksIGZ1bmN0aW9uIG5leHQoKSB7IGZvciAoOyByLmxlbmd0aDspIHsgdmFyIHQgPSByLnBvcCgpOyBpZiAodCBpbiBlKSByZXR1cm4gbmV4dC52YWx1ZSA9IHQsIG5leHQuZG9uZSA9ICExLCBuZXh0OyB9IHJldHVybiBuZXh0LmRvbmUgPSAhMCwgbmV4dDsgfTsgfSwgZS52YWx1ZXMgPSB2YWx1ZXMsIENvbnRleHQucHJvdG90eXBlID0geyBjb25zdHJ1Y3RvcjogQ29udGV4dCwgcmVzZXQ6IGZ1bmN0aW9uIHJlc2V0KGUpIHsgaWYgKHRoaXMucHJldiA9IDAsIHRoaXMubmV4dCA9IDAsIHRoaXMuc2VudCA9IHRoaXMuX3NlbnQgPSB0LCB0aGlzLmRvbmUgPSAhMSwgdGhpcy5kZWxlZ2F0ZSA9IG51bGwsIHRoaXMubWV0aG9kID0gIm5leHQiLCB0aGlzLmFyZyA9IHQsIHRoaXMudHJ5RW50cmllcy5mb3JFYWNoKHJlc2V0VHJ5RW50cnkpLCAhZSkgZm9yICh2YXIgciBpbiB0aGlzKSAidCIgPT09IHIuY2hhckF0KDApICYmIG4uY2FsbCh0aGlzLCByKSAmJiAhaXNOYU4oK3Iuc2xpY2UoMSkpICYmICh0aGlzW3JdID0gdCk7IH0sIHN0b3A6IGZ1bmN0aW9uIHN0b3AoKSB7IHRoaXMuZG9uZSA9ICEwOyB2YXIgdCA9IHRoaXMudHJ5RW50cmllc1swXS5jb21wbGV0aW9uOyBpZiAoInRocm93IiA9PT0gdC50eXBlKSB0aHJvdyB0LmFyZzsgcmV0dXJuIHRoaXMucnZhbDsgfSwgZGlzcGF0Y2hFeGNlcHRpb246IGZ1bmN0aW9uIGRpc3BhdGNoRXhjZXB0aW9uKGUpIHsgaWYgKHRoaXMuZG9uZSkgdGhyb3cgZTsgdmFyIHIgPSB0aGlzOyBmdW5jdGlvbiBoYW5kbGUobiwgbykgeyByZXR1cm4gYS50eXBlID0gInRocm93IiwgYS5hcmcgPSBlLCByLm5leHQgPSBuLCBvICYmIChyLm1ldGhvZCA9ICJuZXh0Iiwgci5hcmcgPSB0KSwgISFvOyB9IGZvciAodmFyIG8gPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgbyA+PSAwOyAtLW8pIHsgdmFyIGkgPSB0aGlzLnRyeUVudHJpZXNbb10sIGEgPSBpLmNvbXBsZXRpb247IGlmICgicm9vdCIgPT09IGkudHJ5TG9jKSByZXR1cm4gaGFuZGxlKCJlbmQiKTsgaWYgKGkudHJ5TG9jIDw9IHRoaXMucHJldikgeyB2YXIgYyA9IG4uY2FsbChpLCAiY2F0Y2hMb2MiKSwgdSA9IG4uY2FsbChpLCAiZmluYWxseUxvYyIpOyBpZiAoYyAmJiB1KSB7IGlmICh0aGlzLnByZXYgPCBpLmNhdGNoTG9jKSByZXR1cm4gaGFuZGxlKGkuY2F0Y2hMb2MsICEwKTsgaWYgKHRoaXMucHJldiA8IGkuZmluYWxseUxvYykgcmV0dXJuIGhhbmRsZShpLmZpbmFsbHlMb2MpOyB9IGVsc2UgaWYgKGMpIHsgaWYgKHRoaXMucHJldiA8IGkuY2F0Y2hMb2MpIHJldHVybiBoYW5kbGUoaS5jYXRjaExvYywgITApOyB9IGVsc2UgeyBpZiAoIXUpIHRocm93IG5ldyBFcnJvcigidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHkiKTsgaWYgKHRoaXMucHJldiA8IGkuZmluYWxseUxvYykgcmV0dXJuIGhhbmRsZShpLmZpbmFsbHlMb2MpOyB9IH0gfSB9LCBhYnJ1cHQ6IGZ1bmN0aW9uIGFicnVwdCh0LCBlKSB7IGZvciAodmFyIHIgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgciA+PSAwOyAtLXIpIHsgdmFyIG8gPSB0aGlzLnRyeUVudHJpZXNbcl07IGlmIChvLnRyeUxvYyA8PSB0aGlzLnByZXYgJiYgbi5jYWxsKG8sICJmaW5hbGx5TG9jIikgJiYgdGhpcy5wcmV2IDwgby5maW5hbGx5TG9jKSB7IHZhciBpID0gbzsgYnJlYWs7IH0gfSBpICYmICgiYnJlYWsiID09PSB0IHx8ICJjb250aW51ZSIgPT09IHQpICYmIGkudHJ5TG9jIDw9IGUgJiYgZSA8PSBpLmZpbmFsbHlMb2MgJiYgKGkgPSBudWxsKTsgdmFyIGEgPSBpID8gaS5jb21wbGV0aW9uIDoge307IHJldHVybiBhLnR5cGUgPSB0LCBhLmFyZyA9IGUsIGkgPyAodGhpcy5tZXRob2QgPSAibmV4dCIsIHRoaXMubmV4dCA9IGkuZmluYWxseUxvYywgeSkgOiB0aGlzLmNvbXBsZXRlKGEpOyB9LCBjb21wbGV0ZTogZnVuY3Rpb24gY29tcGxldGUodCwgZSkgeyBpZiAoInRocm93IiA9PT0gdC50eXBlKSB0aHJvdyB0LmFyZzsgcmV0dXJuICJicmVhayIgPT09IHQudHlwZSB8fCAiY29udGludWUiID09PSB0LnR5cGUgPyB0aGlzLm5leHQgPSB0LmFyZyA6ICJyZXR1cm4iID09PSB0LnR5cGUgPyAodGhpcy5ydmFsID0gdGhpcy5hcmcgPSB0LmFyZywgdGhpcy5tZXRob2QgPSAicmV0dXJuIiwgdGhpcy5uZXh0ID0gImVuZCIpIDogIm5vcm1hbCIgPT09IHQudHlwZSAmJiBlICYmICh0aGlzLm5leHQgPSBlKSwgeTsgfSwgZmluaXNoOiBmdW5jdGlvbiBmaW5pc2godCkgeyBmb3IgKHZhciBlID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGUgPj0gMDsgLS1lKSB7IHZhciByID0gdGhpcy50cnlFbnRyaWVzW2VdOyBpZiAoci5maW5hbGx5TG9jID09PSB0KSByZXR1cm4gdGhpcy5jb21wbGV0ZShyLmNvbXBsZXRpb24sIHIuYWZ0ZXJMb2MpLCByZXNldFRyeUVudHJ5KHIpLCB5OyB9IH0sICJjYXRjaCI6IGZ1bmN0aW9uIF9jYXRjaCh0KSB7IGZvciAodmFyIGUgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgZSA+PSAwOyAtLWUpIHsgdmFyIHIgPSB0aGlzLnRyeUVudHJpZXNbZV07IGlmIChyLnRyeUxvYyA9PT0gdCkgeyB2YXIgbiA9IHIuY29tcGxldGlvbjsgaWYgKCJ0aHJvdyIgPT09IG4udHlwZSkgeyB2YXIgbyA9IG4uYXJnOyByZXNldFRyeUVudHJ5KHIpOyB9IHJldHVybiBvOyB9IH0gdGhyb3cgbmV3IEVycm9yKCJpbGxlZ2FsIGNhdGNoIGF0dGVtcHQiKTsgfSwgZGVsZWdhdGVZaWVsZDogZnVuY3Rpb24gZGVsZWdhdGVZaWVsZChlLCByLCBuKSB7IHJldHVybiB0aGlzLmRlbGVnYXRlID0geyBpdGVyYXRvcjogdmFsdWVzKGUpLCByZXN1bHROYW1lOiByLCBuZXh0TG9jOiBuIH0sICJuZXh0IiA9PT0gdGhpcy5tZXRob2QgJiYgKHRoaXMuYXJnID0gdCksIHk7IH0gfSwgZTsgfQpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CmZ1bmN0aW9uIFNldHRpbmdzKHJvdXRlcikgewogIHZhciBfcmVxdWlyZSA9IHJlcXVpcmUoIi4uL2xpYi9GcmFtZXdvcmsubWpzIiksCiAgICBQYWdlID0gX3JlcXVpcmUuUGFnZSwKICAgIERpc3BsYXkgPSBfcmVxdWlyZS5EaXNwbGF5OwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb250cy5tanMiKSwKICAgIEZvbnRzID0gX3JlcXVpcmUyLkZvbnRzOwogIHZhciBfcmVxdWlyZTMgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyIpLAogICAgQmFja2dyb3VuZCA9IF9yZXF1aXJlMy5CYWNrZ3JvdW5kOwogIHZhciBfcmVxdWlyZTQgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIiksCiAgICBOYXZiYXIgPSBfcmVxdWlyZTQuTmF2YmFyOwogIHZhciBfcmVxdWlyZTUgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9wb3N0Lm1qcyIpLAogICAgUG9zdCA9IF9yZXF1aXJlNS5Qb3N0OwogIHZhciBfcmVxdWlyZTYgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlNi5Jc0xvZ2VkSW4sCiAgICBVcGRhdGVBYm91dCA9IF9yZXF1aXJlNi5VcGRhdGVBYm91dCwKICAgIFVwZGF0ZUJhbm5lciA9IF9yZXF1aXJlNi5VcGRhdGVCYW5uZXIsCiAgICBVcGRhdGVEaXNwbGF5ID0gX3JlcXVpcmU2LlVwZGF0ZURpc3BsYXksCiAgICBVcGRhdGVFbWFpbCA9IF9yZXF1aXJlNi5VcGRhdGVFbWFpbCwKICAgIFVwZGF0ZVBhc3N3b3JkID0gX3JlcXVpcmU2LlVwZGF0ZVBhc3N3b3JkLAogICAgVXBkYXRlUHJvZmlsZVBpY3R1cmUgPSBfcmVxdWlyZTYuVXBkYXRlUHJvZmlsZVBpY3R1cmUsCiAgICBHZXRQcm9maWxlID0gX3JlcXVpcmU2LkdldFByb2ZpbGU7CiAgdmFyIF9yZXF1aXJlNyA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIiksCiAgICBOb3RpZmljYXRpb24gPSBfcmVxdWlyZTcuTm90aWZpY2F0aW9uOwogIHZhciBfcmVxdWlyZTggPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uZXdfcG9zdF9idXR0b24ubWpzIiksCiAgICBOZXdQb3N0QnV0dG9uID0gX3JlcXVpcmU4Lk5ld1Bvc3RCdXR0b247CiAgdmFyIF9yZXF1aXJlOSA9IHJlcXVpcmUoIi4uL3NjcmlwdHMvY29va2llcy5tanMiKSwKICAgIHNldENvb2tpZSA9IF9yZXF1aXJlOS5zZXRDb29raWUsCiAgICBnZXRDb29raWUgPSBfcmVxdWlyZTkuZ2V0Q29va2llLAogICAgY2hlY2tDb29raWUgPSBfcmVxdWlyZTkuY2hlY2tDb29raWU7CiAgaWYgKElzTG9nZWRJbigpID09IGZhbHNlKSB7CiAgICBOb3RpZmljYXRpb24oMSwgIllvdSBuZWVkIHRvIGJlIGxvZ2dlZCBpbiB0byBhY2Nlc3MgdGhpcyBwYWdlLiIpOwogICAgcm91dGVyLm5hdmlnYXRlVG8oIi9leHBsb3JlIik7CiAgICByZXR1cm4gIiI7CiAgfQogIHZhciBkaXNwbGF5ID0gbmV3IERpc3BsYXkoKTsKICB2YXIgcGFnZSA9IG5ldyBQYWdlKCJTZXR0aW5ncyIpOwogIHBhZ2UuY2xlYXIoWyJiYWNrZ3JvdW5kIiwgIm5hdmJhciIsICJmb250cyIsICJuZXdfcG9zdF9idXR0b24iXSk7CiAgRm9udHMocm91dGVyKTsKICBCYWNrZ3JvdW5kKHJvdXRlcik7CiAgTmF2YmFyKHJvdXRlcik7CiAgTmV3UG9zdEJ1dHRvbihyb3V0ZXIpOwogIHBhZ2UuaHRtbCgiXG4gICAgICA8ZGl2IGlkPVwic2V0dGluZ3MtY29udGFpbmVyXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0aXRsZVwiPlByb2ZpbGU8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInRleHQtc2V0dGluZ3NcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwic2V0dGluZ3MtbmFtZSB0ZXh0LW5hbWVcIj5EaXNwbGF5IE5hbWU8L2Rpdj5cbiAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0ZXh0LWlucHV0XCIgIGlkPVwiZGlzcGxheVwiID48L2lucHV0PlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJzZXR0aW5ncy1idXR0b25cIiBpZD1cImRpc3BsYXktY2hhbmdlXCIgPlNhdmU8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0LXNldHRpbmdzXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInNldHRpbmdzLW5hbWUgdGV4dC1uYW1lXCI+QWJvdXQgTWU8L2Rpdj5cbiAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0ZXh0LWlucHV0XCIgIGlkPVwiYWJvdXRcIiA+PC9pbnB1dD5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwic2V0dGluZ3MtYnV0dG9uXCIgIGlkPVwiYWJvdXQtY2hhbmdlXCIgID5TYXZlPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaW1hZ2Utc2V0dGluZ3NcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW1nLXR4dFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNldHRpbmdzLW5hbWUgaW1nLW5hbWVcIj5Qcm9maWxlIFBpY3R1cmU8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzZXR0aW5ncy1idXR0b25cIiAgaWQ9XCJpY29uLWNoYW5nZVwiICA+Q2hhbmdlPC9kaXY+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cImZpbGVcIiBpZD1cImZpbGVJbnB1dFwiIGFjY2VwdD1cIi5wbmcsLmpwZywuanBlZywud2VicFwiIHN0eWxlPVwiZGlzcGxheTogbm9uZTtcIj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW1nLWltZ1wiPlxuICAgICAgICAgICAgPGltZyBjbGFzcz1cInNldHRpbmdzLWltZ1wiIGlkPVwicHBcIiBzcmM9XCJodHRwczovL2Jsb2NrY29pbi5zb2NpYWwvYXNzZXRzL2xvZ28ucG5nXCIgLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJpbWFnZS1zZXR0aW5nc1wiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaW1nLXR4dFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJzZXR0aW5ncy1uYW1lIGltZy1uYW1lXCI+QmFubmVyPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInNldHRpbmdzLWJ1dHRvblwiICBpZD1cImJhbm5lci1jaGFuZ2VcIiAgPkNoYW5nZTwvZGl2PlxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwiZmlsZVwiIGlkPVwiYmFubmVyLWZpbGVJbnB1dFwiIGFjY2VwdD1cIi5wbmcsLmpwZywuanBlZywud2VicFwiIHN0eWxlPVwiZGlzcGxheTogbm9uZTtcIj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJpbWctaW1nXCI+XG4gICAgICAgICAgPGltZyBjbGFzcz1cInNldHRpbmdzLWltZ1wiIGlkPVwiYmFubmVyXCIgc3JjPVwiaHR0cHM6Ly9ibG9ja2NvaW4uc29jaWFsL2Fzc2V0cy9kZWZhdWx0X2Jhbm5lci5wbmdcIiAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0LXNldHRpbmdzXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInNldHRpbmdzLW5hbWUgdGV4dC1uYW1lXCI+VGhlbWU8L2Rpdj5cbiAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0ZXh0LWlucHV0XCIgIGlkPVwidGhlbWVcIiA+PC9pbnB1dD5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwic2V0dGluZ3MtYnV0dG9uXCIgIGlkPVwidGhlbWUtY2hhbmdlXCIgID5TYXZlPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGl0bGVcIj5TZWN1cml0eTwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dC1zZXR0aW5nc1wiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJzZXR0aW5ncy1uYW1lIHRleHQtbmFtZVwiPkVtYWlsPC9kaXY+XG4gICAgICAgICAgPGlucHV0IGNsYXNzPVwidGV4dC1pbnB1dFwiICBpZD1cImVtYWlsXCIgIHR5cGU9XCJlbWFpbFwiPjwvaW5wdXQ+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInNldHRpbmdzLWJ1dHRvblwiICBpZD1cImVtYWlsLWNoYW5nZVwiICA+U2F2ZTwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInRleHQtc2V0dGluZ3NcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwic2V0dGluZ3MtbmFtZSB0ZXh0LW5hbWVcIj5QYXNzd29yZCBDaGFuZ2U8L2Rpdj5cbiAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0ZXh0LWlucHV0XCIgaWQ9XCJuZXctcGFzc3dvcmRcIiB0eXBlPVwicGFzc3dvcmRcIiBwbGFjZWhvbGRlcj1cIk5ldyBQYXNzd29yZFwiPjwvaW5wdXQ+XG4gICAgICAgICAgPGlucHV0IGNsYXNzPVwidGV4dC1pbnB1dFwiIHR5cGU9XCJwYXNzd29yZFwiIGlkPVwicGFzc3dvcmRcIiBwbGFjZWhvbGRlcj1cIkN1cnJlbnQgUGFzc3dvcmRcIj48L2lucHV0PlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJzZXR0aW5ncy1idXR0b25cIiBpZD1cInBhc3N3b3JkLWNoYW5nZVwiID5TYXZlPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaW1hZ2Utc2V0dGluZ3NcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImltZy10eHRcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwic2V0dGluZ3MtYnV0dG9uXCIgaWQ9XCJkaXNjb25uZWN0XCI+RGlzY29ubmVjdDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJzZXR0aW5ncy1idXR0b25cIiBpZD1cImRlbGV0ZVwiPkRlbGV0ZSBSZXF1ZXN0PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAiKTsKICBwYWdlLmNzcygiXG4gICAgI2RlbGV0ZSB7XG4gICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7IC8qIEFkanVzdCBtYXJnaW4gKi9cbiAgICB9XG4gICAgXG4gICAgI2Rpc2Nvbm5lY3Qge1xuICAgICAgICBtYXJnaW4tYm90dG9tOiAgMTBweDsgLyogQWRqdXN0IG1hcmdpbiAqL1xuICAgIH1cbiAgICBcbiAgICAuaW1nLW5hbWUge1xuICAgICAgICB3aWR0aDphdXRvO1xuICAgIH1cbiAgICBcbiAgICAuaW1hZ2Utc2V0dGluZ3Mge1xuICAgICAgICB3aWR0aDogOTAlO1xuICAgICAgICBtYXJnaW4tdG9wOiAyNXB4OyAvKiBBZGp1c3QgbWFyZ2luICovXG4gICAgfVxuICAgIFxuICAgIC5pbWctdHh0IHtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICB9XG4gICAgXG4gICAgLmltZy1pbWcge1xuICAgICAgICBvdmVyZmxvdzogYXV0bztcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgIH1cbiAgICBcbiAgICAuc2V0dGluZ3MtYnV0dG9uIHtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAwLjVzO1xuICAgICAgICBmb250LWZhbWlseTogIi5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsyXSwgIjsgLyogQWRqdXN0IGZvbnQgc2l6ZSAqL1xuICAgICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgiZ2xvYmFsIilbImJvcmRlci1yYWRpdXMiXVsyXSwgIjsgLyogQWRqdXN0IGJvcmRlciByYWRpdXMgKi9cbiAgICAgICAgYm9yZGVyOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoImdsb2JhbCIpWyJib3JkZXIiXSwgIjsgLyogQWRqdXN0IGJvcmRlciBjb2xvciAqL1xuICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICAgIHdpZHRoOiBhdXRvO1xuICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgfVxuICAgIFxuICAgIC5zZXR0aW5ncy1idXR0b246aG92ZXIge1xuICAgICAgICBmb250LXNpemU6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJzaXplIl1bNF0sICI7IC8qIEFkanVzdCBmb250IHNpemUgKi9cbiAgICB9XG4gICAgXG4gICAgLnRleHQtaW5wdXQge1xuICAgICAgICBwYWRkaW5nOiAwcHggMyU7XG4gICAgICAgIHdpZHRoOiA5NCU7XG4gICAgICAgIG91dGxpbmU6IG5vbmU7XG4gICAgICAgIGJhY2tncm91bmQ6IG5vbmU7XG4gICAgICAgIGJvcmRlcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyIl0sICI7IC8qIEFkanVzdCBib3JkZXIgY29sb3IgKi9cbiAgICAgICAgYm9yZGVyLXJhZGl1czogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyLXJhZGl1cyJdWzJdLCAiOyAvKiBBZGp1c3QgYm9yZGVyIHJhZGl1cyAqL1xuICAgICAgICBtaW4taGVpZ2h0OjUwcHg7IC8qIEFkanVzdCBtaW4gaGVpZ2h0ICovXG4gICAgICAgIGZvbnQtZmFtaWx5OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzJdLCAiOyAvKiBBZGp1c3QgZm9udCBzaXplICovXG4gICAgICAgIHRleHQtYWxpZ246IGxlZnQ7XG4gICAgICAgIG1hcmdpbi1ib3R0b206IDE1cHg7IC8qIEFkanVzdCBtYXJnaW4gKi9cbiAgICB9XG4gICAgXG4gICAgI3NldHRpbmdzLWNvbnRhaW5lciB7XG4gICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7IC8qIEFkanVzdCBtYXJnaW4gKi9cbiAgICAgICAgd2lkdGg6IDYwJTtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICAgIHRvcDogMjAlO1xuICAgICAgICBsZWZ0OiAyMCU7XG4gICAgICAgIGJvcmRlcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyIl0sICI7IC8qIEFkanVzdCBib3JkZXIgKi9cbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJnbG9iYWwiKVsiYm9yZGVyLXJhZGl1cyJdWzJdLCAiOyAvKiBBZGp1c3QgYm9yZGVyIHJhZGl1cyAqL1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQ7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgfVxuICAgIFxuICAgIC50aXRsZSB7XG4gICAgICAgIGZvbnQtZmFtaWx5OiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiZm9udCJdLCAiLCBzYW5zLXNlcmlmO1xuICAgICAgICBmb250LXdlaWdodDogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQtd2VpZ2h0Il0sICI7XG4gICAgICAgIGNvbG9yOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsiY29sb3IiXSwgIjtcbiAgICAgICAgZm9udC1zaXplOiAiKS5jb25jYXQoZGlzcGxheS5nZXQoInRleHQiKVsic2l6ZSJdWzRdLCAiOyAvKiBBZGp1c3QgZm9udCBzaXplICovXG4gICAgICAgIHRleHQtYWxpZ246IGxlZnQ7XG4gICAgICAgIG1hcmdpbi10b3A6IDI1cHg7IC8qIEFkanVzdCBtYXJnaW4gKi9cbiAgICAgICAgd2lkdGg6IDkwJTtcbiAgICB9XG4gICAgXG4gICAgLnRleHQtc2V0dGluZ3Mge1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xuICAgICAgICBhbGlnbi1pdGVtczogZmxleC1lbmQ7XG4gICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICAgIHdpZHRoOiA5MCU7XG4gICAgICAgIG1hcmdpbi10b3A6IDI1cHg7IC8qIEFkanVzdCBtYXJnaW4gKi9cbiAgICB9XG4gICAgXG4gICAgLnNldHRpbmdzLW5hbWUge1xuICAgICAgICBmb250LWZhbWlseTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImZvbnQiXSwgIiwgc2Fucy1zZXJpZjtcbiAgICAgICAgZm9udC13ZWlnaHQ6ICIpLmNvbmNhdChkaXNwbGF5LmdldCgidGV4dCIpWyJmb250LXdlaWdodCJdLCAiO1xuICAgICAgICBjb2xvcjogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbImNvbG9yIl0sICI7XG4gICAgICAgIGZvbnQtc2l6ZTogIikuY29uY2F0KGRpc3BsYXkuZ2V0KCJ0ZXh0IilbInNpemUiXVsxXSwgIjsgLyogQWRqdXN0IGZvbnQgc2l6ZSAqL1xuICAgIH1cbiAgICBcbiAgICAudGV4dC1uYW1lIHtcbiAgICAgICAgdGV4dC1hbGlnbjogbGVmdDtcbiAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgfVxuIikpOwogIHBhZ2UuZGVsZXRlX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBkZWxldGUge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCUpO1xuICAgICAgICB9XG4gICAgICAgIDEwMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwJSk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBwYWdlLnNwYXduX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBzcGF3biB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIGZ1bmN0aW9uIHJlZnJlc2hfZGF0YSgpIHsKICAgICAgR2V0UHJvZmlsZShnZXRDb29raWUoInYxLWlkIikpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGlzcGxheSIpLnBsYWNlaG9sZGVyID0gZGF0YVsiZGlzcGxheSJdOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0aGVtZSIpLnBsYWNlaG9sZGVyID0gIkNvcHkgYW5kIHBhc3RlIHlvdXIgZmF2b3JpdGUgdGhlbWUganNvbidzIGhlcmUgISI7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFib3V0IikucGxhY2Vob2xkZXIgPSBkYXRhWyJhYm91dCJdOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJiYW5uZXIiKS5zcmMgPSBkYXRhWyJiYW5uZXIiXTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicHAiKS5zcmMgPSBkYXRhWyJwcm9maWxlLXBpY3R1cmUiXTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZW1haWwiKS5wbGFjZWhvbGRlciA9ICJ5b3VAZW1haWwuYmMiOwogICAgICB9KTsKICAgIH0KICAgIHJlZnJlc2hfZGF0YSgpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImljb24tY2hhbmdlIikub25jbGljayA9IHNlbGVjdEZpbGVJY29uOwogICAgZnVuY3Rpb24gc2VsZWN0RmlsZUljb24oKSB7CiAgICAgIHZhciBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7CiAgICAgIGZpbGVJbnB1dC5jbGljaygpOwogICAgICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlRmlsZVNlbGVjdEljb24pOwogICAgfQogICAgZnVuY3Rpb24gaGFuZGxlRmlsZVNlbGVjdEljb24oZXZlbnQpIHsKICAgICAgdmFyIGZpbGVJbnB1dCA9IGV2ZW50LnRhcmdldDsKICAgICAgdmFyIGZpbGUgPSBmaWxlSW5wdXQuZmlsZXNbMF07CiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICByZWFkZXIub25sb2FkID0gLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgZmlsZUNvbnRlbnRCYXNlNjQ7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgZmlsZUNvbnRlbnRCYXNlNjQgPSByZWFkZXIucmVzdWx0LnNwbGl0KCcsJylbMV07CiAgICAgICAgICAgICAgVXBkYXRlUHJvZmlsZVBpY3R1cmUoZmlsZUNvbnRlbnRCYXNlNjQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIGlmIChkYXRhID09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgIE5vdGlmaWNhdGlvbigxLCAiQW4gdW5rbm93biBlcnJvciBoYXBwZW5lZC4gUGxlYXNlIHJldHJ5IGxhdGVyLiIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uKDAsIGRhdGEpOwogICAgICAgICAgICAgICAgICBzZXRDb29raWUoInYxLXByb2ZpbGUtcGljdHVyZSIsICIiKTsKICAgICAgICAgICAgICAgICAgcmVmcmVzaF9kYXRhKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSk7CiAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOwogICAgfQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJhbm5lci1jaGFuZ2UiKS5vbmNsaWNrID0gc2VsZWN0RmlsZUJhbm5lcjsKICAgIGZ1bmN0aW9uIHNlbGVjdEZpbGVCYW5uZXIoKSB7CiAgICAgIHZhciBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmFubmVyLWZpbGVJbnB1dCcpOwogICAgICBmaWxlSW5wdXQuY2xpY2soKTsKICAgICAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGhhbmRsZUJhbm5lckZpbGVTZWxlY3QpOwogICAgfQogICAgZnVuY3Rpb24gaGFuZGxlQmFubmVyRmlsZVNlbGVjdChldmVudCkgewogICAgICB2YXIgZmlsZUlucHV0ID0gZXZlbnQudGFyZ2V0OwogICAgICB2YXIgZmlsZSA9IGZpbGVJbnB1dC5maWxlc1swXTsKICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgIHJlYWRlci5vbmxvYWQgPSAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgZmlsZUNvbnRlbnRCYXNlNjQ7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGZpbGVDb250ZW50QmFzZTY0ID0gcmVhZGVyLnJlc3VsdC5zcGxpdCgnLCcpWzFdOwogICAgICAgICAgICAgIFVwZGF0ZUJhbm5lcihmaWxlQ29udGVudEJhc2U2NCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgaWYgKGRhdGEgPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uKDEsICJBbiB1bmtub3duIGVycm9yIGhhcHBlbmVkLiBQbGVhc2UgcmV0cnkgbGF0ZXIuIik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBOb3RpZmljYXRpb24oMCwgZGF0YSk7CiAgICAgICAgICAgICAgICAgIHJlZnJlc2hfZGF0YSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSk7CiAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOwogICAgfQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRoZW1lLWNoYW5nZSIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHNldENvb2tpZSgidjEtdGhlbWUiLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGhlbWUiKS52YWx1ZSk7CiAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgfTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXNwbGF5LWNoYW5nZSIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIFVwZGF0ZURpc3BsYXkoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpc3BsYXkiKS52YWx1ZSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIGlmIChkYXRhID09IGZhbHNlKSB7CiAgICAgICAgICBOb3RpZmljYXRpb24oMSwgIkFuIHVua25vd24gZXJyb3IgaGFwcGVuZC4gUGxlYXNlIHJldHJ5IGxhdGVyLiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBOb3RpZmljYXRpb24oMCwgZGF0YSk7CiAgICAgICAgICByZWZyZXNoX2RhdGEoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhYm91dC1jaGFuZ2UiKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICBVcGRhdGVBYm91dChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYWJvdXQiKS52YWx1ZSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIGlmIChkYXRhID09IGZhbHNlKSB7CiAgICAgICAgICBOb3RpZmljYXRpb24oMSwgIkFuIHVua25vd24gZXJyb3IgaGFwcGVuZC4gUGxlYXNlIHJldHJ5IGxhdGVyLiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBOb3RpZmljYXRpb24oMCwgZGF0YSk7CiAgICAgICAgICByZWZyZXNoX2RhdGEoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlbWFpbC1jaGFuZ2UiKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICBVcGRhdGVFbWFpbChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZW1haWwiKS52YWx1ZSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIGlmIChkYXRhID09IGZhbHNlKSB7CiAgICAgICAgICBOb3RpZmljYXRpb24oMSwgIkFuIHVua25vd24gZXJyb3IgaGFwcGVuZC4gUGxlYXNlIHJldHJ5IGxhdGVyLiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBOb3RpZmljYXRpb24oMCwgZGF0YSk7CiAgICAgICAgICByZWZyZXNoX2RhdGEoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXNzd29yZC1jaGFuZ2UiKS5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICBVcGRhdGVQYXNzd29yZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGFzc3dvcmQiKS52YWx1ZSwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm5ldy1wYXNzd29yZCIpLnZhbHVlKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgaWYgKGRhdGEgPT0gZmFsc2UpIHsKICAgICAgICAgIE5vdGlmaWNhdGlvbigxLCAiQW4gdW5rbm93biBlcnJvciBoYXBwZW5kLiAoSXMgaXQgcmVhbGx5IHRoZSByaWdodCBwYXNzd29yZCA/KSIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBOb3RpZmljYXRpb24oMCwgZGF0YSk7CiAgICAgICAgICByZWZyZXNoX2RhdGEoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXNjb25uZWN0Iikub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgc2V0Q29va2llKCJ2MS11c2VyIiwgIiIpOwogICAgICBzZXRDb29raWUoInYxLWlkIiwgIiIpOwogICAgICBzZXRDb29raWUoInYxLXRva2VuIiwgIiIpOwogICAgICBzZXRDb29raWUoInYxLXByb2ZpbGUtcGljdHVyZSIsICIiKTsKICAgICAgcm91dGVyLm5hdmlnYXRlVG8oIi8iKTsKICAgIH07CiAgfQogIHBhZ2Uub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIjoyLCIuLi9lbGVtZW50cy9mb250cy5tanMiOjQsIi4uL2VsZW1lbnRzL25hdmJhci5tanMiOjYsIi4uL2VsZW1lbnRzL25ld19wb3N0X2J1dHRvbi5tanMiOjcsIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIjo4LCIuLi9lbGVtZW50cy9wb3N0Lm1qcyI6OSwiLi4vbGliL0ZyYW1ld29yay5tanMiOjEwLCIuLi9zY3JpcHRzL2FwaS5tanMiOjI5LCIuLi9zY3JpcHRzL2Nvb2tpZXMubWpzIjozMH1dLDI4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlRyZW5kaW5nID0gVHJlbmRpbmc7CmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSAic3RyaW5nIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09ICJPYmplY3QiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSAiTWFwIiB8fCBuID09PSAiU2V0IikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSAiQXJndW1lbnRzIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH0KZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgYXJyMltpXSA9IGFycltpXTsgcmV0dXJuIGFycjI7IH0KZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KHIsIGwpIHsgdmFyIHQgPSBudWxsID09IHIgPyBudWxsIDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIFN5bWJvbCAmJiByW1N5bWJvbC5pdGVyYXRvcl0gfHwgclsiQEBpdGVyYXRvciJdOyBpZiAobnVsbCAhPSB0KSB7IHZhciBlLCBuLCBpLCB1LCBhID0gW10sIGYgPSAhMCwgbyA9ICExOyB0cnkgeyBpZiAoaSA9ICh0ID0gdC5jYWxsKHIpKS5uZXh0LCAwID09PSBsKSB7IGlmIChPYmplY3QodCkgIT09IHQpIHJldHVybjsgZiA9ICExOyB9IGVsc2UgZm9yICg7ICEoZiA9IChlID0gaS5jYWxsKHQpKS5kb25lKSAmJiAoYS5wdXNoKGUudmFsdWUpLCBhLmxlbmd0aCAhPT0gbCk7IGYgPSAhMCk7IH0gY2F0Y2ggKHIpIHsgbyA9ICEwLCBuID0gcjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFmICYmIG51bGwgIT0gdFsicmV0dXJuIl0gJiYgKHUgPSB0WyJyZXR1cm4iXSgpLCBPYmplY3QodSkgIT09IHUpKSByZXR1cm47IH0gZmluYWxseSB7IGlmIChvKSB0aHJvdyBuOyB9IH0gcmV0dXJuIGE7IH0gfQpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7IH0KZnVuY3Rpb24gVHJlbmRpbmcocm91dGVyKSB7CiAgdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiLi4vbGliL0ZyYW1ld29yay5tanMiKSwKICAgIFBhZ2UgPSBfcmVxdWlyZS5QYWdlOwogIHZhciBfcmVxdWlyZTIgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9mb250cy5tanMiKSwKICAgIEZvbnRzID0gX3JlcXVpcmUyLkZvbnRzOwogIHZhciBfcmVxdWlyZTMgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9iYWNrZ3JvdW5kLm1qcyIpLAogICAgQmFja2dyb3VuZCA9IF9yZXF1aXJlMy5CYWNrZ3JvdW5kOwogIHZhciBfcmVxdWlyZTQgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uYXZiYXIubWpzIiksCiAgICBOYXZiYXIgPSBfcmVxdWlyZTQuTmF2YmFyOwogIHZhciBfcmVxdWlyZTUgPSByZXF1aXJlKCIuLi9lbGVtZW50cy9wb3N0Lm1qcyIpLAogICAgUG9zdCA9IF9yZXF1aXJlNS5Qb3N0OwogIHZhciBfcmVxdWlyZTYgPSByZXF1aXJlKCIuLi9zY3JpcHRzL2FwaS5tanMiKSwKICAgIElzTG9nZWRJbiA9IF9yZXF1aXJlNi5Jc0xvZ2VkSW47CiAgdmFyIF9yZXF1aXJlNyA9IHJlcXVpcmUoIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIiksCiAgICBOb3RpZmljYXRpb24gPSBfcmVxdWlyZTcuTm90aWZpY2F0aW9uOwogIHZhciBfcmVxdWlyZTggPSByZXF1aXJlKCIuLi9lbGVtZW50cy9uZXdfcG9zdF9idXR0b24ubWpzIiksCiAgICBOZXdQb3N0QnV0dG9uID0gX3JlcXVpcmU4Lk5ld1Bvc3RCdXR0b247CiAgdmFyIHBhZ2UgPSBuZXcgUGFnZSgiVHJlbmRpbmciKTsKICBwYWdlLmNsZWFyKFsiYmFja2dyb3VuZCIsICJuYXZiYXIiLCAiZm9udHMiLCAibmV3X3Bvc3RfYnV0dG9uIl0pOwogIEZvbnRzKHJvdXRlcik7CiAgQmFja2dyb3VuZChyb3V0ZXIpOwogIE5hdmJhcihyb3V0ZXIpOwogIE5ld1Bvc3RCdXR0b24ocm91dGVyKTsKICBwYWdlLmh0bWwoIlxuICAgIDxkaXYgaWQ9XCJwb3N0LWNvbnRhaW5lclwiPlxuXG4gICAgPC9kaXY+XG4gICAgIik7CiAgcGFnZS5jc3MoIlxuXG4gICAgI3Bvc3QtY29udGFpbmVyIHtcbiAgICAgICAgbWFyZ2luLXRvcDogNy41JTtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICBtaW4taGVpZ2h0OjEwMCU7XG4gICAgICAgIHdpZHRoOjEwMCU7XG4gICAgICAgIGhlaWdodDpmaXQtY29udGVudDtcbiAgICAgICAgdG9wOjA7XG4gICAgICAgIGxlZnQ6MDtcbiAgICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6c3RhcnQ7XG4gICAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246Y29sdW1uO1xuICAgIH1cblxuICAgICNwb3N0LWNvbnRhaW5lciBwb3N0IHtcbiAgICAgIHdpZHRoOjYwJTtcbiAgICAgIGhlaWdodDpmaXQtY29udGVudDtcbiAgICAgIG1pbi1oZWlnaHQ6IDUlO1xuICAgICAgbWFyZ2luOiAxJVxuICAgIH1cbiAgICAiKTsKICB2YXIgYXBpX3VybCA9ICJ3c3M6Ly9hcGkuYmxvY2tjb2luLnNvY2lhbCI7CiAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PSAiMTI3LjAuMC4xIiB8fCB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT0gImxvY2FsaG9zdCIpIHsKICAgIGFwaV91cmwgPSAid3M6Ly8xMjcuMC4wLjE6ODA4MCI7CiAgfQogIHZhciBzb2NrZXQgPSBudWxsOwogIGZ1bmN0aW9uIG9uX3JlbmRlcigpIHsKICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoYXBpX3VybCArICcvcG9zdCcpOwogICAgdmFyIGNhY2hlID0gW107CiAgICBmdW5jdGlvbiB3YWl0Rm9yTm9uTnVsbENhY2hlKCkgewogICAgICB2YXIgaW50ZXJ2YWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDEwMDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgZnVuY3Rpb24gY2hlY2tWYXJpYWJsZSgpIHsKICAgICAgICAgIGNhY2hlOwogICAgICAgICAgaWYgKGNhY2hlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHJlc29sdmUoY2FjaGUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2V0VGltZW91dChjaGVja1ZhcmlhYmxlLCBpbnRlcnZhbCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNoZWNrVmFyaWFibGUoKTsKICAgICAgfSk7CiAgICB9CiAgICBmdW5jdGlvbiBwYXJzZWNhY2hlKCkgewogICAgICBpZiAoY2FjaGUgIT0gbnVsbCkgewogICAgICAgIGlmIChjYWNoZVsib3Bjb2RlIl0gPT0gNSkgewogICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfT2JqZWN0JGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhjYWNoZVsiZGF0YSJdKTsgX2kgPCBfT2JqZWN0JGVudHJpZXMubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgICAgIHZhciBfT2JqZWN0JGVudHJpZXMkX2kgPSBfc2xpY2VkVG9BcnJheShfT2JqZWN0JGVudHJpZXNbX2ldLCAyKSwKICAgICAgICAgICAgICBrZXkgPSBfT2JqZWN0JGVudHJpZXMkX2lbMF0sCiAgICAgICAgICAgICAgdmFsdWUgPSBfT2JqZWN0JGVudHJpZXMkX2lbMV07CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgdmFyIHBvc3QgPSB2YWx1ZTsKICAgICAgICAgICAgICB2YXIgcG9zdF9kYXRhID0gcG9zdFsiZGF0YSJdOwogICAgICAgICAgICAgIHBvc3RfZGF0YVsidXNlci1pZCJdID0gcG9zdFsicHJvZmlsZSJdWyJpZCJdOwogICAgICAgICAgICAgIHBvc3RfZGF0YVsidXNlciJdID0gcG9zdFsicHJvZmlsZSJdWyJkaXNwbGF5Il07CiAgICAgICAgICAgICAgcG9zdF9kYXRhWyJwcm9maWxlLXBpY3R1cmUiXSA9IHBvc3RbInByb2ZpbGUiXVsicHJvZmlsZS1waWN0dXJlIl07CiAgICAgICAgICAgICAgcG9zdF9kYXRhWyJiYWRnZXMiXSA9IHBvc3RbInByb2ZpbGUiXVsiYmFkZ2VzIl07CiAgICAgICAgICAgICAgdmFyIG5ld19wb3N0ID0gbmV3IFBvc3Qocm91dGVyLCBwb3N0X2RhdGEsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwb3N0LWNvbnRhaW5lciIpKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciIsIGUuc3RhY2spOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciIsIGUubmFtZSk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIiwgZS5tZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpOwogICAgICBjYWNoZSA9IGRhdGE7CiAgICAgIHBhcnNlY2FjaGUoKTsKICAgIH0pOwogICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2Nsb3NlJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoYXBpX3VybCArICcvcG9zdCcpOwogICAgfSk7CiAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignb3BlbicsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgJ29wY29kZSc6IDUsCiAgICAgICAgJ2xpbWl0JzogMTAKICAgICAgfSkpOwogICAgfSk7CiAgICB3aW5kb3cub25zY3JvbGwgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzY3JvbGxIZWlnaHQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0OwogICAgICB2YXIgc2Nyb2xsVG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0ICE9PSB1bmRlZmluZWQgPyB3aW5kb3cucGFnZVlPZmZzZXQgOiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IHx8IGRvY3VtZW50LmJvZHkucGFyZW50Tm9kZSB8fCBkb2N1bWVudC5ib2R5KS5zY3JvbGxUb3A7CiAgICAgIHZhciB3aW5kb3dIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7CiAgICAgIGlmIChzY3JvbGxUb3AgKyB3aW5kb3dIZWlnaHQgPj0gc2Nyb2xsSGVpZ2h0KSB7CiAgICAgICAgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgJ29wY29kZSc6IDIsCiAgICAgICAgICAnbGltaXQnOiAyMAogICAgICAgIH0pKTsKICAgICAgICBwYXJzZWNhY2hlKCk7CiAgICAgIH0KICAgIH07CiAgfQogIHBhZ2UuZGVsZXRlX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBkZWxldGUge1xuICAgICAgICAwJSB7XG4gICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCUpO1xuICAgICAgICB9XG4gICAgICAgIDEwMCUge1xuICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwJSk7IC8qIEFkanVzdCB0aGUgZGlzdGFuY2UgeW91IHdhbnQgdG8gbW92ZSBvbiB0aGUgeS1heGlzICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAiKTsKICBwYWdlLnNwYXduX2FuaW1hdGlvbigiXG4gICAgQGtleWZyYW1lcyBzcGF3biB7XG4gICAgICAgIDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTAlKTtcbiAgICAgICAgfVxuICAgICAgICAxMDAlIHtcbiAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgLyogQWRqdXN0IHRoZSBkaXN0YW5jZSB5b3Ugd2FudCB0byBtb3ZlIG9uIHRoZSB5LWF4aXMgKi9cbiAgICAgICAgfVxuICAgICAgfVxuICAgICIpOwogIGZ1bmN0aW9uIG9uX2RlbGV0ZSgpIHsKICAgIHNvY2tldC5jbG9zZSgpOwogIH0KICBwYWdlLm9uX2RlbGV0ZShvbl9kZWxldGUpOwogIHBhZ2Uub25fcmVuZGVyKG9uX3JlbmRlcik7CiAgcGFnZS5yZW5kZXIoKTsKfQoKfSx7Ii4uL2VsZW1lbnRzL2JhY2tncm91bmQubWpzIjoyLCIuLi9lbGVtZW50cy9mb250cy5tanMiOjQsIi4uL2VsZW1lbnRzL25hdmJhci5tanMiOjYsIi4uL2VsZW1lbnRzL25ld19wb3N0X2J1dHRvbi5tanMiOjcsIi4uL2VsZW1lbnRzL25vdGlmaWNhdGlvbnMubWpzIjo4LCIuLi9lbGVtZW50cy9wb3N0Lm1qcyI6OSwiLi4vbGliL0ZyYW1ld29yay5tanMiOjEwLCIuLi9zY3JpcHRzL2FwaS5tanMiOjI5fV0sMjk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuQmFsYW5jZSA9IEJhbGFuY2U7CmV4cG9ydHMuQnV5UG9zdCA9IEJ1eVBvc3Q7CmV4cG9ydHMuQ29tbWVudExpa2VkID0gQ29tbWVudExpa2VkOwpleHBvcnRzLkNyZWF0ZUNvbW1lbnQgPSBDcmVhdGVDb21tZW50OwpleHBvcnRzLkNyZWF0ZVBvc3QgPSBDcmVhdGVQb3N0OwpleHBvcnRzLkZvbGxvd1VzZXIgPSBGb2xsb3dVc2VyOwpleHBvcnRzLkZvbGxvd2VkVXNlciA9IEZvbGxvd2VkVXNlcjsKZXhwb3J0cy5HZXRDb21tZW50cyA9IEdldENvbW1lbnRzOwpleHBvcnRzLkdldFByb2ZpbGUgPSBHZXRQcm9maWxlOwpleHBvcnRzLklzTG9nZWRJbiA9IElzTG9nZWRJbjsKZXhwb3J0cy5MaWtlQ29tbWVudCA9IExpa2VDb21tZW50OwpleHBvcnRzLkxpa2VQb3N0ID0gTGlrZVBvc3Q7CmV4cG9ydHMuTG9naW4gPSBMb2dpbjsKZXhwb3J0cy5Qb3N0TGlrZWQgPSBQb3N0TGlrZWQ7CmV4cG9ydHMuUmFuZG9tUG9zdHMgPSBSYW5kb21Qb3N0czsKZXhwb3J0cy5SZWdpc3RlciA9IFJlZ2lzdGVyOwpleHBvcnRzLlN0YXRzID0gU3RhdHM7CmV4cG9ydHMuVXBkYXRlQWJvdXQgPSBVcGRhdGVBYm91dDsKZXhwb3J0cy5VcGRhdGVCYW5uZXIgPSBVcGRhdGVCYW5uZXI7CmV4cG9ydHMuVXBkYXRlRGlzcGxheSA9IFVwZGF0ZURpc3BsYXk7CmV4cG9ydHMuVXBkYXRlRW1haWwgPSBVcGRhdGVFbWFpbDsKZXhwb3J0cy5VcGRhdGVQYXNzd29yZCA9IFVwZGF0ZVBhc3N3b3JkOwpleHBvcnRzLlVwZGF0ZVByb2ZpbGVQaWN0dXJlID0gVXBkYXRlUHJvZmlsZVBpY3R1cmU7CmV4cG9ydHMuVmVyaWZ5VG9rZW4gPSBWZXJpZnlUb2tlbjsKZXhwb3J0cy5WaWV3UG9zdCA9IFZpZXdQb3N0Owp2YXIgX3Jld3JpdGVTdGFja1RyYWNlID0gcmVxdWlyZSgiQGJhYmVsL2NvcmUvbGliL2Vycm9ycy9yZXdyaXRlLXN0YWNrLXRyYWNlIik7CnZhciBfcmVxdWlyZSA9IHJlcXVpcmUoIi4vY29va2llcy5tanMiKSwKICBzZXRDb29raWUgPSBfcmVxdWlyZS5zZXRDb29raWUsCiAgZ2V0Q29va2llID0gX3JlcXVpcmUuZ2V0Q29va2llLAogIGNoZWNrQ29va2llID0gX3JlcXVpcmUuY2hlY2tDb29raWU7CnZhciBhcGlfdXJsID0gImh0dHBzOi8vYXBpLmJsb2NrY29pbi5zb2NpYWwiOwppZiAod2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09ICIxMjcuMC4wLjEiIHx8IHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PSAibG9jYWxob3N0IikgewogIGFwaV91cmwgPSAiaHR0cDovLzEyNy4wLjAuMTo4MDgwIjsKfQpmdW5jdGlvbiBMb2dpbih1c2VyLCBwYXNzd29yZCwgY2FwdGNoYSkgewogIHZhciB1cmwgPSBhcGlfdXJsICsgIi91c2VyL2xvZ2luIjsKICB2YXIgb3B0aW9ucyA9IHsKICAgIG1ldGhvZDogJ1BPU1QnLAogICAgaGVhZGVyczogewogICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICB9LAogICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAidXNlciI6IHVzZXIsCiAgICAgICJwYXNzd29yZCI6IHBhc3N3b3JkLAogICAgICAiY2FwdGNoYSI6IGNhcHRjaGEKICAgIH0pCiAgfTsKICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAoZGF0YVsic3VjY2VzcyJdKSB7CiAgICAgIHNldENvb2tpZSgidjEtcHJvZmlsZS1waWN0dXJlIiwgIiIsIDM2NSk7CiAgICAgIHNldENvb2tpZSgidjEtdXNlciIsIGRhdGFbInVzZXIiXSwgMzY1KTsKICAgICAgc2V0Q29va2llKCJ2MS1pZCIsIGRhdGFbImlkIl0sIDM2NSk7CiAgICAgIHNldENvb2tpZSgidjEtdG9rZW4iLCBkYXRhWyJ0b2tlbiJdLCAzNjUpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBkYXRhWyJtZXNzYWdlIl07CiAgICB9CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICByZXR1cm4gZGF0YVsibWVzc2FnZSJdOwogIH0pOwp9CmZ1bmN0aW9uIFJlZ2lzdGVyKHVzZXIsIGNvbnRhY3QsIHBhc3N3b3JkLCBjYXB0Y2hhKSB7CiAgdmFyIHVybCA9IGFwaV91cmwgKyAiL3VzZXIvcmVnaXN0ZXIiOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICJ1c2VyIjogdXNlciwKICAgICAgInBhc3N3b3JkIjogcGFzc3dvcmQsCiAgICAgICJjb250YWN0IjogY29udGFjdCwKICAgICAgImNhcHRjaGEiOiBjYXB0Y2hhCiAgICB9KQogIH07CiAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgaWYgKGRhdGFbInN1Y2Nlc3MiXSkgewogICAgICBzZXRDb29raWUoInYxLXByb2ZpbGUtcGljdHVyZSIsICIiLCAzNjUpOwogICAgICBzZXRDb29raWUoInYxLXVzZXIiLCBkYXRhWyJ1c2VyIl0sIDM2NSk7CiAgICAgIHNldENvb2tpZSgidjEtaWQiLCBkYXRhWyJpZCJdLCAzNjUpOwogICAgICBzZXRDb29raWUoInYxLXRva2VuIiwgZGF0YVsidG9rZW4iXSwgMzY1KTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZGF0YVsibWVzc2FnZSJdOwogICAgfQogIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgcmV0dXJuIGRhdGFbIm1lc3NhZ2UiXTsKICB9KTsKfQpmdW5jdGlvbiBSYW5kb21Qb3N0cyhsaW1pdCkgewogIGlmIChsaW1pdCA+IDIwKSB7CiAgICBsaW1pdCA9IDIwOwogIH0KICB2YXIgdXJsID0gYXBpX3VybCArICIvc29jaWFsL3JhbmRvbT9saW1pdD0iICsgbGltaXQ7CiAgdmFyIG9wdGlvbnMgPSB7CiAgICBtZXRob2Q6ICdHRVQnLAogICAgaGVhZGVyczogewogICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICB9CiAgfTsKICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAoZGF0YVsic3VjY2VzcyJdKSB7CiAgICAgIHJldHVybiBkYXRhWyJkYXRhIl07CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlIHJlcXVlc3Q6JywgZXJyb3IpOwogICAgcmV0dXJuIGZhbHNlOwogIH0pOwp9CmZ1bmN0aW9uIEdldFByb2ZpbGUoaWQpIHsKICB2YXIgdXJsID0gYXBpX3VybCArICIvdXNlci9wcm9maWxlP3VzZXI9IiArIGlkOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnR0VUJywKICAgIGhlYWRlcnM6IHsKICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgfQogIH07CiAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgaWYgKGRhdGFbInN1Y2Nlc3MiXSkgewogICAgICByZXR1cm4gZGF0YVsiZGF0YSJdOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignVGhlcmUgd2FzIGEgcHJvYmxlbSB3aXRoIHRoZSByZXF1ZXN0OicsIGVycm9yKTsKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfQpmdW5jdGlvbiBDcmVhdGVQb3N0KGRhdGEsIGlzYnV5YWJsZSwgcHJpY2UsIGNhcHRjaGEpIHsKICB2YXIgdXJsID0gYXBpX3VybCArICIvc29jaWFsL3Bvc3QiOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICJ1c2VyIjogZ2V0Q29va2llKCJ2MS1pZCIpLAogICAgICAidG9rZW4iOiBnZXRDb29raWUoInYxLXRva2VuIiksCiAgICAgICJkYXRhIjogZGF0YSwKICAgICAgImlzQnV5YWJsZSI6IGlzYnV5YWJsZSwKICAgICAgInByaWNlIjogcHJpY2UsCiAgICAgICJjYXB0Y2hhIjogY2FwdGNoYQogICAgfSkKICB9OwogIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgIGlmIChkYXRhWyJzdWNjZXNzIl0pIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZGF0YVsibWVzc2FnZSJdOwogICAgfQogIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignVGhlcmUgd2FzIGEgcHJvYmxlbSB3aXRoIHRoZSByZXF1ZXN0OicsIGVycm9yKTsKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfQpmdW5jdGlvbiBJc0xvZ2VkSW4oKSB7CiAgcmV0dXJuIGNoZWNrQ29va2llKCJ2MS11c2VyIikgJiYgY2hlY2tDb29raWUoInYxLWlkIikgJiYgY2hlY2tDb29raWUoInYxLXRva2VuIik7Cn0KZnVuY3Rpb24gVmlld1Bvc3QoaWQpIHsKICB2YXIgdXJsID0gYXBpX3VybCArICIvc29jaWFsL3ZpZXciOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICJ1c2VyIjogZ2V0Q29va2llKCJ2MS1pZCIpLAogICAgICAidG9rZW4iOiBnZXRDb29raWUoInYxLXRva2VuIiksCiAgICAgICJwb3N0IjogaWQKICAgIH0pCiAgfTsKICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAoZGF0YVsic3VjY2VzcyJdKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignVGhlcmUgd2FzIGEgcHJvYmxlbSB3aXRoIHRoZSByZXF1ZXN0OicsIGVycm9yKTsKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfQpmdW5jdGlvbiBQb3N0TGlrZWQoaWQpIHsKICB2YXIgdXJsID0gYXBpX3VybCArICIvc29jaWFsL2xpa2VkIjsKICB2YXIgb3B0aW9ucyA9IHsKICAgIG1ldGhvZDogJ1BPU1QnLAogICAgaGVhZGVyczogewogICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICB9LAogICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAidXNlciI6IGdldENvb2tpZSgidjEtaWQiKSwKICAgICAgInRva2VuIjogZ2V0Q29va2llKCJ2MS10b2tlbiIpLAogICAgICAicG9zdCI6IGlkCiAgICB9KQogIH07CiAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgaWYgKGRhdGFbInN1Y2Nlc3MiXSkgewogICAgICByZXR1cm4gZGF0YTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1RoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB0aGUgcmVxdWVzdDonLCBlcnJvcik7CiAgICByZXR1cm4gZmFsc2U7CiAgfSk7Cn0KZnVuY3Rpb24gTGlrZVBvc3QoaWQpIHsKICB2YXIgdXJsID0gYXBpX3VybCArICIvc29jaWFsL2xpa2UiOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICJ1c2VyIjogZ2V0Q29va2llKCJ2MS1pZCIpLAogICAgICAidG9rZW4iOiBnZXRDb29raWUoInYxLXRva2VuIiksCiAgICAgICJwb3N0IjogaWQKICAgIH0pCiAgfTsKICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAoZGF0YVsic3VjY2VzcyJdKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignVGhlcmUgd2FzIGEgcHJvYmxlbSB3aXRoIHRoZSByZXF1ZXN0OicsIGVycm9yKTsKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfQpmdW5jdGlvbiBGb2xsb3dlZFVzZXIoaWQpIHsKICB2YXIgdXJsID0gYXBpX3VybCArICIvc29jaWFsL2ZvbGxvd2VkIjsKICB2YXIgb3B0aW9ucyA9IHsKICAgIG1ldGhvZDogJ1BPU1QnLAogICAgaGVhZGVyczogewogICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICB9LAogICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAidXNlciI6IGdldENvb2tpZSgidjEtaWQiKSwKICAgICAgInRva2VuIjogZ2V0Q29va2llKCJ2MS10b2tlbiIpLAogICAgICAidGFyZ2V0IjogaWQKICAgIH0pCiAgfTsKICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAoZGF0YVsic3VjY2VzcyJdKSB7CiAgICAgIHJldHVybiBkYXRhOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignVGhlcmUgd2FzIGEgcHJvYmxlbSB3aXRoIHRoZSByZXF1ZXN0OicsIGVycm9yKTsKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfQpmdW5jdGlvbiBGb2xsb3dVc2VyKHVzZXIsIGNhcHRjaGEpIHsKICB2YXIgdXJsID0gYXBpX3VybCArICIvc29jaWFsL2ZvbGxvdyI7CiAgdmFyIG9wdGlvbnMgPSB7CiAgICBtZXRob2Q6ICdQT1NUJywKICAgIGhlYWRlcnM6IHsKICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgfSwKICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgInVzZXIiOiBnZXRDb29raWUoInYxLWlkIiksCiAgICAgICJ0b2tlbiI6IGdldENvb2tpZSgidjEtdG9rZW4iKSwKICAgICAgImNhcHRjaGEiOiBjYXB0Y2hhLAogICAgICAidGFyZ2V0IjogdXNlcgogICAgfSkKICB9OwogIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgIGlmIChkYXRhWyJzdWNjZXNzIl0pIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlIHJlcXVlc3Q6JywgZXJyb3IpOwogICAgcmV0dXJuIGZhbHNlOwogIH0pOwp9CmZ1bmN0aW9uIEJhbGFuY2UodXNlcikgewogIHZhciB1cmwgPSBhcGlfdXJsICsgIi91c2VyL2JhbGFuY2U/dXNlcj0iICsgdXNlcjsKICB2YXIgb3B0aW9ucyA9IHsKICAgIG1ldGhvZDogJ0dFVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0KICB9OwogIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgIGlmIChkYXRhWyJzdWNjZXNzIl0pIHsKICAgICAgcmV0dXJuIGRhdGFbImJhbGFuY2UiXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1RoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB0aGUgcmVxdWVzdDonLCBlcnJvcik7CiAgICByZXR1cm4gZmFsc2U7CiAgfSk7Cn0KZnVuY3Rpb24gU3RhdHModXNlcikgewogIHZhciB1cmwgPSBhcGlfdXJsICsgIi9zb2NpYWwvc3RhdHMvdXNlcj91c2VyPSIgKyB1c2VyOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnR0VUJywKICAgIGhlYWRlcnM6IHsKICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgfQogIH07CiAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgaWYgKGRhdGFbInN1Y2Nlc3MiXSkgewogICAgICByZXR1cm4gZGF0YVsiZGF0YSJdOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignVGhlcmUgd2FzIGEgcHJvYmxlbSB3aXRoIHRoZSByZXF1ZXN0OicsIGVycm9yKTsKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfQpmdW5jdGlvbiBVcGRhdGVQcm9maWxlUGljdHVyZShmaWxlKSB7CiAgdmFyIHVybCA9IGFwaV91cmwgKyAiL3VzZXIvdXBkYXRlL3Byb2ZpbGUiOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICJ1c2VyIjogZ2V0Q29va2llKCJ2MS1pZCIpLAogICAgICAidG9rZW4iOiBnZXRDb29raWUoInYxLXRva2VuIiksCiAgICAgICJwaWN0dXJlIjogZmlsZQogICAgfSkKICB9OwogIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgIGlmIChkYXRhWyJzdWNjZXNzIl0pIHsKICAgICAgcmV0dXJuIGRhdGFbIm1lc3NhZ2UiXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1RoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB0aGUgcmVxdWVzdDonLCBlcnJvcik7CiAgICByZXR1cm4gZmFsc2U7CiAgfSk7Cn0KZnVuY3Rpb24gVXBkYXRlQWJvdXQoYWJvdXQpIHsKICB2YXIgdXJsID0gYXBpX3VybCArICIvdXNlci91cGRhdGUvcHJvZmlsZSI7CiAgdmFyIG9wdGlvbnMgPSB7CiAgICBtZXRob2Q6ICdQT1NUJywKICAgIGhlYWRlcnM6IHsKICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgfSwKICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgInVzZXIiOiBnZXRDb29raWUoInYxLWlkIiksCiAgICAgICJ0b2tlbiI6IGdldENvb2tpZSgidjEtdG9rZW4iKSwKICAgICAgImFib3V0IjogYWJvdXQKICAgIH0pCiAgfTsKICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAoZGF0YVsic3VjY2VzcyJdKSB7CiAgICAgIHJldHVybiBkYXRhWyJtZXNzYWdlIl07CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlIHJlcXVlc3Q6JywgZXJyb3IpOwogICAgcmV0dXJuIGZhbHNlOwogIH0pOwp9CmZ1bmN0aW9uIFVwZGF0ZURpc3BsYXkoZmlsZSkgewogIHZhciB1cmwgPSBhcGlfdXJsICsgIi91c2VyL3VwZGF0ZS9wcm9maWxlIjsKICB2YXIgb3B0aW9ucyA9IHsKICAgIG1ldGhvZDogJ1BPU1QnLAogICAgaGVhZGVyczogewogICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICB9LAogICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAidXNlciI6IGdldENvb2tpZSgidjEtaWQiKSwKICAgICAgInRva2VuIjogZ2V0Q29va2llKCJ2MS10b2tlbiIpLAogICAgICAiZGlzcGxheSI6IGZpbGUKICAgIH0pCiAgfTsKICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAoZGF0YVsic3VjY2VzcyJdKSB7CiAgICAgIHJldHVybiBkYXRhWyJtZXNzYWdlIl07CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlIHJlcXVlc3Q6JywgZXJyb3IpOwogICAgcmV0dXJuIGZhbHNlOwogIH0pOwp9CmZ1bmN0aW9uIFVwZGF0ZUJhbm5lcihmaWxlKSB7CiAgdmFyIHVybCA9IGFwaV91cmwgKyAiL3VzZXIvdXBkYXRlL3Byb2ZpbGUiOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICJ1c2VyIjogZ2V0Q29va2llKCJ2MS1pZCIpLAogICAgICAidG9rZW4iOiBnZXRDb29raWUoInYxLXRva2VuIiksCiAgICAgICJiYW5uZXIiOiBmaWxlCiAgICB9KQogIH07CiAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgaWYgKGRhdGFbInN1Y2Nlc3MiXSkgewogICAgICByZXR1cm4gZGF0YVsibWVzc2FnZSJdOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignVGhlcmUgd2FzIGEgcHJvYmxlbSB3aXRoIHRoZSByZXF1ZXN0OicsIGVycm9yKTsKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfQpmdW5jdGlvbiBVcGRhdGVFbWFpbChmaWxlKSB7CiAgdmFyIHVybCA9IGFwaV91cmwgKyAiL3VzZXIvdXBkYXRlL3Byb2ZpbGUiOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICJ1c2VyIjogZ2V0Q29va2llKCJ2MS1pZCIpLAogICAgICAidG9rZW4iOiBnZXRDb29raWUoInYxLXRva2VuIiksCiAgICAgICJlbWFpbCI6IGZpbGUKICAgIH0pCiAgfTsKICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAoZGF0YVsic3VjY2VzcyJdKSB7CiAgICAgIHJldHVybiBkYXRhWyJtZXNzYWdlIl07CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlIHJlcXVlc3Q6JywgZXJyb3IpOwogICAgcmV0dXJuIGZhbHNlOwogIH0pOwp9CmZ1bmN0aW9uIFVwZGF0ZVBhc3N3b3JkKG9sZCwgbmV3X3Bhc3N3b3JkKSB7CiAgdmFyIHVybCA9IGFwaV91cmwgKyAiL3VzZXIvdXBkYXRlL3Byb2ZpbGUiOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICJ1c2VyIjogZ2V0Q29va2llKCJ2MS1pZCIpLAogICAgICAidG9rZW4iOiBnZXRDb29raWUoInYxLXRva2VuIiksCiAgICAgICJwYXNzd29yZCI6IG9sZCwKICAgICAgIm5ld19wYXNzd29yZCI6IG5ld19wYXNzd29yZAogICAgfSkKICB9OwogIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgIGlmIChkYXRhWyJzdWNjZXNzIl0pIHsKICAgICAgcmV0dXJuIGRhdGFbIm1lc3NhZ2UiXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1RoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB0aGUgcmVxdWVzdDonLCBlcnJvcik7CiAgICByZXR1cm4gZmFsc2U7CiAgfSk7Cn0KZnVuY3Rpb24gQnV5UG9zdChwb3N0LCBjYXB0Y2hhKSB7CiAgdmFyIHVybCA9IGFwaV91cmwgKyAiL3NvY2lhbC9idXkiOwogIHZhciBvcHRpb25zID0gewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0sCiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICJ1c2VyIjogZ2V0Q29va2llKCJ2MS1pZCIpLAogICAgICAidG9rZW4iOiBnZXRDb29raWUoInYxLXRva2VuIiksCiAgICAgICJjYXB0Y2hhIjogY2FwdGNoYSwKICAgICAgInBvc3QiOiBwb3N0CiAgICB9KQogIH07CiAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgaWYgKGRhdGFbInN1Y2Nlc3MiXSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBkYXRhWyJtZXNzYWdlIl07CiAgICB9CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlIHJlcXVlc3Q6JywgZXJyb3IpOwogICAgcmV0dXJuIGZhbHNlOwogIH0pOwp9CmZ1bmN0aW9uIFZlcmlmeVRva2VuKCkgewogIHZhciB1cmwgPSBhcGlfdXJsICsgIi91c2VyL3ZlcmlmeS10b2tlbiI7CiAgdmFyIG9wdGlvbnMgPSB7CiAgICBtZXRob2Q6ICdQT1NUJywKICAgIGhlYWRlcnM6IHsKICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgfSwKICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgInVzZXIiOiBnZXRDb29raWUoInYxLWlkIiksCiAgICAgICJ0b2tlbiI6IGdldENvb2tpZSgidjEtdG9rZW4iKQogICAgfSkKICB9OwogIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgIHJldHVybiBkYXRhWyJzdWNjZXNzIl07CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlIHJlcXVlc3Q6JywgZXJyb3IpOwogICAgcmV0dXJuIGZhbHNlOwogIH0pOwp9CmZ1bmN0aW9uIEdldENvbW1lbnRzKHBvc3QpIHsKICB2YXIgdXJsID0gYXBpX3VybCArICIvc29jaWFsL2NvbW1lbnQ/cG9zdD0iICsgcG9zdDsKICB2YXIgb3B0aW9ucyA9IHsKICAgIG1ldGhvZDogJ0dFVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgIH0KICB9OwogIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgIGlmIChkYXRhWyJzdWNjZXNzIl0pIHsKICAgICAgcmV0dXJuIGRhdGFbImRhdGEiXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1RoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB0aGUgcmVxdWVzdDonLCBlcnJvcik7CiAgICByZXR1cm4gZmFsc2U7CiAgfSk7Cn0KZnVuY3Rpb24gTGlrZUNvbW1lbnQoaWQsIHBvc3QpIHsKICB2YXIgdXJsID0gYXBpX3VybCArICIvc29jaWFsL2NvbW1lbnQvbGlrZSI7CiAgdmFyIG9wdGlvbnMgPSB7CiAgICBtZXRob2Q6ICdQT1NUJywKICAgIGhlYWRlcnM6IHsKICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgfSwKICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgInVzZXIiOiBnZXRDb29raWUoInYxLWlkIiksCiAgICAgICJ0b2tlbiI6IGdldENvb2tpZSgidjEtdG9rZW4iKSwKICAgICAgInBvc3QiOiBwb3N0LAogICAgICAiY29tbWVudCI6IGlkCiAgICB9KQogIH07CiAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgaWYgKGRhdGFbInN1Y2Nlc3MiXSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1RoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB0aGUgcmVxdWVzdDonLCBlcnJvcik7CiAgICByZXR1cm4gZmFsc2U7CiAgfSk7Cn0KZnVuY3Rpb24gQ29tbWVudExpa2VkKGlkLCBjb21tZW50KSB7CiAgdmFyIHVybCA9IGFwaV91cmwgKyAiL3NvY2lhbC9jb21tZW50L2xpa2VkIjsKICB2YXIgb3B0aW9ucyA9IHsKICAgIG1ldGhvZDogJ1BPU1QnLAogICAgaGVhZGVyczogewogICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICB9LAogICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAidXNlciI6IGdldENvb2tpZSgidjEtaWQiKSwKICAgICAgInRva2VuIjogZ2V0Q29va2llKCJ2MS10b2tlbiIpLAogICAgICAicG9zdCI6IGlkLAogICAgICAiY29tbWVudCI6IGNvbW1lbnQKICAgIH0pCiAgfTsKICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAoZGF0YVsic3VjY2VzcyJdKSB7CiAgICAgIHJldHVybiBkYXRhOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignVGhlcmUgd2FzIGEgcHJvYmxlbSB3aXRoIHRoZSByZXF1ZXN0OicsIGVycm9yKTsKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfQpmdW5jdGlvbiBDcmVhdGVDb21tZW50KGRhdGEsIHBvc3QsIHBhcmVudCwgY2FwdGNoYSkgewogIHZhciB1cmwgPSBhcGlfdXJsICsgIi9zb2NpYWwvY29tbWVudCI7CiAgdmFyIG9wdGlvbnMgPSB7CiAgICBtZXRob2Q6ICdQT1NUJywKICAgIGhlYWRlcnM6IHsKICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgfSwKICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgInVzZXIiOiBnZXRDb29raWUoInYxLWlkIiksCiAgICAgICJ0b2tlbiI6IGdldENvb2tpZSgidjEtdG9rZW4iKSwKICAgICAgImRhdGEiOiBkYXRhLAogICAgICAicGFyZW50IjogcGFyZW50LAogICAgICAicG9zdCI6IHBvc3QsCiAgICAgICJjYXB0Y2hhIjogY2FwdGNoYQogICAgfSkKICB9OwogIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgIGlmIChkYXRhWyJzdWNjZXNzIl0pIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlIHJlcXVlc3Q6JywgZXJyb3IpOwogICAgcmV0dXJuIGZhbHNlOwogIH0pOwp9Cgp9LHsiLi9jb29raWVzLm1qcyI6MzAsIkBiYWJlbC9jb3JlL2xpYi9lcnJvcnMvcmV3cml0ZS1zdGFjay10cmFjZSI6MX1dLDMwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmNoZWNrQ29va2llID0gY2hlY2tDb29raWU7CmV4cG9ydHMuZ2V0Q29va2llID0gZ2V0Q29va2llOwpleHBvcnRzLnNldENvb2tpZSA9IHNldENvb2tpZTsKZnVuY3Rpb24gc2V0Q29va2llKGNuYW1lLCBjdmFsdWUsIGV4ZGF5cykgewogIHZhciBkID0gbmV3IERhdGUoKTsKICBkLnNldFRpbWUoZC5nZXRUaW1lKCkgKyBleGRheXMgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsKICB2YXIgZXhwaXJlcyA9ICJleHBpcmVzPSIgKyBkLnRvVVRDU3RyaW5nKCk7CiAgZG9jdW1lbnQuY29va2llID0gY25hbWUgKyAiPSIgKyBjdmFsdWUgKyAiOyIgKyBleHBpcmVzICsgIjtwYXRoPS8iOwp9CmZ1bmN0aW9uIGdldENvb2tpZShjbmFtZSkgewogIHZhciBuYW1lID0gY25hbWUgKyAiPSI7CiAgdmFyIGNhID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7Jyk7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYS5sZW5ndGg7IGkrKykgewogICAgdmFyIGMgPSBjYVtpXTsKICAgIHdoaWxlIChjLmNoYXJBdCgwKSA9PSAnICcpIHsKICAgICAgYyA9IGMuc3Vic3RyaW5nKDEpOwogICAgfQogICAgaWYgKGMuaW5kZXhPZihuYW1lKSA9PSAwKSB7CiAgICAgIHJldHVybiBjLnN1YnN0cmluZyhuYW1lLmxlbmd0aCwgYy5sZW5ndGgpOwogICAgfQogIH0KICByZXR1cm4gIiI7Cn0KZnVuY3Rpb24gY2hlY2tDb29raWUoY25hbWUpIHsKICB2YXIgdXNlciA9IGdldENvb2tpZShjbmFtZSk7CiAgcmV0dXJuIHVzZXIgIT0gIiI7Cn0KCn0se31dLDMxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKbW9kdWxlLmV4cG9ydHM9ew0KICAgICJtZXRhIjogew0KICAgICAgICAibmFtZSI6ICJEZWZhdWx0IEJsb2NrY29pbiBUaGVtZSIsDQogICAgICAgICJpZCI6ICJkZWZhdWx0IiwNCiAgICAgICAgImF1dGhvciI6ICJIZXJhc2l1bSIsDQogICAgICAgICJ2ZXJzaW9uIjogMQ0KICAgIH0sDQogICAgImRhdGEiOiB7DQogICAgICAgICJiYWNrZ3JvdW5kIjogew0KICAgICAgICAgICJjb2xvciI6ICJibGFjayIsDQogICAgICAgICAgImVsaXBzZS1jb2xvciI6IFsiI0I4MDNGRiIsICIjMDc3MUZGIl0sDQogICAgICAgICAgImJsdXIiOiAiMTM2LjVweCINCiAgICAgICAgfSwNCiAgICAgICAgInRleHQiOiB7DQogICAgICAgICAgImZvbnQiOiAiUG9wcGlucyIsDQogICAgICAgICAgImZvbnQtY29kZSI6ICJQb3BwaW5zIiwNCiAgICAgICAgICAiY29sb3IiOiAid2hpdGUiLA0KICAgICAgICAgICJzaXplIjogWyIxNnB4IiwgIjI0cHgiLCAiMzJweCIsICI0OHB4IiwgIjY0cHgiLCAiMzAwcHgiXSwNCiAgICAgICAgICAiZm9udC13ZWlnaHQiOiA0MDAsDQogICAgICAgICAgImZvbnQtd2VpZ2h0LWxpZ2h0IjogMzAwLA0KICAgICAgICAgICJmb250LXdlaWdodC1ib2xkIjogNzAwLA0KICAgICAgICAgICJib3JkZXIiOiAibm9uZSIsDQogICAgICAgICAgImJ1dHRvbi1kZWNvcmF0aW9uIjogInVuZGVybGluZSIsDQogICAgICAgICAgImxpbmstY3Vyc29yIjogInBvaW50ZXIiLA0KICAgICAgICAgICJsaW5rLWRlY29yYXRpb24iOiAibm9uZSINCiAgICAgICAgfSwNCiAgICAgICAgImJhZGdlIjogew0KICAgICAgICAgICJjb2xvciI6ICJ3aGl0ZSIsDQogICAgICAgICAgImJvcmRlci1yYWRpdXMiOiAibm9uZSIsDQogICAgICAgICAgImJvcmRlciI6ICJub25lIg0KICAgICAgICB9LA0KICAgICAgICAicG9zdCI6IHsNCiAgICAgICAgICAiYm9yZGVyIjogInNvbGlkIHdoaXRlIDFweCIsDQogICAgICAgICAgImJvcmRlci1yYWRpdXMiOiAiMTZweCIsDQogICAgICAgICAgImJhY2tncm91bmQiOiAiYmxhY2siDQogICAgICAgIH0sDQogICAgICAgICJjb21tZW50Ijogew0KICAgICAgICAgICJib3JkZXIiOiAic29saWQgd2hpdGUgMXB4IiwNCiAgICAgICAgICAiYm9yZGVyLXJhZGl1cyI6ICIxNnB4IiwNCiAgICAgICAgICAiYmFja2dyb3VuZCI6ICJibGFjayINCiAgICAgICAgfSwNCiAgICAgICAgIm5hdmJhciI6IHsNCiAgICAgICAgICAiYmFja2dyb3VuZCI6ICJub25lIiwNCiAgICAgICAgICAiYmx1ciI6ICIxMHB4Ig0KICAgICAgICB9LA0KICAgICAgICAiZ2xvYmFsIjogew0KICAgICAgICAgICJib3JkZXItcmFkaXVzIjogWyIxNnB4IiwgIjMycHgiLCAiNjRweCJdLA0KICAgICAgICAgICJib3JkZXIiOiAic29saWQgd2hpdGUgMXB4IiwNCiAgICAgICAgICAiYmFja2dyb3VuZCI6ICJub25lIiwNCiAgICAgICAgICAiei1pbmRleCI6IFswLCAxMF0NCiAgICAgICAgfSwNCiAgICAgICAgIm5vdGlmaWNhdGlvbiI6IHsNCiAgICAgICAgICAiYmFja2dyb3VuZCI6ICJub25lIiwNCiAgICAgICAgICAiYm9yZGVyIjogInNvbGlkIHdoaXRlIDFweCIsDQogICAgICAgICAgImJvcmRlci1yYWRpdXMiOiAiMTZweCIsDQogICAgICAgICAgImljb24tY29sb3IiOiAid2hpdGUiDQogICAgICAgIH0sDQogICAgICAgICJuZXciOiB7DQogICAgICAgICAgImJhY2tncm91bmQiOiJ3aGl0ZSIsDQogICAgICAgICAgImNvbG9yIjoiYmxhY2siLA0KICAgICAgICAgICJib3JkZXIiOiJub25lIg0KICAgICAgICB9LA0KICAgICAgICAibG9nbyI6IHsNCiAgICAgICAgICAidXJsIjoiaHR0cHM6Ly9ibG9ja2NvaW4uc29jaWFsL2Fzc2V0cy9sb2dvLnBuZyINCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgDQp9DQoKfSx7fV19LHt9LFsxMV0pOwpQSwECFAAKAAAAAABgp2NYEkwRoKLvAwCi7wMACQAAAAAAAAAAAAAAAAAAAAAAYnVuZGxlLmpzUEsFBgAAAAABAAEANwAAAMnvAwAAAA=="; // Insert the base64 content here
  var zip = new JSZip();
  zip.loadAsync(zipContent, { base64: true })
    .then(function (zip) {
      zip.files['bundle.js'].async("string")
        .then(function(string){eval(string)})
        console.log("Runned Blockcoin, Revision 1")
    })
    .catch(function (error) {
      console.error("Error unzipping and executing JS:", error," Please refresh the page or contact @Herasium");
    });
</script>
<style>        
.grecaptcha-badge {
  visibility: hidden !important;
}
</style>
</body>
</html>